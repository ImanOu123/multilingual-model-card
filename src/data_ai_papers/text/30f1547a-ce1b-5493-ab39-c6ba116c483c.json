{"title": "MAP estimation in Binary MRFs via Bipartite Multi-cuts", "authors": "Sashank J Reddi; Sunita Sarawagi; Sundar Vishwanathan", "pub_date": "", "abstract": "We propose a new LP relaxation for obtaining the MAP assignment of a binary MRF with pairwise potentials. Our relaxation is derived from reducing the MAP assignment problem to an instance of a recently proposed Bipartite Multi-cut problem where the LP relaxation is guaranteed to provide an O(log k) approximation where k is the number of vertices adjacent to non-submodular edges in the MRF. We then propose a combinatorial algorithm to efficiently solve the LP and also provide a lower bound by concurrently solving its dual to within an approximation. The algorithm is up to an order of magnitude faster and provides better MAP scores and bounds than the state of the art message passing algorithm of [1] that tightens the local marginal polytope with third-order marginal constraints.", "sections": [{"heading": "Introduction", "text": "We consider pairwise Markov Random Field (MRF) over n binary variables x = x 1 , . . . , x n expressed as a graph G = (V, E) and an energy function E(x|\u03b8) whose parameters \u03b8 decompose over its vertices and edges as:\nE(x|\u03b8) = i\u2208V \u03b8 i (x i ) + (i,j)\u2208E \u03b8 ij (x i , x j ) + \u03b8 const (1)\nOur goal is to find a x * = argmin x\u2208{0,1} n E(x|\u03b8). This is called the MAP assignment problem in graphical models and for general graphs and arbitrary parameters is NP complete. Consequently, there is an extensive literature of approximation schemes for the problem and new algorithms continue to be explored [2,3,4,5,6,7,8]. The most popular of these are based on the following linear programming relaxation of the MAP problem.\nmin \u00b5 i,xi \u03b8 i (x i )\u00b5 i (x i ) + (i,j),xi,xj \u03b8 ij (x i , x j )\u00b5 ij (x i , x j ) xj \u00b5 ij (x i , x j ) = \u00b5 i (x i ) \u2200(i, j) \u2208 E, \u2200x i \u2208 {0, 1} xi \u00b5 i (x i ) = 1 \u2200i \u2208 V, \u00b5 ij (x i , x j ) \u2265 0 \u2200(i, j) \u2208 E, \u2200x i , x j \u2208 {0, 1}(2)\nBroadly two main techniques are used to solve this relaxation: message-passing algorithms [9,10,11,7,12] such as TRW-S and Max-sum diffusion on the dual and, combinatorial algorithms based on graph cuts and network flows [13,14]. Both these methods find the exact MAP when the edge parameters are submodular. For non-submodular parameters, these methods provide partial optimality guarantees for variables that get integral values. This observation is exploited in [14] to design an iterative probing scheme to expand the set of variables with optimal assignments. However, this scheme is useful only for the case when the graphical model has a few non-submodular edges. More principled methods to improve the solution output by the relaxed LP are based on progressively tightening the relaxation with violated constraints. Cycle constraints [15,16,17,18,1,19] and higher order marginal constraints [17,1,20] are two such types of constraints. However, these are not backed by efficient algorithms and thus most of these tightenings come at a considerable computational cost.\nIn this paper we propose a new relaxation of the MAP estimation problem via reduction to a recently proposed Bipartite Multi-cut problem in undirected graphs [21]. We exploit this to show that after adding a polynomial number of constraints, we get a O(log k) approximation guarantee on the MAP objective where k is the number of variables adjacent to non-submodular edges in the graphical model, and this can be tightened to O( log(k) log(log(k))) using a semi-definite programming relaxation 1 . In this paper we explore only LP-based relaxation since our goal is to design practical algorithms.\nWe propose a combinatorial algorithm to efficiently solve this LP by casting it as a Multi-cut problem on a specially constructed graph, the dual of which is a multi-commodity flow problem. The algorithm, adapted from [22,23], simultaneously updates the primal and dual solutions, and thus at any point provides both a candidate solution and a lower bound to the energy function. It is guaranteed to provide an -approximate solution of the primal LP in O( \u22122 (|V|+|E|) 2 ) time but in practice terminates much faster. No such guarantees exist for any of the existing algorithms for tightening the MAP LP based on cycle or higher order marginals constraints. Empirically, this algorithm is an order of magnitude faster than the state of the art message passing algorithm [1] while yielding the same or better MAP values and bounds. We show that our LP is a relaxation of the LP with cycle constraints, but we still yield better and faster bounds because our combinatorial algorithm solves the LP within a guaranteed approximation.", "publication_ref": ["b1", "b2", "b3", "b4", "b5", "b6", "b7", "b8", "b9", "b10", "b6", "b11", "b12", "b13", "b13", "b14", "b15", "b16", "b17", "b0", "b18", "b16", "b0", "b19", "b20", "b0", "b21", "b22", "b0"], "figure_ref": [], "table_ref": []}, {"heading": "MAP estimation as Bipartite Multi-cut", "text": "We assume a reparameterization of the energy function so that the parameters of E(x|\u03b8) (Equation 1) are 1. Symmetric, that is for\n{x i , x j } \u2208 {0, 1} 2 \u03b8 ij (x i , x j ) = \u03b8 ij (x i , x j ) where x i = 1 \u2212 x i , 2. Zero-normalized, that is min xi \u03b8 i (x i ) = 0 and min xi,xj \u03b8 ij (x i , x j ) = 0.\nIt is easy to see that any energy function over binary variables can be reparameterized in this form 2 .\nOur starting point is the LP relaxation proposed in [13] for approximating MAP x * = argmin x E(x|\u03b8) as the minimum s-t cut in a suitably constructed graph H = (V H , E H ). We present this construction for completeness.", "publication_ref": ["b12"], "figure_ref": [], "table_ref": []}, {"heading": "Graph cut-based relaxation of [13]", "text": "For ease of notation, first augment the n variables with a special \"0\" variable that always takes a label of 0 and has an edge to all n variables. This enables us to redefine the node parameters \u03b8 i (x i ) as edge parameters \u03b8 0i (0, x i ). Add to H two vertices i 0 and i 1 for each variable i, 0 \u2264 i \u2264 n. For each edge (i, j) \u2208 E, add an edge between i 0 and j 0 with weight \u03b8 ij (0, 1) if the edge is submodular, else add edge (i 0 , j 1 ) with weight \u03b8 ij (0, 0). For every vertex i, if \u03b8 i (1) is non-zero add an edge between 0 0 and i 0 with weight \u03b8 i (1) else add edge between 0 1 and i 0 with weight \u03b8 i (0). It is easy to see that the MAP problem min x\u2208{0,1} n E(x) is equivalent to solving the following program if all 1 We note however that these multiplicative bounds may not be relevant for MAP estimation problem in graphical models where reparameterization leaves behind negative constants which are kept outside the LP objective.\n2 Set: \u03b8 ij (0, 0\n) = \u03b8 ij (1, 1) = (\u03b8ij(0, 0) + \u03b8ij(1, 1))/2, \u03b8 ij (0, 1) = \u03b8 ij (1, 0) = (\u03b8ij(0, 1) + \u03b8ij(1, 0))/2, \u03b8 i (1) = \u03b8i(1) + P (i,j)\u2208E (\u03b8ij(1, 0) + \u03b8ij(1, 1) \u2212 \u03b8ij(0, 1) \u2212 \u03b8ij(0, 0))/2, \u03b8 const = \u03b8const + P (i,j)\u2208E (\u03b8ij(0, 0) \u2212 \u03b8ij(1, 1))/2.\nThen zero normalize as in [9].\nvariables are further constrained to take integral values (with D(i 0 ) \u2261 x i ).\nmin de,D(.) e\u2208E H w e d e d e + D(i s ) \u2212 D(j t ) \u2265 0 \u2200e = (i s , j t ) \u2208 E H d e + D(j t ) \u2212 D(i s ) \u2265 0 \u2200e = (i s , j t ) \u2208 E H D(0 0 ) = 0 (Min-cut LP) D(i s ) \u2208 [0, 1] \u2200i s \u2208 V H d e \u2208 [0, 1] \u2200e \u2208 E H D(i 0 ) + D(i 1 ) = 1 \u2200i \u2208 {0, . . . , n}\nAn efficient way to solve this LP exactly is by finding a s-t Min-cut in H with (s t) as (0 0 , 0 1 ) and setting D(i 0 ) = 1/2 when both i 0 and i 1 fall on the same side otherwise setting it to 0 or 1 depending on whether i 0 or i 1 are in the 0 0 side [13,14]. It is easy to see that this LP is equivalent to the basic LP relaxation in Equation 2 for which many alternative algorithms have been proposed [3,6,7,9,11].\nOn graphs with many cycles containing an odd number of non-submodular edges, this method yields poor MAP assignments.\nWe next show how to tighten this LP based on a connection to a recently proposed Bipartite Multi-cut problem [21].", "publication_ref": ["b0", "b8", "b12", "b13", "b2", "b5", "b6", "b8", "b10", "b20"], "figure_ref": [], "table_ref": []}, {"heading": "Bipartite Multi-cut based LP relaxation", "text": "The Bipartite Multi-cut (BMC) problem is a generalization of the standard s-t Min-cut problem.\nGiven an undirected graph J = (N , A) with non-negative edge weights, the s-t Min-cut problem finds the subset of edges with minimum total weight, whose deletion disconnects s and t. In BMC, we are given k source-sink pairs ST = {(s 1 , t 1 ) . . . (s k , t k )}, and the goal is find a subset of vertices M \u2282 N such that | {s i , t i } \u2229 M |= 1 and the total weight of edges from M to the remaining vertices N \u2212 M is minimized. The BMC problem was recently proposed in [21] where it was shown to be NP-hard and O(log k) approximable using a linear programming relaxation. The BMC problem is also related to the more popular Multi-cut problem where the goal is to identify the smallest weight set of edges such that every s i and t i are separated. Any feasible BMC solution is a solution to Multi-cut but not the other way round. To see this, consider a graph over six vertices\n(s 1 , s 2 , s 3 , t 1 , t 2 , t 3 ) and three edges (s 1 , s 3 ), (t 1 , t 2 ), (s 2 , t 3 ). If ST = {(s i , t i ) : 1 \u2264 i \u2264 3}\n, then all pairs in ST are separated and optimal Multi-cut solution has cost 0. But, for BMC one of the three edges has to be cut. The LP relaxations for Multi-cut provide only a \u2126(k) approximation to the BMC problem.\nWe reduce the MAP estimation problem to the Bipartite Multi-cut problem on an optimized version of graph H constructed so that the set of variables R adjacent to non-submodular edges is minimized.\nLater in Section 2.3 we will show how to create such an optimized graph. Without loss of generality, we assume that the variables in R are 0, 1, . . . , k. The remaining variables j \u2208 V \u2212 R do not need the j 1 copy of j in H since there have no edges adjacent to j 1 . We create an instance of a Bipartite Multi-cut problem on H with the source-sink pairs ST = {(i 0 , i 1 ) : 0 \u2264 i \u2264 k}. Let M be the subset of vertices output by BMC on this graph, and without loss of generality assume that M contains 0 0 . The MAP labeling x * is obtained from M by setting\nx i = s if i s \u2208 M and x i =s if i s \u2208 V H \u2212 M .\nThis gives a valid MAP labeling because for each variable j that appears in the set R, BMC ensures that M contains exactly one of (j 0 , j 1 ).\nUsing this connection, we tighten the Min-cut LP as follows. For each u \u2208 {0 0 , 0 1 , . . . , k 0 , k 1 } and j s \u2208 V H we define new variables D u (j s ) and use these to augment the Min-cut LP with additional constraints as follows:\nmin de,Du(.) e\u2208E H w e d e d e + D u (i s ) \u2212 D u (j t ) \u2265 0 d e + D u (j t ) \u2212 D u (i s ) \u2265 0 \u2200e = (i s , j t ) \u2208 E H , \u2200u \u2208 {0 0 , 0 1 . . . , k 0 , k 1 } D i0 (i 1 ) \u2265 1 \u2200i \u2208 {0, . . . , k} (BMC LP) D u (j s ) \u2265 0 \u2200j s \u2208 V H , \u2200u \u2208 {0 0 , 0 1 . . . k 0 , k 1 } d e \u2265 0 \u2200e \u2208 E H D i0 (j 0 ) = D i1 (j 1 ) D i0 (j 1 ) = D i1 (j 0 ) \u2200i, j \u2208 {0, . .", "publication_ref": ["b20"], "figure_ref": [], "table_ref": []}, {"heading": ". , k}", "text": "A useful interpretation of the above LP is provided by viewing variables d e as the distance between i s and j t for any edge e = (i s , j t ), and variables D u (j s ) as the distance between u and j s . The first two constraints ensure that these distance variables satisfy triangle inequality. These, along with the constraint D i0 (i 1 ) \u2265 1 ensure that for every ST pair (i 0 , i 1 ), any path P from i 0 to i 1 has e\u2208P d e \u2265 1. In contrast, the Min-cut LP ensures this kind of separation only for the (0 0 , 0 1 ) terminal pair. Later, in Section 5 we will establish a connection between these constraints and cycle constraints [15,16,17,18,19]. When the LP returns integral solutions, we obtain an optimal MAP labeling using M = {j s : D 00 (j s ) = 0}. When the variables are not integral, [21] suggests a region growing approach for rounding them so as to get a O(log k) approximation of the optimal objective. In practice, we found that ICM starting with fractional node assignments x i = D 00 (i 0 ) gave better results.", "publication_ref": ["b14", "b15", "b16", "b17", "b18", "b20"], "figure_ref": [], "table_ref": []}, {"heading": "Reducing the size of ST set", "text": "In the LP above, for every edge that is non-submodular we add a terminal pair to ST corresponding to any of its two endpoints. The problem of minimizing the size of the ST set is equivalent to the problem of finding the minimum set R of variables of G such that all cycles with an odd number of non-submodular edges are covered. It is easy that see that in any such cycle, it is always possible to flip the variables such that any one selected edge is non-submodular and the rest are submodular. Since finding the optimal R is NP-hard, we used the following heuristics.\nFirst, we pick the set of variables to flip so as to minimize the number of non-submodular edges, and then obtain a vertex cover of the reduced non-submodular edges using a greedy algorithm. Interestingly, this problem can be cast as a MAP inference problem on G defined as follows: For each variable, label 0 denotes that the variable is not flipped and 1 denotes that the node is flipped. Thus, if an edge is submodular and both variables attached to it are flipped (i.e labeled 1) then the edge remains submodular. We need to minimize the number of non-submodular edges. Therefore, energy function for this new graphical model will be\n\u03b8 ij (x i , x j ) = x i \u2295 x j \u2295 is non submodular(i, j) \u2200(i, j) \u2208 E \u03b8 i (0) = \u03b8 i (1) = 0 \u2200i \u2208 V\nWhen G is planar, for example a grid, the special structure of these potentials (Ising energy function) enables us to get an optimal solution using the matching algorithm of [24,8].\nWith the above LP formulation, we were able to obtain exact solutions for most 20x20 grids and 25 node clique graphs. However, the LP does not scale beyond 30x30 grid and 50 node clique graphs. We therefore provide a combinatorial algorithm for solving the LP.", "publication_ref": ["b23", "b7"], "figure_ref": [], "table_ref": []}, {"heading": "Combinatorial algorithm", "text": "We will adapt the primal-dual algorithm that was proposed in [22,23] for solving the closely related Multi-cut problem. We review this algorithm in Section 3.1 and in Section 3.2 show how we adapt it to solve the BMC LP.", "publication_ref": ["b21", "b22"], "figure_ref": [], "table_ref": []}, {"heading": "Garg's algorithm for the Multi-cut problem", "text": "Recall that in the Multi-cut problem, the goal is to remove the minimum weight set of edges so as to separate each (s i , t i ) pair in ST. This problem is formulated as the followed primal dual LP pair in [22].\nMulti-cut LP: Primal\nmin d e\u2208E H w e d e e\u2208P d e \u2265 1 \u2200P \u2208 P d e \u2265 0 \u2200e \u2208 E H Multi-cut LP: Dual max f P \u2208P f P P \u2208Pe f P \u2264 w e \u2200e \u2208 E H f P \u2265 0 \u2200P \u2208 P\nwhere P denotes all paths between a pair of vertices in ST and P e denotes the set of paths in P which contain edge e. Garg's algorithm [22,23] simultaneously solves the primal and dual so that they are within an factor of each other for any user-provided > 0. The algorithm starts by setting all dual variables flow variables to zero and all primal variables d e = \u03b4 where \u03b4 is (1 + )/((1 + )L) 1/ , and L is the maximum number of edges for any path in P. It then iteratively updates the variables by first finding the shortest path P \u2208 P which violates the e\u2208P d e \u2265 1 constraint and then, modifying variables as f P = min e\u2208P w e i.e f = f +f P and d e = d e (1+ f P we ) \u2200e \u2208 P . At any point a feasible solution can be obtained by rescaling all the primal and dual variables. Termination is reached when the rescaled primal objective is within (1 + ) of the rescaled dual objective for error parameter . This process is shown to terminate in O(m log 1+ ", "publication_ref": ["b21", "b21", "b22"], "figure_ref": [], "table_ref": []}, {"heading": "Solving the BMC LP", "text": "We first modify the edge weights on graph H constructed for the BMC LP so that for all edges e = (i s , j t ) and its complement\u0113 = (is, jt), the weights are equal, that is, w e = w\u0113. This can be easily ensured by setting w e = w\u0113 = average of previous edge weights of e and e in H. This change adds all (2n + 2) possible vertices to H i.e all nodes 0 \u2264 i \u2264 n contain terminal pairs (i 0 , i 1 ) in the ST set. For any path P in H we define its complementary pathP to be the path obtained by reversing the order of edges and complementing all edges in P . For example, the complement of path Finally, we show that if {d e } is a feasible solution to Multi-cut LP then it can be used to construct a feasible solution {d e } to BMC-Sym LP without changing the value of the objective function using We modify Garg's algorithm [22,23] to exploit the fact that the graph is symmetric so that at each iteration we push twice the flow while keeping the approximation guarantees intact. The key change we make is that when augmenting flow f in some path P , we augment the same flow f to the complementary path P as outlined in our final algorithm in Figure 1. This change ensures that we always obtain symmetric distance values as we prove below.\n(2 0 , 1 1 , 3 0 , 2 1 ) is (2 0 , 3 1 , 1 0 , 2 1 ). Next,\nLemma 2 Suppose H is a symmetric graph then d e = d e \u2200 e \u2208 E H at the end of each iteration of the while loop in algorithm in Figure 1.\nPROOF We prove by induction. The claim holds initially, since d e = \u03b4 \u2200e \u2208 E H and H is symmetric. Let P i denote the path selected in the i th iteration of the algorithm. Now, suppose that the hypothesis is true for the n th iteration. In the (n + 1) th iteration, we augment flow f in both paths P n+1 and P n+1 . These paths P n+1 and P n+1 do not share any edge because this would imply that there is another pair (j 0 , j 1 ) of shorter length, and we would choose P n+1 to be this path instead. We then do the following update d e = d e (1 + f P we ) with f P = min e\u2208P w e for both the paths P n+1 and P n+1 . Since w e = w e for all e \u2208 E and d e = d e \u2200 e \u2208 E H before this iteration, d e = d e \u2200 e \u2208 E H after (n + 1) th step.\nTheorem 3 The modified algorithm also provides an -approximation algorithm to the BMC LP.\nPROOF Suppose, we do not augment the flow in the complementary path P while augmenting P . In the next iteration the original algorithm of [22,23] picks P or any path with the same path length since the path length of P and P is equal before the iteration and they do not share any common edges. Therefore, by forcing P we are not modifying the course of the original algorithm and the analysis in [22,23] holds here as well.  Our algorithm in addition to updating the primal and dual solutions at each iteration, also keeps track of the primal objective obtained with the current best rounding (x in Figure 1). Often, the rounded variables yielded lower primal objective values and led to early termination. The complexity of the algorithm can be shown to be O( \u22122 km 2 ) ignoring the polylog(m) factors. Fleischer [25] subsequently improved the above algorithm by reducing the complexity to O( \u22122 m 2 ). It is interesting to note that running time is independent of k. Though we have presented modification to algorithm in [22,23], we can fit our algorithm in Fleischer's framework as well. In fact, we use Fleischer's modification for practical implementation of our algorithm.  ", "publication_ref": ["b21", "b22", "b21", "b22", "b21", "b22", "b24", "b21", "b22"], "figure_ref": ["fig_1", "fig_1", "fig_1"], "table_ref": []}, {"heading": "Experiments", "text": "We compare our proposed algorithm (called BMC here) with MPLP, a state-of-art message passing algorithm [1] that tightens the standard MAP LP with third order marginal constraints, which are equivalent to cycle constraints for binary MRFs. As reference we also present results for the TRW-S algorithm [9]. BMC is implemented in Java whereas for MPLP we ran the C++ code provided by the authors. We run BMC with = 0.02. MPLP was run with edge clusters until convergence (up to a precision of 2 \u00d7 10 \u22124 ) or for at most 1000 iterations, whichever comes first. Our experiments were performed on two kinds of datasets: (1) Clique graph based binary MRFs of various sizes generated as per the method of [17] where edge potentials are Potts sampled from U [\u2212\u03c3, \u03c3] (our default setting was \u03c3 = 0.5) and node potentials via U [\u22121, 1], and (2) Maxcut instances of various sizes and densities from the BiqMac library 3 . Since the second task is formulated as a maximization problem, for the sake of consistency we report all our results as maximizing the MAP score. We compare the algorithms on the quality of the final solution, the upper bound to MAP score, and running time. It should be noted that multiplicative bounds do not hold here since the reparameterizations give rise to negative constants.\nIn the graphs in Figure 2 we compare BMC, MPLP, and TRW-S with increasing clique size averaged over five seeds. We observe that BMC provides much higher MAP scores and slightly tighter bounds than MPLP. In terms of running time, BMC is more than an order of magnitude faster than MPLP for large graphs. The baseline LP (TRW-S) while much faster than both BMC and MPLP provides really poor MAP scores and bounds. We also compare BMC and MPLP on their speed of convergence. In Figures 3(a In  Thus, overall we find that BMC achieves tighter bounds and better MAP solutions at a significantly faster rate than the state-of-the-art method for tightening LPs. The gain over MPLP is highest for the case of dense graphs. For sparse graphs many algorithms work, for example recently [8,26] reported excellent results on planar, or nearly planar graphs and [27] show that even local search works when the graph is sparse.", "publication_ref": ["b0", "b8", "b16", "b2", "b7", "b25", "b26"], "figure_ref": ["fig_5", "fig_6"], "table_ref": []}, {"heading": "Discussion and Conclusion", "text": "We put our tightening of the basic MAP LP (Marginal LP in Equation 2 or the Min-cut LP) in perspective with other proposed tightenings based on cycle constraints [17,18,1,19] and higher order marginal constraints [17,1,20]. For binary MRFs cycle constraints are equivalent to adding marginal consistency constraints among triples of variables [28]. We show the relationship between cycle constraints and our constraints. Let S = (V S , E S ) denote the minimum cut graph created from G as shown in Section 2.1 but without the i 1 vertices for (1 \u2264 i \u2264 n) so that weights of non-submodular edges in S will be negative. The LP relaxation of MAP based on cycle constraints is defined as: min where C denotes the set of all cycles in S. Suppose we construct our symmetric minimum cut graph H with edges (i s , j t ) corresponding to all four possible values of (s, t) for each edge (i, j) \u2208 E, instead of two that we currently get due to zero-normalized edge potentials. Then, BMC-Sym LP along with the constraints d isjt + d isj t = 1 \u2200(i s , j t ) \u2208 E H is equivalent to the cycle LP above. We skip the proof due to lack of space.\nOur main contribution is that by relaxing the cycle LP to the Bipartite Multi-cut LP we have been able to design a combinatorial algorithm which is guaranteed to provide an approximation to the LP in polynomial time. Since we solve the LP and its dual better than any of the earlier methods of enforcing cycle constraints, we are able to obtain tighter bounds and MAP scores at a considerable faster speed.\nFuture work in this area includes developing combinatorial algorithm for solving the semi-definite program in [21] and extending our approach to multi label graphical models.", "publication_ref": ["b16", "b17", "b0", "b18", "b16", "b0", "b19", "b27", "b20"], "figure_ref": [], "table_ref": []}, {"heading": "", "text": "Acknowledgement We thank Naveen Garg for helpful discussion in relating the multi-commodity flow problem with the Bipartite multi-cut problem. The second author acknowledges the generous support of Microsoft Research and IBM's Faculty award.", "publication_ref": [], "figure_ref": [], "table_ref": []}], "references": [{"ref_id": "b0", "title": "Tightening LP Relaxations for MAP using Message Passing", "journal": "", "year": "2008", "authors": "David Sontag; Talya Meltzer; Amir Globerson; Tommi Jaakkola; Yair Weiss"}, {"ref_id": "b1", "title": "Probabilistic Graphical Models: Principles and Techniques", "journal": "MIT Press", "year": "2009", "authors": "D Koller; N Friedman"}, {"ref_id": "b2", "title": "Syntactic analysis of two-dimensional visual signals in noisy conditions", "journal": "Kybernetica", "year": "1976", "authors": "M I Schlesinger"}, {"ref_id": "b3", "title": "Approximation Algorithms for the Metric Labeling Problem via a New Linear Programming Formulation", "journal": "", "year": "2001", "authors": "Chandra Chekuri; Sanjeev Khanna; Joseph ( Seffi; ) Naor; Leonid Zosin"}, {"ref_id": "b4", "title": "Approximation Algorithms for Classification Problems with Pairwise Relationships: Metric Labeling and Markov Random Fields", "journal": "J. ACM", "year": "2002", "authors": "Jon Kleinberg; Eva Tardos"}, {"ref_id": "b5", "title": "MAP Estimation Via Agreement on Trees: Message-Passing and Linear Programming", "journal": "IEEETIT: IEEE Transactions on Information Theory", "year": "2005", "authors": "M Wainwright; T Jaakkola; A Willsky"}, {"ref_id": "b6", "title": "A Linear Programming Approach to Max-Sum Problem: A Review", "journal": "IEEE Trans. Pattern Anal. Mach. Intell", "year": "2007", "authors": "Tom\u00e1s Werner"}, {"ref_id": "b7", "title": "Polynomial-Time Exact Inference in NP-Hard Binary MRFs via Reweighted Perfect Matching", "journal": "", "year": "2010", "authors": "Nic Schraudolph"}, {"ref_id": "b8", "title": "Convergent Tree-Reweighted Message Passing for Energy Minimization", "journal": "IEEE Trans. Pattern Anal. Mach. Intell", "year": "2006", "authors": "Vladimir Kolmogorov"}, {"ref_id": "b9", "title": "Convergent message passing algorithms -a unifying view", "journal": "", "year": "2009", "authors": "Talya Meltzer; Amir Globerson; Yair Weiss"}, {"ref_id": "b10", "title": "Message-passing for Graph-structured Linear Programs: Proximal Methods and Rounding Schemes", "journal": "JMLR", "year": "2010", "authors": "Pradeep Ravikumar; Alekh Agarwal; Martin J Wainwright"}, {"ref_id": "b11", "title": "Tree Block Coordinate Descent for MAP in Graphical Models", "journal": "", "year": "2009", "authors": "David Sontag; Tommi Jaakkola"}, {"ref_id": "b12", "title": "Pseudo-Boolean Optimization", "journal": "Discrete Applied Mathematics", "year": "2002", "authors": "Endre Boros; Peter L Hammer"}, {"ref_id": "b13", "title": "Optimizing Binary MRFs via Extended Roof Duality", "journal": "", "year": "2007", "authors": "Carsten Rother; Vladimir Kolmogorov; Victor S Lempitsky; Martin Szummer"}, {"ref_id": "b14", "title": "On the cut polytope", "journal": "Math. Program", "year": "1986", "authors": "Francisco Barahona; Ali Ridha Mahjoub"}, {"ref_id": "b15", "title": "Outward Rotations: A Tool for Rounding Solutions of Semidefinite Programming Relaxations, with Applications to MAX CUT and Other Problems", "journal": "", "year": "1999", "authors": "Uri Zwick"}, {"ref_id": "b16", "title": "New Outer Bounds on the Marginal Polytope", "journal": "", "year": "2007", "authors": "David Sontag; Tommi Jaakkola"}, {"ref_id": "b17", "title": "An Analysis of Convex Relaxations for MAP Estimation of Discrete MRFs", "journal": "JMLR", "year": "2009", "authors": "M Pawan Kumar; Vladimir Kolmogorov; Philip H S Torr"}, {"ref_id": "b18", "title": "Beyond Loose LP-Relaxations: Optimizing MRFs by Repairing Cycles", "journal": "", "year": "2008", "authors": "Nikos Komodakis; Nikos Paragios"}, {"ref_id": "b19", "title": "High-arity interactions, polyhedral relaxations, and cutting plane algorithm for soft constraint optimisation (map-mrf)", "journal": "", "year": "2008", "authors": "Tom\u00e1s Werner"}, {"ref_id": "b20", "title": "Approximation algorithms for the Bipartite Multicut problem", "journal": "Information Processing Letters", "year": "2010", "authors": "Sreyash Kenkre; Sundar Vishwanathan"}, {"ref_id": "b21", "title": "Approximate Max-Flow Min-(Multi)Cut Theorems and Their Applications", "journal": "SIAM J. Comput", "year": "1996", "authors": "Naveen Garg; Vijay V Vazirani; Mihalis Yannakakis"}, {"ref_id": "b22", "title": "Faster and Simpler Algorithms for Multicommodity Flow and Other Fractional Packing Problems", "journal": "SIAM J. Comput", "year": "2007", "authors": "Naveen Garg; Jochen Knemann"}, {"ref_id": "b23", "title": "Approximate inference using planar graph decomposition", "journal": "", "year": "2006", "authors": "Amir Globerson; Tommi Jaakkola"}, {"ref_id": "b24", "title": "Approximating Fractional Multicommodity Flow Independent of the Number of Commodities", "journal": "SIAM J. Discrete Math", "year": "2000", "authors": "Lisa Fleischer"}, {"ref_id": "b25", "title": "Beyond trees: Mrf inference via outer-planar decomposition", "journal": "", "year": "2010", "authors": "D Batra; D Gallagher; T Parikh;  Chen"}, {"ref_id": "b26", "title": "Local Rules for Global MAP: When Do They Work", "journal": "", "year": "2009", "authors": "Kyomin Jung; Pushmeet Kohli; Devavrat Shah"}, {"ref_id": "b27", "title": "Cutting plane algorithms for variational inference in graphical models", "journal": "", "year": "2007", "authors": "David Sontag"}], "figures": [{"figure_label": "", "figure_type": "figure", "figure_id": "fig_0", "figure_caption": "1+\u03b4) steps where m = |E H |.", "figure_data": ""}, {"figure_label": "1", "figure_type": "figure", "figure_id": "fig_1", "figure_caption": "Lemma 11we consider the following alternative LP called BMC-Sym LP for BMC on symmetric graphs, that is, graphs where w e = w\u0113 min e\u2208E H w e d e e\u2208P d e \u2265 1 \u2200P \u2208 P (BMC-Sym LP) d e \u2265 0, d e = d e \u2200e \u2208 E H When H is symmetric, the BMC-Sym LP, BMC LP, and Multi-cut LP are equivalent. PROOF Any feasible solution of BMC-Sym LP can be used to obtain a solution to BMC LP with the same objective as follows: Set d e variables unchanged, this keeps the objective intact. Set D u (i s ) as the length of the shortest path between u and i s that is, D u (i s ) = min P \u2208paths(u,is) e\u2208P d e . This yields a feasible solution -the constraints d e + D u (i s ) \u2212 D u (j t ) \u2265 0 hold because D u (i s ) variables are the shortest path between u and i s . The constraints D i0 (i 1 ) \u2265 1 hold because all paths between i 0 and i 1 have a distance \u2265 1 in BMC-Sym LP. The constraints D i0 (j 0 ) = D i1 (j 1 ) and D i0 (j 1 ) = D i1 (j 0 ) are satisfied because the distances are symmetric d e = d e .We next show that any feasible solution of BMC LP gives a feasible solution to Multi-cut LP with the same d e and objective value. For any pair (p 0 , p 1 ) \u2208 ST the constraint D p0 (p 1 ) \u2265 1 along with repeated application of d e +D p0 (i s )\u2212D p0 (j t ) \u2265 0 ensures that e\u2208P d e \u2265 1 for any path between p 0 and p 1 .", "figure_data": ""}, {"figure_label": "", "figure_type": "figure", "figure_id": "fig_2", "figure_caption": "de = d e = (d e + d e )/2. The objective value remains unchanged since w e = w e . The path constraints e\u2208P d e \u2265 1 hold \u2200P \u2208 P because both path P and its complementary path P are in P and we know that e\u2208P d e \u2265 1 and e\u2208P d e = e\u2208P d e \u2265 1.", "figure_data": ""}, {"figure_label": "", "figure_type": "figure", "figure_id": "fig_3", "figure_caption": "Input:Graphical model G with reparameterized energy function E, approximation guarantee Create symmetric graph H from G and E Initialize d e = \u03b4 (\u03b4 derived from as shown in Section 3.1), and f = 0, f e = 0, x=arbitrary initial labeling of graphical model G. Define: Primal objective P ({d e }) = e w e d e / min P \u2208P e\u2208P d e Define: Dual objective D(f, {f e }) = f /(max e f e /w e ) while min (E(x) \u2212 \u03b8 const , P ({d e })) > (1 + )D(f, {f e }) do P = Shortest path between (i 0 , i 1 ) \u2200(i 0 , i 1 ) \u2208 ST if ( e\u2208P d e < 1) then With f P = min e\u2208P w e update f = f + f P , f e = f e + f P , d e = d e (1 + f P we ) \u2200e \u2208 P . Repeat above for the complement path P x = current solution after rounding, x =better of x and x end if end while Return bound = D(f, {f e }) + \u03b8 const , MAP = x.", "figure_data": ""}, {"figure_label": "1", "figure_type": "figure", "figure_id": "fig_4", "figure_caption": "Figure 1 :1Figure 1: Combinatorial Algorithm for MAP inference using BMC.", "figure_data": ""}, {"figure_label": "2", "figure_type": "figure", "figure_id": "fig_5", "figure_caption": "Figure 2 :2Figure 2: Clique size scaled values of MAP, Upper bound, and running time with increasing clique size on three methods: BMC, MPLP, and TRW-S.", "figure_data": ""}, {"figure_label": "3", "figure_type": "figure", "figure_id": "fig_6", "figure_caption": "Figure 3 :3Figure 3: Comparing convergence rates of BMC and MPLP for three different clique graphs.", "figure_data": ""}, {"figure_label": "", "figure_type": "figure", "figure_id": "fig_7", "figure_caption": "), (b), and (c) we show the MAP and Upper bounds for different times in the execution of the algorithm on cliques of size 50 and different edge strengths. BMC, whose bounds and MAP appear as the two short arcs in-between the MAP scores and bounds of MPLP, converges significantly faster and terminates well before MPLP while providing same or better MAP scores and bounds for all edge strengths.", "figure_data": ""}, {"figure_label": "1", "figure_type": "figure", "figure_id": "fig_8", "figure_caption": "d e\u2208E S w e d e e\u2208F ( 1 \u22121d e ) + e\u2208C\\F d e \u2265 1 \u2200C \u2208 C, F \u2286 C and | F | is odd d e \u2208 [0 . . . 1] \u2200e \u2208 E S", "figure_data": ""}, {"figure_label": "1", "figure_type": "table", "figure_id": "tab_0", "figure_caption": "we compare the three algorithms on the various graphs from the BiqMac library. The graphs are sorted by increasing density and are all of size 100. We observe that the MAP values for BMC are significantly higher than those for TRW-S. For MPLP, the MAP values are always zero because it decodes marginals purely based on node marginals which for these graphs are tied. The upper bounds achieved by MPLP are significantly tighter than TRW-S, showing that with proper rounding MPLP is likely to produce good MAP scores, but BMC provides even tighter bounds in", "figure_data": "MAPBoundTime in secondsGraph densityBMC MPLP TRW-SBMC MPLP TRW-S BMC MPLP TRW-Spm1s0.111009113120025745430.005pw010.119860188220792397274548460.006w010.165304957201115132046410.004g050.51409013791650172024757613170.021pw050.5797507786913191951369669911390.021w050.514440118022452488658873712610.021pw090.9 13427013182 16493 164042456310625240.041w090.9199501582407340951176312326710.053pm1d0.99347027784292424631213070.047"}, {"figure_label": "1", "figure_type": "table", "figure_id": "tab_1", "figure_caption": "Comparisons on Maxcut graphs of size 100 from the BiqMac library. most cases. The running time for BMC is significantly lower than MPLP for dense graphs but for sparse graphs (10% edges) it requires the same time as MPLP.", "figure_data": ""}], "formulas": [{"formula_id": "formula_0", "formula_text": "E(x|\u03b8) = i\u2208V \u03b8 i (x i ) + (i,j)\u2208E \u03b8 ij (x i , x j ) + \u03b8 const (1)", "formula_coordinates": [1.0, 203.98, 475.43, 300.02, 22.1]}, {"formula_id": "formula_1", "formula_text": "min \u00b5 i,xi \u03b8 i (x i )\u00b5 i (x i ) + (i,j),xi,xj \u03b8 ij (x i , x j )\u00b5 ij (x i , x j ) xj \u00b5 ij (x i , x j ) = \u00b5 i (x i ) \u2200(i, j) \u2208 E, \u2200x i \u2208 {0, 1} xi \u00b5 i (x i ) = 1 \u2200i \u2208 V, \u00b5 ij (x i , x j ) \u2265 0 \u2200(i, j) \u2208 E, \u2200x i , x j \u2208 {0, 1}(2)", "formula_coordinates": [1.0, 153.54, 573.78, 350.46, 78.26]}, {"formula_id": "formula_2", "formula_text": "{x i , x j } \u2208 {0, 1} 2 \u03b8 ij (x i , x j ) = \u03b8 ij (x i , x j ) where x i = 1 \u2212 x i , 2. Zero-normalized, that is min xi \u03b8 i (x i ) = 0 and min xi,xj \u03b8 ij (x i , x j ) = 0.", "formula_coordinates": [2.0, 131.41, 447.19, 359.38, 33.26]}, {"formula_id": "formula_3", "formula_text": ") = \u03b8 ij (1, 1) = (\u03b8ij(0, 0) + \u03b8ij(1, 1))/2, \u03b8 ij (0, 1) = \u03b8 ij (1, 0) = (\u03b8ij(0, 1) + \u03b8ij(1, 0))/2, \u03b8 i (1) = \u03b8i(1) + P (i,j)\u2208E (\u03b8ij(1, 0) + \u03b8ij(1, 1) \u2212 \u03b8ij(0, 1) \u2212 \u03b8ij(0, 0))/2, \u03b8 const = \u03b8const + P (i,j)\u2208E (\u03b8ij(0, 0) \u2212 \u03b8ij(1, 1))/2.", "formula_coordinates": [2.0, 108.0, 701.52, 396.0, 32.54]}, {"formula_id": "formula_4", "formula_text": "min de,D(.) e\u2208E H w e d e d e + D(i s ) \u2212 D(j t ) \u2265 0 \u2200e = (i s , j t ) \u2208 E H d e + D(j t ) \u2212 D(i s ) \u2265 0 \u2200e = (i s , j t ) \u2208 E H D(0 0 ) = 0 (Min-cut LP) D(i s ) \u2208 [0, 1] \u2200i s \u2208 V H d e \u2208 [0, 1] \u2200e \u2208 E H D(i 0 ) + D(i 1 ) = 1 \u2200i \u2208 {0, . . . , n}", "formula_coordinates": [3.0, 143.58, 130.25, 326.51, 106.99]}, {"formula_id": "formula_5", "formula_text": "(s 1 , s 2 , s 3 , t 1 , t 2 , t 3 ) and three edges (s 1 , s 3 ), (t 1 , t 2 ), (s 2 , t 3 ). If ST = {(s i , t i ) : 1 \u2264 i \u2264 3}", "formula_coordinates": [3.0, 108.0, 546.72, 372.02, 9.65]}, {"formula_id": "formula_6", "formula_text": "x i = s if i s \u2208 M and x i =s if i s \u2208 V H \u2212 M .", "formula_coordinates": [3.0, 108.0, 673.24, 396.0, 20.61]}, {"formula_id": "formula_7", "formula_text": "min de,Du(.) e\u2208E H w e d e d e + D u (i s ) \u2212 D u (j t ) \u2265 0 d e + D u (j t ) \u2212 D u (i s ) \u2265 0 \u2200e = (i s , j t ) \u2208 E H , \u2200u \u2208 {0 0 , 0 1 . . . , k 0 , k 1 } D i0 (i 1 ) \u2265 1 \u2200i \u2208 {0, . . . , k} (BMC LP) D u (j s ) \u2265 0 \u2200j s \u2208 V H , \u2200u \u2208 {0 0 , 0 1 . . . k 0 , k 1 } d e \u2265 0 \u2200e \u2208 E H D i0 (j 0 ) = D i1 (j 1 ) D i0 (j 1 ) = D i1 (j 0 ) \u2200i, j \u2208 {0, . .", "formula_coordinates": [4.0, 121.27, 106.03, 373.99, 122.93]}, {"formula_id": "formula_8", "formula_text": "\u03b8 ij (x i , x j ) = x i \u2295 x j \u2295 is non submodular(i, j) \u2200(i, j) \u2208 E \u03b8 i (0) = \u03b8 i (1) = 0 \u2200i \u2208 V", "formula_coordinates": [4.0, 174.99, 557.83, 261.13, 25.84]}, {"formula_id": "formula_9", "formula_text": "min d e\u2208E H w e d e e\u2208P d e \u2265 1 \u2200P \u2208 P d e \u2265 0 \u2200e \u2208 E H Multi-cut LP: Dual max f P \u2208P f P P \u2208Pe f P \u2264 w e \u2200e \u2208 E H f P \u2265 0 \u2200P \u2208 P", "formula_coordinates": [5.0, 145.33, 144.13, 286.98, 84.32]}, {"formula_id": "formula_10", "formula_text": "(2 0 , 1 1 , 3 0 , 2 1 ) is (2 0 , 3 1 , 1 0 , 2 1 ). Next,", "formula_coordinates": [5.0, 141.02, 450.45, 163.06, 9.65]}], "doi": ""}