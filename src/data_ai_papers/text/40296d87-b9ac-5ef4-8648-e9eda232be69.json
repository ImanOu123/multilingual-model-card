{"title": "Transformers: State-of-the-Art Natural Language Processing", "authors": "Thomas Wolf; Lysandre Debut; Victor Sanh; Julien Chaumond; Clement Delangue; Anthony Moi; Pierric Cistac; Tim Rault; R\u00e9mi Louf; Morgan Funtowicz; Joe Davison; Sam Shleifer; Patrick Von Platen; Clara Ma; Yacine Jernite; Julien Plu; Canwen Xu; Teven Le Scao; Sylvain Gugger; Mariama Drame; Quentin Lhoest; Alexander M Rush", "pub_date": "", "abstract": "Recent progress in natural language processing has been driven by advances in both model architecture and model pretraining. Transformer architectures have facilitated building higher-capacity models and pretraining has made it possible to effectively utilize this capacity for a wide variety of tasks. Transformers is an open-source library with the goal of opening up these advances to the wider machine learning community. The library consists of carefully engineered stateof-the art Transformer architectures under a unified API. Backing this library is a curated collection of pretrained models made by and available for the community. Transformers is designed to be extensible by researchers, simple for practitioners, and fast and robust in industrial deployments. The library is available at https://github.com/ huggingface/transformers.", "sections": [{"heading": "Introduction", "text": "The Transformer (Vaswani et al., 2017) has rapidly become the dominant architecture for natural language processing, surpassing alternative neural models such as convolutional and recurrent neural networks in performance for tasks in both natural language understanding and natural language generation. The architecture scales with training data and model size, facilitates efficient parallel training, and captures long-range sequence features.\nModel pretraining (McCann et al., 2017;Howard and Ruder, 2018;Devlin et al., 2018) allows models to be trained on generic corpora and subsequently be easily adapted to specific tasks with strong performance. The Transformer architecture is particularly conducive to pretraining on large text corpora, leading to major gains in accuracy on downstream tasks including text classification , language understanding (Liu et al., 2019b;Wang et al., , 2019, machine translation (Lample and Conneau, 2019a), coreference resolution (Joshi et al., 2019), commonsense inference (Bosselut et al., 2019), and summarization (Lewis et al., 2019) among others.\nThis advance leads to a wide range of practical challenges that must be addressed in order for these models to be widely utilized. The ubiquitous use of the Transformer calls for systems to train, analyze, scale, and augment the model on a variety of platforms. The architecture is used as a building block to design increasingly sophisticated extensions and precise experiments. The pervasive adoption of pretraining methods has led to the need to distribute, fine-tune, deploy, and compress the core pretrained models used by the community.\nTransformers is a library dedicated to supporting Transformer-based architectures and facilitating the distribution of pretrained models. At the core of the libary is an implementation of the Transformer which is designed for both research and production. The philosophy is to support industrial-strength implementations of popular model variants that are easy to read, extend, and deploy. On this foundation, the library supports the distribution and usage of a wide-variety of pretrained models in a centralized model hub. This hub supports users to compare different models with the same minimal API and to experiment with shared models on a variety of different tasks.\nTransformers is an ongoing effort maintained by the team of engineers and researchers at Hugging Face with support from a vibrant community of over 400 external contributors. The library is released under the Apache 2.0 license and is available on GitHub 1 . Detailed documentation and tutorials are available on Hugging Face's website 2 . ", "publication_ref": ["b41", "b28", "b12", "b8", "b25", "b42", "b19", "b14", "b3", "b23"], "figure_ref": [], "table_ref": []}, {"heading": "Related Work", "text": "The NLP and ML communities have a strong culture of building open-source research tools. The structure of Transformers is inspired by the pioneering tensor2tensor library (Vaswani et al., 2018) and the original source code for BERT (Devlin et al., 2018), both from Google Research. The concept of providing easy caching for pretrained models stemmed from AllenNLP . The library is also closely related to neural translation and language modeling systems, such as Fairseq (Ott et al., 2019), Open-NMT (Klein et al., 2017), Texar , Megatron-LM (Shoeybi et al., 2019), and Marian NMT (Junczys-Dowmunt et al., 2018). Building on these elements, Transformers adds extra user-facing features to allow for easy downloading, caching, and fine-tuning of the models as well as seamless transition to production. Transformers maintains some compatibility with these libraries, most directly including a tool for performing inference using models from Marian NMT and Google's BERT.\nThere is a long history of easy-to-use, userfacing libraries for general-purpose NLP. Two core libraries are NLTK (Loper andBird, 2002) andStanford CoreNLP (Manning et al., 2014), which collect a variety of different approaches to NLP in a single package. More recently, general-purpose, open-source libraries have focused primarily on machine learning for a variety of NLP tasks, these include Spacy (Honnibal and Montani, 2017), Al-lenNLP , flair (Akbik et al., 2019), and Stanza (Qi et al., 2020). Transformers provides similar functionality as these libraries. Additionally, each of these libraries now uses the Transformers library and model hub as a low-level framework.\nSince Transformers provides a hub for NLP models, it is also related to popular model hubs including Torch Hub and TensorFlow Hub which collect framework-specific model parameters for easy use. Unlike these hubs, Transformers is domain-specific which allows the system to provide automatic support for model analysis, usage, deployment, benchmarking, and easy replicability.", "publication_ref": ["b40", "b8", "b30", "b18", "b37", "b15", "b26", "b26", "b10", "b0", "b33"], "figure_ref": [], "table_ref": []}, {"heading": "Library Design", "text": "Transformers is designed to mirror the standard NLP machine learning model pipeline: process data, apply a model, and make predictions. Although the library includes tools facilitating training and development, in this technical report we focus on the core modeling specifications. For complete details about the features of the library refer to the documentation available on https: //huggingface.co/transformers/.\nEvery model in the library is fully defined by three building blocks shown in the diagram in Figure 2: (a) a tokenizer, which converts raw text to sparse index encodings, (b) a transformer, which transforms sparse indices to contextual embeddings, and (c) a head, which uses contextual embeddings to make a task-specific prediction. Most user needs can be addressed with these three components.\nTransformers Central to the library are carefully tested implementations of Transformer architecture variants which are widely used in NLP. The full list of currently implemented architectures is shown in Figure 2 (Left). While each of these architectures  shares the same multi-headed attention core, there are significant differences between them including positional representations, masking, padding, and the use of sequence-to-sequence design. Additionally, various models are built to target different applications of NLP such as understanding, generation, and conditional generation, plus specialized use cases such as fast inference or multi-lingual applications.\nHeads Name Input Output Tasks Ex. Datasets Language Modeling x 1:n\u22121 x n \u2208 V Generation WikiText-103 Sequence Classification x 1:N y \u2208 C Classification, Sentiment Analysis GLUE, SST, MNLI Question Answering x 1:M ,x M :N y span [1 : N ] QA, Reading Comprehension SQuAD, Natural Questions Token Classification x 1:N y 1:N \u2208 C N NER, Tagging OntoNotes, WNUT Multiple Choice x 1:N , X y \u2208 X Text Selection SWAG, ARC Masked LM x 1:N \\n x n \u2208 V Pretraining Wikitext, C4 Conditional Generation x 1:N y 1:M \u2208 V M Translation, Summarization WMT, IWSLT, CNN/DM, XSum Transformers Masked [x 1:N \\n \u21d2 x n ] BERT (Devlin et al., 2018) RoBERTa (Liu et al., 2019a) Autoregressive [x 1:n\u22121 \u21d2 x n ] GPT / GPT-2 (Radford\nPractically, all models follow the same hierarchy of abstraction: a base class implements the model's computation graph from an encoding (projection on the embedding matrix) through the series of selfattention layers to the final encoder hidden states. The base class is specific to each model and closely follows the model's original implementation which gives users the flexibility to easily dissect the inner workings of each individual architecture. In most cases, each model is implemented in a single file to enable ease of extensibility.\nWherever possible, different architectures follow the same API allowing users to switch easily between different models. A set of Auto classes provides a unified API that enables very fast switching between models and even between frameworks. These classes automatically instantiate with the configuration specified by the user-specified pretrained model.\nTokenizers A critical NLP-specific aspect of the library is the implementations of the tokenizers necessary to use each model. Tokenizer classes (each inheriting from a common base class) can either be instantiated from a corresponding pretrained model or can be configured manually. These classes store the vocabulary token-to-index map for their corresponding model and handle the encoding and decoding of input sequences according to a model's specific tokenization process. The tokenizers implemented are shown in Figure 2 (Right). Users can easily modify tokenizer with interfaces to add additional token mappings, special tokens (such as classification or separation tokens), or otherwise resize the vocabulary.\nTokenizers can also implement additional useful features for the users. These range from token type indices in the case of sequence classification to maximum length sequence truncating taking into account the added model-specific special tokens (most pretrained Transformer models have a maximum sequence length).\nFor training on very large datasets, Python-based tokenization is often undesirably slow. In the most recent release, Transformers switched its implementation to use a highly-optimized tokenization library by default. This low-level library, available at https://github.com/huggingface/ tokenizers, is written in Rust to speed up the tokenization procedure both during training and deployment.\nHeads Each Transformer can be paired with one out of several ready-implemented heads with outputs amenable to common types of tasks. These heads are implemented as additional wrapper classes on top of the base class, adding a specific output layer, and optional loss function, on top of the Transformer's contextual embeddings. The full set of implemented heads are shown in Figure 2 (Top). These classes follow a similar naming pattern: XXXForSequenceClassification where XXX is the name of the model and can be used for adaptation (fine-tuning) or pretraining. Some heads, such as conditional generation, support extra functionality like sampling and beam search.\nFor pretrained models, we release the heads used to pretrain the model itself. For instance, for BERT we release the language modeling and next sentence prediction heads which allows easy for adaptation using the pretraining objectives. We also make it easy for users to utilize the same core Transformer parameters with a variety of other heads for finetuning. While each head can be used generally, the library also includes a collection of examples that show each head on real problems. These examples demonstrate how a pretrained model can be adapted with a given head to achieve state-of-theart results on a large variety of NLP tasks.", "publication_ref": [], "figure_ref": ["fig_1", "fig_1", "fig_1"], "table_ref": []}, {"heading": "Community Model Hub", "text": "Transformers aims to facilitate easy use and distribution of pretrained models. Inherently this is a community process; a single pretraining run facilitates fine-tuning on many specific tasks. The Model Hub makes it simple for any end-user to access a model for use with their own data. This hub now contains 2,097 user models, both pretrained and fine-tuned, from across the community. Figure 1 shows the increase and distribution of popular transformers over time. While core models like BERT and GPT-2 continue to be popular, other specialized models including DistilBERT (Sanh et al., 2019), which was developed for the library, are now widely downloaded by the community.\nThe user interface of the Model Hub is designed to be simple and open to the community. To upload a model, any user can sign up for an account and use a command-line interface to produce an archive consisting a tokenizer, transformer, and head. This bundle may be a model trained through the library or converted from a checkpoint of other popular training tools. These models are then stored and given a canonical name which a user can use to download, cache, and run the model either for finetuning or inference in two lines of code. To load FlauBERT , a BERT model pretrained on a French training corpus, the command is:\n1 tknzr = AutoTokenizer.from_pretrained( 2 \"flaubert/flaubert_base_uncased\") 3 model = AutoModel.from_pretrained( 4 \"flaubert/flaubert_base_uncased\")\nWhen a model is uploaded to the Model Hub, it is automatically given a landing page describing its core properties, architecture, and use cases. Additional model-specific metadata can be provided via a model card (Mitchell et al., 2018) that describes properties of its training, a citation to the work, datasets used during pretraining, and any caveats about known biases in the model and its predictions. An example model card is shown in Figure 3 \n(Left).\nSince the Model Hub is specific to transformerbased models, we can target use cases that would be difficult for more general model collections. For example, because each uploaded model includes metadata concerning its structure, the model page can include live inference that allows users to experiment with output of models on a real data. Figure 3 (Right) shows an example of the model page with live inference. Additionally, model pages include links to other model-specific tools like benchmarking and visualizations. For example, model pages can link to exBERT (Hoover et al., 2019), a Transformer visualization library.", "publication_ref": ["b36", "b29", "b11"], "figure_ref": ["fig_0", "fig_2"], "table_ref": []}, {"heading": "Community Case Studies", "text": "The Model Hub highlights how Transformers is used by a variety of different community stakeholders. We summarize three specific observed use-cases in practice. We highlight specific systems developed by users with different goals following the architect, trainer, and end-user distinction of Strobelt et al. (2017): Case 1: Model Architects AllenAI, a major NLP research lab, developed a new pretrained model for improved extraction from biomedical texts called SciBERT (Beltagy et al., 2019). They were able to train the model utilizing data from PubMed to produce a masked language model with state-ofthe-art results on targeted text. They then used the Model Hub to distribute the model and promote it as part of their CORD -COVID-19 challenge, making it trivial for the community to use. Case 2: Task Trainers Researchers at NYU were interested in developing a test bed for the performance of Transformers on a variety of different semantic recognition tasks. Their framework Jiant (Pruksachatkun et al., 2020) allows them to experiment with different ways of pretraining models and comparing their outputs. They used the Transformers API as a generic front-end and performed fine-tuning on a variety of different models, leading to research on the structure of BERT (Tenney et al., 2019). Case 3: Application Users Plot.ly, a company focused on user dashboards and analytics, was interested in deploying a model for automatic document summarization. They wanted an approach that scaled well and was simple to deploy, but had no need to train or fine-tune the model. They were able to search the Model Hub and find DistilBART, a pretrained and fine-tuned summarization model designed for accurate, fast inference. They were able to run and deploy the model directly from the hub with no required research or ML expertise.", "publication_ref": ["b38", "b1", "b32", "b39"], "figure_ref": [], "table_ref": []}, {"heading": "Deployment", "text": "An increasingly important goal of Transformers is to make it easy to efficiently deploy model to production. Different users have different production needs, and deployment often requires solving significantly different challenges than training. The library thereforce allows for several different strategies for production deployment.\nOne core propery of the libary is that models are available both in PyTorch and TensorFlow, and there is interoperability between both frameworks. A model trained in one of frameworks can be saved through standard serialization and be reloaded from the saved files in the other framework seamlessly. This makes it particularly easy to switch from one framework to the other one along the model lifetime (training, serving, etc.).\nEach framework has deployment recommendations. For example, in PyTorch, models are compatible with TorchScript, an intermediate representation of a PyTorch model that can then be run either in Python in a more efficient way, or in a highperformance environment such as C++. Fine-tuned models can thus be exported to production-friendly environment, and run through TorchServing. Ten-sorFlow includes several serving options within its ecosystem, and these can be used directly.\nTransformers can also export models to intermediate neural network formats for further compila- tion. It supports converting models to the Open Neural Network Exchange format (ONNX) for deployment. Not only does this allow the model to be run in a standardized interoperable format, but also leads to significant speed-ups. Figure 4 shows experiments run in collaboration with the ONNX team to optimize BERT, RoBERTa, and GPT-2 from the Transformers library. Using this intermediate format, ONNX was able to achieve nearly a 4x speedup on this model. The team is also experimenting with other promising intermediate formats such as JAX/XLA (Bradbury et al., 2018) and TVM (Chen et al., 2018).\nFinally, as Transformers become more widely used in all NLP applications, it is increasingly important to deploy to edge devices such as phones or home electronics. Models can use adapters to convert models to CoreML weights that are suitable to be embedded inside a iOS application, to enable on-the-edge machine learning. Code is also made available 3 . Similar methods can be used for Android devices.", "publication_ref": ["b4", "b5"], "figure_ref": ["fig_3"], "table_ref": []}, {"heading": "Conclusion", "text": "As Transformer and pretraining play larger roles in NLP, it is important for these models to be accessible to researchers and end-users. Transformers is an open-source library and community designed to facilitate users to access large-scale pretrained models, to build and experiment on top of them, and to deploy them in downstream tasks with stateof-the-art performance. Transformers has gained significant organic traction since its release and is set up to continue to provide core infrastructure while helping to facilitate access to new models.", "publication_ref": [], "figure_ref": [], "table_ref": []}], "references": [{"ref_id": "b0", "title": "Flair: An easy-to-use framework for state-of-the-art nlp", "journal": "", "year": "2019", "authors": "Alan Akbik; Tanja Bergmann; Duncan Blythe; Kashif Rasul; Stefan Schweter; Roland Vollgraf"}, {"ref_id": "b1", "title": "SciB-ERT: A pretrained language model for scientific text", "journal": "", "year": "2019", "authors": "Iz Beltagy; Kyle Lo; Arman Cohan"}, {"ref_id": "b2", "title": "Longformer: The Long-Document transformer", "journal": "", "year": "2020", "authors": "Iz Beltagy; E Matthew; Arman Peters;  Cohan"}, {"ref_id": "b3", "title": "Comet: Commonsense transformers for automatic knowledge graph construction", "journal": "", "year": "2019", "authors": "Antoine Bosselut; Hannah Rashkin; Maarten Sap; Chaitanya Malaviya; \u00c7 Asli; Yejin Choi"}, {"ref_id": "b4", "title": "JAX: composable transformations of Python+NumPy programs", "journal": "", "year": "2018", "authors": "James Bradbury; Roy Frostig; Peter Hawkins; Matthew James Johnson; Chris Leary; Dougal Maclaurin; Skye Wanderman-Milne"}, {"ref_id": "b5", "title": "{TVM}: An automated end-to-end optimizing compiler for deep learning", "journal": "", "year": "2018", "authors": "Tianqi Chen; Thierry Moreau; Ziheng Jiang; Lianmin Zheng; Eddie Yan; Haichen Shen; Meghan Cowan; Leyuan Wang; Yuwei Hu; Luis Ceze"}, {"ref_id": "b6", "title": "ELECTRA: Pretraining text encoders as discriminators rather than generators", "journal": "", "year": "2020", "authors": "Kevin Clark; Minh-Thang Luong; V Quoc; Christopher D Le;  Manning"}, {"ref_id": "b7", "title": "Transformer-XL: Attentive language models beyond a Fixed", "journal": "", "year": "2019", "authors": "Zihang Dai; Zhilin Yang; Yiming Yang; Jaime Carbonell; V Quoc; Ruslan Le;  Salakhutdinov"}, {"ref_id": "b8", "title": "BERT: Pre-training of deep bidirectional transformers for language understanding", "journal": "", "year": "2018", "authors": "Jacob Devlin; Ming-Wei Chang; Kenton Lee; Kristina Toutanova"}, {"ref_id": "b9", "title": "AllenNLP: A deep semantic natural language processing platform", "journal": "", "year": "2018", "authors": "Matt Gardner; Joel Grus; Mark Neumann; Oyvind Tafjord; Pradeep Dasigi; Nelson Liu; Matthew Peters; Michael Schmitz; Luke Zettlemoyer"}, {"ref_id": "b10", "title": "spacy 2: Natural language understanding with bloom embeddings, convolutional neural networks and incremental parsing", "journal": "", "year": "2017", "authors": "Matthew Honnibal; Ines Montani"}, {"ref_id": "b11", "title": "exBERT: A visual analysis tool to explore learned representations in transformers models", "journal": "", "year": "2019", "authors": "Benjamin Hoover; Hendrik Strobelt; Sebastian Gehrmann"}, {"ref_id": "b12", "title": "Universal language model fine-tuning for text classification", "journal": "", "year": "2018", "authors": "Jeremy Howard; Sebastian Ruder"}, {"ref_id": "b13", "title": "Texar: A modularized, versatile", "journal": "", "year": "2018", "authors": "Zhiting Hu; Haoran Shi; Bowen Tan; Wentao Wang; Zichao Yang; Tiancheng Zhao; Junxian He; Lianhui Qin; Di Wang; Xuezhe Ma; Zhengzhong Liu; Xiaodan Liang; Wangrong Zhu; Devendra Singh Sachan; Eric P Xing"}, {"ref_id": "b14", "title": "Spanbert: Improving pre-training by representing and predicting spans", "journal": "", "year": "2019", "authors": "Mandar Joshi; Danqi Chen; Yinhan Liu; S Daniel; Luke Weld; Omer Zettlemoyer;  Levy"}, {"ref_id": "b15", "title": "Andr\u00e9 F T Martins, and Alexandra Birch", "journal": "", "year": "2018", "authors": "Marcin Junczys-Dowmunt; Roman Grundkiewicz; Tomasz Dwojak; Hieu Hoang; Kenneth Heafield; Tom Neckermann; Frank Seide; Ulrich Germann; Alham Fikri Aji; Nikolay Bogoychev"}, {"ref_id": "b16", "title": "Supervised multimodal bitransformers for classifying images and text", "journal": "", "year": "2019", "authors": "Douwe Kiela; Suvrat Bhooshan"}, {"ref_id": "b17", "title": "Reformer: The efficient transformer", "journal": "", "year": "2020", "authors": "Nikita Kitaev; \u0141ukasz Kaiser; Anselm Levskaya"}, {"ref_id": "b18", "title": "OpenNMT: Opensource toolkit for neural machine translation", "journal": "Association for Computational Linguistics", "year": "2017", "authors": "Guillaume Klein; Yoon Kim; Yuntian Deng; Jean Senellart; Alexander Rush"}, {"ref_id": "b19", "title": "Crosslingual language model pretraining", "journal": "", "year": "2019", "authors": "Guillaume Lample; Alexis Conneau"}, {"ref_id": "b20", "title": "Crosslingual language model pretraining", "journal": "", "year": "2019", "authors": "Guillaume Lample; Alexis Conneau"}, {"ref_id": "b21", "title": "ALBERT: A lite BERT for self-supervised learning of language representations", "journal": "", "year": "2019", "authors": "Zhenzhong Lan; Mingda Chen; Sebastian Goodman; Kevin Gimpel; Piyush Sharma; Radu Soricut"}, {"ref_id": "b22", "title": "Flaubert: Unsupervised language model pre-training for french", "journal": "", "year": "2020", "authors": "Hang Le; Lo\u00efc Vial; Jibril Frej; Vincent Segonne; Maximin Coavoux; Benjamin Lecouteux; Alexandre Allauzen; Beno\u00eet Crabb\u00e9; Laurent Besacier; Didier Schwab"}, {"ref_id": "b23", "title": "BART: Denoising Sequence-to-Sequence pretraining for natural language generation, translation, and comprehension", "journal": "", "year": "2019", "authors": "Mike Lewis; Yinhan Liu; Naman Goyal ; Abdelrahman Mohamed; Omer Levy; Ves Stoyanov; Luke Zettlemoyer"}, {"ref_id": "b24", "title": "", "journal": "", "year": "2019", "authors": "Yinhan Liu; Myle Ott; Naman Goyal; Jingfei Du; Mandar Joshi; Danqi Chen; Omer Levy; Mike Lewis; Luke Zettlemoyer; Veselin Stoyanov"}, {"ref_id": "b25", "title": "Roberta: A robustly optimized bert pretraining approach. ArXiv, abs", "journal": "", "year": "1907", "authors": "Yinhan Liu; Myle Ott; Naman Goyal; Jingfei Du; Mandar S Joshi; Danqi Chen; Omer Levy; Mike Lewis; Luke S Zettlemoyer; Veselin Stoyanov"}, {"ref_id": "b26", "title": "NLTK: The natural language toolkit", "journal": "", "year": "2002", "authors": "Edward Loper; Steven Bird"}, {"ref_id": "b27", "title": "The stanford CoreNLP natural language processing toolkit", "journal": "", "year": "2014", "authors": "D Christopher; Mihai Manning; John Surdeanu; Jenny Rose Bauer; Steven Finkel; David Bethard;  Mc-Closky"}, {"ref_id": "b28", "title": "Learned in translation: Contextualized word vectors", "journal": "Curran Associates, Inc", "year": "2017", "authors": "Bryan Mccann; James Bradbury; Caiming Xiong; Richard Socher ; I Guyon; U V Luxburg; H Bengio;  Wallach;  Fergus; R Vishwanathan;  Garnett"}, {"ref_id": "b29", "title": "Inioluwa Deborah Raji, and Timnit Gebru", "journal": "", "year": "2018", "authors": "Margaret Mitchell; Simone Wu; Andrew Zaldivar; Parker Barnes; Lucy Vasserman; Ben Hutchinson; Elena Spitzer"}, {"ref_id": "b30", "title": "fairseq: A fast, extensible toolkit for sequence modeling", "journal": "", "year": "2019", "authors": "Myle Ott; Sergey Edunov; Alexei Baevski; Angela Fan; Sam Gross; Nathan Ng; David Grangier; Michael Auli"}, {"ref_id": "b31", "title": "Deep contextualized word representations", "journal": "", "year": "2018", "authors": "E Matthew; Mark Peters; Mohit Neumann; Matt Iyyer; Christopher Gardner; Kenton Clark; Luke Lee;  Zettlemoyer"}, {"ref_id": "b32", "title": "jiant: A software toolkit for research on general-purpose text understanding models", "journal": "", "year": "2020", "authors": "Yada Pruksachatkun; Phil Yeres; Haokun Liu; Jason Phang; Alex Phu Mon Htut; Ian Wang; Samuel R Tenney;  Bowman"}, {"ref_id": "b33", "title": "Stanza: A python natural language processing toolkit for many human languages", "journal": "", "year": "2020", "authors": "Peng Qi; Yuhao Zhang; Yuhui Zhang; Jason Bolton; Christopher D Manning"}, {"ref_id": "b34", "title": "Language models are unsupervised multitask learners", "journal": "OpenAI Blog", "year": "2019", "authors": "Alec Radford; Jeffrey Wu; Rewon Child; David Luan; Dario Amodei; Ilya Sutskever"}, {"ref_id": "b35", "title": "Exploring the limits of transfer learning with a unified Text-to-Text transformer", "journal": "", "year": "2019", "authors": "Colin Raffel; Noam Shazeer; Adam Roberts; Katherine Lee; Sharan Narang; Michael Matena; Yanqi Zhou; Wei Li; Peter J Liu"}, {"ref_id": "b36", "title": "DistilBERT, a distilled version of BERT: smaller, faster, cheaper and lighter", "journal": "", "year": "2019", "authors": "Victor Sanh; Lysandre Debut; Julien Chaumond; Thomas Wolf"}, {"ref_id": "b37", "title": "Megatron-lm: Training multi-billion parameter language models using gpu model parallelism", "journal": "", "year": "2019", "authors": "Mohammad Shoeybi; Mostofa Patwary; Raul Puri; Patrick Legresley; Jared Casper; Bryan Catanzaro"}, {"ref_id": "b38", "title": "Lstmvis: A tool for visual analysis of hidden state dynamics in recurrent neural networks", "journal": "IEEE transactions on visualization and computer graphics", "year": "2017", "authors": "Hendrik Strobelt; Sebastian Gehrmann; Hanspeter Pfister; Alexander M Rush"}, {"ref_id": "b39", "title": "Bert rediscovers the classical nlp pipeline", "journal": "", "year": "2019", "authors": "Ian Tenney; Dipanjan Das; Ellie Pavlick"}, {"ref_id": "b40", "title": "Tensor2tensor for neural machine translation", "journal": "", "year": "2018", "authors": "Ashish Vaswani; Samy Bengio; Eugene Brevdo; Francois Chollet; Aidan N Gomez; Stephan Gouws; Llion Jones; \u0141ukasz Kaiser; Nal Kalchbrenner; Niki Parmar; Ryan Sepassi; Noam Shazeer; Jakob Uszkoreit"}, {"ref_id": "b41", "title": "Attention is all you need", "journal": "Curran Associates, Inc", "year": "2017", "authors": "Ashish Vaswani; Noam Shazeer; Niki Parmar; Jakob Uszkoreit; Llion Jones; Aidan N Gomez; Ukasz Kaiser; Illia Polosukhin ; I Guyon; U V Luxburg; H Bengio;  Wallach;  Fergus; R Vishwanathan;  Garnett"}, {"ref_id": "b42", "title": "Superglue: A stickier benchmark for general-purpose language understanding systems", "journal": "ArXiv", "year": "2019", "authors": "Alex Wang; Yada Pruksachatkun; Nikita Nangia; Amanpreet Singh; Julian Michael; Felix Hill; Omer Levy; Samuel R Bowman"}, {"ref_id": "b43", "title": "Glue: A multi-task benchmark and analysis platform for natural language understanding", "journal": "", "year": "2018", "authors": "Alex Wang; Amanpreet Singh; Julian Michael; Felix Hill; Omer Levy; Samuel R Bowman"}, {"ref_id": "b44", "title": "Xlnet: Generalized autoregressive pretraining for language understanding", "journal": "ArXiv", "year": "1906", "authors": "Zhilin Yang; Zihang Dai; Yiming Yang; Jaime G Carbonell; Ruslan Salakhutdinov; V Quoc;  Le"}], "figures": [{"figure_label": "1", "figure_type": "figure", "figure_id": "fig_0", "figure_caption": "Figure 1 :1Figure 1: Average daily unique downloads of the most downloaded pretrained models, Oct. 2019 to May 2020.", "figure_data": ""}, {"figure_label": "2", "figure_type": "figure", "figure_id": "fig_1", "figure_caption": "Figure 2 :2Figure 2: The Transformers library. (Diagram-Right) Each model is made up of a Tokenizer, Transformer, and Head.The model is pretrained with a fixed head and can then be further fine-tuned with alternate heads for different tasks. (Bottom) Each model uses a specific Tokenizer either implemented in Python or in Rust. These often differ in small details, but need to be in sync with pretraining. (Left) Transformer architectures specialized for different tasks, e.g. understanding versus generation, or for specific use-cases, e.g. speed, image+text. (Top) heads allow a Transformer to be used for different tasks. Here we assume the input token sequence is x 1:N from a vocabulary V, and y represents different possible outputs, possibly from a class set C. Example datasets represent a small subset of example code distributed with the library.", "figure_data": ""}, {"figure_label": "3", "figure_type": "figure", "figure_id": "fig_2", "figure_caption": "Figure 3 :3Figure 3: Transformers Model Hub. (Left) Example of a model page and model card for SciBERT (Beltagy et al., 2019), a pretrained model targeting extraction from scientific literature submitted by a community contributor. (Right) Example of an automatic inference widget for the pretrained BART (Lewis et al., 2019) model for summarization. Users can enter arbitrary text and a full version of the model is deployed on the fly to produce a summary.", "figure_data": ""}, {"figure_label": "4", "figure_type": "figure", "figure_id": "fig_3", "figure_caption": "Figure 4 :4Figure 4: Experiments with Transformers inference in collaboration with ONNX.", "figure_data": ""}], "formulas": [{"formula_id": "formula_0", "formula_text": "Heads Name Input Output Tasks Ex. Datasets Language Modeling x 1:n\u22121 x n \u2208 V Generation WikiText-103 Sequence Classification x 1:N y \u2208 C Classification, Sentiment Analysis GLUE, SST, MNLI Question Answering x 1:M ,x M :N y span [1 : N ] QA, Reading Comprehension SQuAD, Natural Questions Token Classification x 1:N y 1:N \u2208 C N NER, Tagging OntoNotes, WNUT Multiple Choice x 1:N , X y \u2208 X Text Selection SWAG, ARC Masked LM x 1:N \\n x n \u2208 V Pretraining Wikitext, C4 Conditional Generation x 1:N y 1:M \u2208 V M Translation, Summarization WMT, IWSLT, CNN/DM, XSum Transformers Masked [x 1:N \\n \u21d2 x n ] BERT (Devlin et al., 2018) RoBERTa (Liu et al., 2019a) Autoregressive [x 1:n\u22121 \u21d2 x n ] GPT / GPT-2 (Radford", "formula_coordinates": [3.0, 77.98, 68.69, 438.05, 310.85]}, {"formula_id": "formula_1", "formula_text": "1 tknzr = AutoTokenizer.from_pretrained( 2 \"flaubert/flaubert_base_uncased\") 3 model = AutoModel.from_pretrained( 4 \"flaubert/flaubert_base_uncased\")", "formula_coordinates": [5.0, 64.03, 568.06, 212.4, 36.2]}, {"formula_id": "formula_2", "formula_text": "(Left).", "formula_coordinates": [5.0, 264.58, 727.52, 27.59, 9.46]}], "doi": ""}