{"title": "Optimizing Locomotion Controllers Using Biologically-Based Actuators and Objectives", "authors": "Jack M Wang; Samuel R Hamner; Scott L Delp; Vladlen Koltun", "pub_date": "", "abstract": "We present a technique for automatically synthesizing walking and running controllers for physically-simulated 3D humanoid characters. The sagittal hip, knee, and ankle degrees-of-freedom are actuated using a set of eight Hill-type musculotendon models in each leg, with biologically-motivated control laws. The parameters of these control laws are set by an optimization procedure that satisfies a number of locomotion task terms while minimizing a biological model of metabolic energy expenditure. We show that the use of biologically-based actuators and objectives measurably increases the realism of gaits generated by locomotion controllers that operate without the use of motion capture data, and that metabolic energy expenditure provides a simple and unifying measurement of effort that can be used for both walking and running control optimization.", "sections": [{"heading": "Introduction", "text": "The development of physics-based locomotion controllers de novo, independent from stock motion data, has been a long-standing objective in computer graphics research and has seen resurgence in recent years. Despite impressive progress, the gaits produced by existing controllers fall short of the natural appearance of human locomotion. For example, physics-based walking controllers that do not rely on motion capture data commonly produce walking motion with exaggerated hip flexion which appears more crouched and less fluid than typical human walking.\nOne likely cause of these differences is the control force generation mechanism. Biological control systems output neural excitation signals, which then generate musculotendon forces that lead to joint torques. The mapping from excitation to torque is highly complex due to variable moment arms, biarticular muscles, and the dependence of musculotendon forces on fiber length and contraction velocity [Zajac 1989]. On the other hand, state-of-the-art bipedal locomotion control methods directly output joint torques, which ignore constraints and energetic costs imposed by muscle anatomy and physiology. Consequently, to accomplish a motion task, controllers often employ torque patterns that are inefficient or even impossible for humans. These biologically implausible torque patterns diminish the naturalness of the resulting gaits.\nThe goal of our work is to enhance the realism of locomotion gaits exhibited by physically-simulated humanoids without dependence on motion capture data. To this end, we augment the jointactuated humanoid model with a set of Hill-type musculotendon units (MTUs). These musculotendon units generate torques for the most important degrees-of-freedom (DOFs) during locomotionthe sagittal plane hip, knee, and ankle DOFs. To actuate these muscles, we define biologically-motivated control functions that map the current state of the body (joint angles, muscle fiber lengths, etc.) to excitation signals. The parameters of these functions are optimized to yield gaits that move the character forward without falling down.\nWhile many sets of parameters are capable of achieving this task, the quality of the resulting motion varies significantly among them. To produce gaits that have a high degree of realism, we employ an objective based on minimization of metabolic energy expenditure, thus choosing the most effortless gait that achieves the task [Alexander 2003]. In living humans and animals, metabolic energy expenditure can be estimated by oxygen consumption. In contrast, it is less clear how metabolic energy expenditure should be modeled for simulated characters. A common substitute is the sum of squared joint torques [Schultz and Mombaur 2010], which does not account for the different effort levels required to generate torques in different joints, directions, and body configurations. More nuanced objectives can be learned from inverse optimization [Liu et al. 2005], but are dependent on training data. Our use of biologically-based actuators enables the estimation of metabolic energy expenditure based on the internal state of the MTUs [Anderson 1999]. The result is a locomotion control optimization procedure that minimizes a physiologically-based objective within a parameter space restricted to biologically plausible torque patterns.\nWe demonstrate the presented approach by optimizing locomotion controllers for a wide range of speeds. For quantitative evaluation, we collected experimental ground truth data from 20 human subjects walking and running at eight speeds on an instrumented treadmill. Much like human locomotion, our controllers utilize significant ankle torque and generate smooth torque trajectories. The resulting gaits match human ground truth to a greater extent than state-of-the-art walking controllers that do not rely on motion capture data. Furthermore, we show that by simply changing the initialization and target velocity, the same optimization procedure leads to running controllers.", "publication_ref": ["b53", "b1", "b37", "b29", "b3"], "figure_ref": [], "table_ref": []}, {"heading": "Related Work", "text": "Animation researchers have been interested in the control of locomotion for 3D humanoid characters for almost 20 years [Hodgins et al. 1995;Laszlo et al. 1996;Faloutsos et al. 2001]. One important recent contribution is SIMBICON [Yin et al. 2007], a remarkably robust 3D humanoid locomotion controller based on the balance control of Raibert and Hodgins [1991]. A num-ber of projects have since focused on expanding the controller repertoire for simulated bipeds [Jain et al. 2009;Coros et al. 2010;de Lasa et al. 2010] and on locomotion in complex environments [Mordatch et al. 2010;Wu and Popovi\u0107 2010].\nAt the same time, efforts have been made to make the synthesized motions more human-like, or \"natural.\" As discussed by Wang et al. [2009], the original SIMBICON-style controllers tend to produce gaits lacking hip extension with a constant foot orientation. Knee angles lack flexion during swing, but lack extension at heelstrike. More recent controllers improve motions by designing better target trajectories in joint or feature space [Coros et al. 2009;Coros et al. 2010;de Lasa et al. 2010]. While more human-like ankle motions have been produced, differences in the hip and knee angles persist (Figure 6a). Perhaps more importantly, controllers relying on hand-tuned trajectories cannot be easily used to investigate how the control strategies change with respect to new constraints. For example, how would the character's motion style change given a physical disability? Can we synthesize appropriate gaits for older or younger characters? Impressive results have also been achieved by controllers based on tracking motion capture data [da Silva et al. 2008;Muico et al. 2009;Kwon and Hodgins 2010;Lee et al. 2010;Ye and Liu 2010]. However, as with methods that tune joint trajectories or controller parameters by hand, motion capture driven controllers have a limited ability to predict changes in gait.\nAlternatively, de novo controller optimization has been used to capture features of human walking [Wang et al. 2009;Wang et al. 2010]. While these methods were shown to produce gaits for a variety of characters and environmental conditions, they do not employ realistic effort measures or biologicallyplausible control torques. The resulting torque patterns are highly unnatural (Figure 6b), leading to artifacts such as excessive plantarflexion and sharp changes in kinematics (Figure 6a). In contrast, our approach is to actuate key DOFs using Hill-type MTUs and to measure effort based on metabolic energy expenditure. We demonstrate significantly more human-like kinematic and torque trajectories and show that the same control parameterization and effort objective produce both walking and running.\nWhile locomotion controllers discussed above all operate on joint-actuated models, musculoskeletal models have also been investigated in computer graphics. Such models have been used in facial animation [Waters 1987;Lee et al. 1995;Sifakis et al. 2005], simulation of the human hand [Sueda et al. 2008], neck [Lee and Terzopoulos 2006], torso [Zordan et al. 2006], and the complete upper body [Lee et al. 2009]. Hase et al. [2003] optimize a CPG-based (central pattern generator) locomotion controller [Taga 1995] for 3D musculoskeletal models without tendon or activation dynamics, but their results were not compared to human kinematic and dynamic gait patterns. Moreover, full musculoskeletal models are significantly more difficult to construct than joint-actuated models. Our work demonstrates that measurable increase in locomotion realism can be produced by employing musculotendon actuators for a small subset of the body DOFs.\nIn the biomechanics literature, abstract planar models have been used to study high-level principles of human locomotion. For example, energy minimization has been suggested as the criterion for humans in determining step length given walking speed [Kuo 2001], as well as in selecting between walking and running [Srinivasan and Ruina 2006]. The spring-loaded inverted pendulum (SLIP) model [Blickhan 1989] has been used as a basis for predicting center-of-mass (COM) movements of human runners [Full and Koditschek 1999]. However, in the absence of knee joints, these models cannot be used to simulate accurate gait pat- terns. Using a 2D model with knees and musculotendon actuators, Geyer and Herr [2010] showed that patterns of human walking can be generated by a set of simple control laws motivated by muscle reflexes, which inspired our work. We show how their basic ideas can be embedded in a 3D humanoid model and extended to running. Similar 2D models have been used for gait prediction [Ackermann and van den Bogert 2010], and to generate human-like responses to disturbances [Murai and Yamane 2011].\nSimulation studies on detailed 3D musculoskeletal models have been employed to understand muscle functions during locomotion tasks [Anderson and Pandy 2001;Liu et al. 2008;Hamner et al. 2010]. In particular, Anderson and Pandy [2001] showed that human-like lower body motor patterns can be found by minimizing metabolic energy expenditure per distance travelled, and we adopt their proposed model of metabolic energy in our work. However, these biomechanical simulations only recovered muscle activation trajectories, and did not produce locomotion controllers that can function beyond the duration of input data.\nFinally, our work is complementary of the recent work of Jain and Liu [2011], who showed that simulating soft tissue deformation at contact sites could lead to more robust and realistic character motion. We demonstrate how musculotendon actuators, biologicallymotivated control laws, and a more realistic effort term can be used to produce more human-like locomotion gaits.", "publication_ref": ["b18", "b24", "b11", "b51", "b36", "b20", "b8", "b10", "b31", "b49", "b45", "b7", "b8", "b10", "b9", "b32", "b23", "b28", "b50", "b45", "b46", "b47", "b26", "b39", "b42", "b25", "b54", "b27", "b17", "b43", "b22", "b40", "b5", "b12", "b13", "b0", "b33", "b2", "b30", "b15", "b2", "b19"], "figure_ref": ["fig_5", "fig_5", "fig_5"], "table_ref": []}, {"heading": "Humanoid Model", "text": "Our 3D humanoid model has 30 joint DOFs and mass distributions approximating a 180 cm, 70 kg male [Wang et al. 2010]. From the original model, we adjust the lower-body joint locations and mass distributions to better match human data [Hamner et al. 2010]. We use cylinders to approximate the heel and ball of the foot, which allows for some amount of foot rolling after heel-strike. Unlike previous work, where the model is actuated by setting torques to all joints, we use a model that is partially actuated by Hill-type MTUs (Figure 1). Specifically, control torques for the hip, knee, and ankle joint DOFs in the sagittal plane-key DOFs for gait analysis [Perry and Burnfield 2010]  MTUs in each leg. In addition, soft joint limit torques as defined by Geyer and Herr [2010] are applied to these DOFs.\nFigure 1b depicts locations of the uniarticular MTUs and the joints they actuate. The hip joint is extended by the gluteal muscles (GLU) and flexed by the hip flexor muscles (HFL), while the knee joint is extended by the vasti (VAS). The tibialis anterior (TA) and the soleus (SOL) generate dorsiflexion and plantarflexion torques at the ankle, respectively. The biarticular MTUs (Figure 1c) supply torques to two joints simultaneously. We include the hamstring (HAM), which extends the hip and flexes the knee, the rectus femoris (RF), which flexes the hip and extends the knee, and the gastrocnemius (GAS), which flexes the knee and plantarflexes the ankle. The choice of muscles is based on the planar model proposed by Geyer and Herr [2010]. We have added the rectus femoris since we found that it improves the walking knee flexion profile during swing when compared to human data.", "publication_ref": ["b46", "b15", "b35", "b13", "b13"], "figure_ref": ["fig_0", "fig_0", "fig_0"], "table_ref": []}, {"heading": "Musculotendon Model", "text": "We employ a Hill-type model [Zajac 1989], where each MTU consists of three elements: contractile, parallel-elastic, and serialelastic. Conceptually, the contractile element (CE) models muscle fibers that can actively generate force (F CE ) depending on the current activation level (a). The parallel-elastic element (PE) models passive forces (F PE ) generated by the muscle fibers, while the serial-elastic element (SE) models the tendon.\nIn particular, given the length and velocity of CE (l CE , v CE ), as well as the current muscle activation level (a), we can compute the MTU force (F MTU ) as follows:\nF MTU = F CE + F PE , F CE = aF 0 f l (l CE )fv(\u1e7d CE ),\nwherel CE = l CE /l opt and\u1e7d CE = v CE /l opt . F 0 and l opt are musclespecific maximum isometric force and optimal fiber length parameters. f l and fv are the force-length and force-velocity curves (Figure 3). The computation of F PE and the analytic forms of f l and fv are described in the supplemental material. force-length force-velocity Intuitively, f l models the fact that muscles can generate force more efficiently near l opt , and fv captures how the muscle loses its ability to generate force as the contraction velocity increases [Zajac 1989].\nAs to be discussed in Section 4.1, the nonlinearity introduced by these relations is crucial for how simple control laws for muscle excitation can lead to complex force and torque trajectories.\nFigure 2 illustrates how the musculotendon model interacts with the controller and the simulator. The controller outputs neural excitation signals (u), which are converted to muscle activations (a). The conversion does not occur instantaneously and is referred to as activation dynamics. The dynamics is modeled by a first-order differential equation [Zajac 1989;Geyer et al. 2003], which can be integrated by at+1 = 100h(ut \u2212 at) + at, where h is the stepsize (1/2400 s) and at and ut are the muscle activation and excitation values at the t-th timestep. A step-response graph for the activation dynamics, as well as details on the l CE and v CE computations (contraction dynamics) are given in the supplemental material.\nThe joint torques generated by a given MTU is a function of the current body configuration. A simple variable moment arm model is assumed for MTUs attached to the knee or ankle: \u03c4 = rj cos(\u03b8 \u2212 \u03d5 M j )F MTU , where \u03b8 is the current knee or ankle angle in the sagittal plane, and rj is the maximum MTU-joint moment arm, which occurs at the joint angle \u03d5 M j . MTUs attached to the hip are assumed to have a constant moment arm: \u03c4 = rjF MTU . The total lower extremity joint torques in the sagittal plane are obtained by summing over contributions from all relevant muscles:\n\u03c4 hip = \u03c4GLU + \u03c4 hip HAM \u2212 \u03c4HFL \u2212 \u03c4 hip RF , \u03c4 knee = \u03c4 knee RF + \u03c4VAS \u2212 \u03c4 knee HAM \u2212 \u03c4 knee GAS , \u03c4 ankle = \u03c4 knee GAS + \u03c4SOL \u2212 \u03c4TA.", "publication_ref": ["b53", "b53", "b53", "b14"], "figure_ref": [], "table_ref": []}, {"heading": "Control Parameterization", "text": "The main part of our control algorithm consists of functions that determine muscle excitation values for each of the lower body MTUs, which actuate the hip, knee, and ankle DOFs in the sagittal plane.\nFor the upper body and the remaining DOFs in the lower body, we rely on a pose-graph controller [Yin et al. 2007].  parameters (dSI,dSP) to start swing initiation (SI) and stance preparation (SP), respectively. SI can also be started when the opposing leg makes ground contact (double stance).", "publication_ref": ["b51"], "figure_ref": [], "table_ref": []}, {"heading": "Stance", "text": "", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "Muscle Control", "text": "Our control laws for the actuators are based on the muscle-reflex controller introduced by Geyer and Herr [2010]. We will describe the basic formulation and our modifications in this section. Two different sets of control laws apply for each muscle, depending on whether the leg is in stance or swing phase (i.e., foot is on the ground or not). We further define a swing initiation state within the stance phase, and a stance preparation state within the swing phase, where control laws for a subset of MTUs are modified (Figure 4).\nThe control laws map time-delayed features of the body to muscle excitation signals. The time-delay (\u2206t) models the time for neural signal propagation, set to 5 ms for MTUs connected to the hip, 20 ms for MTUs connected to the ankle, 10 ms for the VAS and ground contact [Geyer and Herr 2010]. Body features include MTU force, fiber length, joint angle, and segment orientation. Depending on the input feature, three different mappings are defined: positive force feedback, positive length feedback, and muscle-driven proportional derivative (PD) control. These mappings serve as building blocks for the control laws, and we discuss each in turn in this section.\nPositive force feedback. Given MTU m, the positive force feedback law is defined as\nu F m = GmF MTU m (t \u2212 \u2206tm),\nwhereF MTU m (t \u2212 \u2206tm) is the MTU force normalized by F 0 m with a time-delay of \u2206tm. The only free parameter is a positive gain constant Gm, which is different for each MTU. Note thatF MTU m cannot increase indefinitely since the muscle's force generation capacity depends nonlinearly on the length and contraction velocity of the muscle fiber. AsF MTU m starts to decrease due to muscle physiology, u F m starts to decrease as well. The force feedback is the main source of activation to the SOL, GAS, and VAS muscles during the stance phase. Figure 5 shows the activation and fiber length of GAS during the stance phase. We can see that u F GAS produces a positive feedback during mid-stance, when the muscle activation does not produce a significant change in muscle fiber length, as the foot is planted on the ground. As the heel loses ground contact in late stance, the same muscle activation rapidly shortens the fiber length, which reduces force output and the activation through u F GAS .  (Section 4.1). While the foot is flat on the ground during mid-stance, GAS activation does not significantly change the fiber length, and force feedback leads to an activation build-up. As heel loses contact during late-stance, the fiber rapidly shortens and reduces f l and fv (Figure 3). As the generated force decreases, the same force feedback leads to a drop-off in activation.\nPositive length feedback. Positive length feedback is defined as\nu L m = Gm l CE m (t \u2212 \u2206tm) \u2212 Hm + , wherel CE m (t \u2212 \u2206tm)\nis the length of the muscle fiber normalized by the l opt m with a time-delay of \u2206tm. Gm and Hm are free positive parameters and {}\u00b1 means only positive or negative values (0 otherwise). The positive length feedback effectively models a stretch reflex, which activates the muscle when the fiber is stretched beyond a fixed length. u L m is most useful during the swing phase, as the TA must be activated to dorsiflex so that toe-stubbing can be avoided. In addition, the HFL relies on length feedback to generate hip flexion torque during early swing, especially during running.\nMuscle-driven PD control. We also define a muscle-driven PD control law with respect to an angular feature \u03b8 as\nu \u03b8 m = Km(\u03b8(t \u2212 \u2206tm) \u2212 \u03b8m) + Dm\u03b8(t \u2212 \u2206tm) \u00b1 ,\nwhere Km, Dm, \u03b8m are free parameters of the PD-controller. The braces sign is positive if torque generated by m is in the opposing direction of \u03b8-e.g., if m is the hip extensor and \u03b8 is the hip flexion angle-and negative otherwise. Much like the standard torquebased PD-controller, the muscle-driven PD control aims to adjust \u03b8 towards the target angle \u03b8m while damping its velocity. However, unlike the standard PD-controller, muscles can only activate after a time-delay and each muscle can only generate forces to rotate the angular DOF in one direction. The PD-control laws are employed by the hip muscles during the stance phase to maintain the global upper body orientation, as well as during stance preparation to prepare for ground contact.", "publication_ref": ["b13"], "figure_ref": ["fig_3", "fig_4"], "table_ref": []}, {"heading": "Stance Phase", "text": "Each muscle has an initial constant excitation, or pre-stimulation value pm. These values are initialized close to zero, but are then optimized. The SOL and GAS both rely on positive force feedback and are the main sources of torque during walking. The TA ensures foot clearance during swing using a length feedback (u L TA ), but the activation is suppressed during stance in proportion to the current force generated from SOL. The suppression allows the generated TA activation patterns to better match human data during locomotion. The force feedback on the VAS creates a strong knee extension torque following ground contact, but excitation is suppressed when the knee flexion angle (\u03b8 k ) is extended below an offset (\u03b8 off k ) with an extension velocity (\u03b8 k < 0). The suppression prevents hyperextension of the knee during mid-stance. Using muscle-driven PD control laws, the HAM, GLU, and HFL are responsible for maintaining the global orientation of the upper body (\u0398), defined as the vector between the COM of the upper body and the COM of the pelvis projected onto the sagittal plane. During double stance, these control laws are only active for the leading leg, denoted as u \u0398 m lead . Specifically, control laws during the stance phase are as follows:\nuSOL = pSOL + u F SOL , uTA = pTA + u L TA \u2212 u F SOL , uGAS = pGAS + u F GAS , uVAS = pVAS + u F VAS + k \u03b8 (\u03b8 k (t \u2212 \u2206tVAS) \u2212 \u03b8 off k ) \u2212,\u03b8 k <0 , uHAM = pHAM + {u \u0398 HAM }lead, uRF = pRF, uGLU = pGLU + {u \u0398 GLU }lead, uHFL = pHFL + {u \u0398 HFL }lead.\nTowards the end of the stance phase, the controller enters into the swing initiation, which begins when either the signed horizontal distance between the COM and the ankle normalized by leg length exceeds a constant thresholdd >dSI or if the opposing leg has entered into stance phase (double stance). During swing initiation, constant excitation values between 0 and 1 (set during optimization) are added and subtracted to the VAS, RF, GLU, and HFL:\nuVAS = uVAS \u2212 sVAS, uRF = uRF + sRF, uGLU = uGLU \u2212 sGLU, uHFL = uHFL + sHFL.\nThe combination of HFL and GLU excitations creates a large hip flexion torque, while the VAS and RF excitations effectively allow the optimizer to adjust the initial knee swing angle and velocity. Two main differences between our stance phase control laws compared to Geyer and Herr [2010] lie in how the swing initiation state functions. First, for running we found it necessary to enter into swing initiation using thed >dSI condition, rather than just wait for double stance. Second, we found it unnecessary to modulate the muscle-driven PD-control laws in the hip by ground reaction forces. Instead, the responsibility to maintain upper body orientation is always assigned to the lead leg.", "publication_ref": ["b13"], "figure_ref": [], "table_ref": []}, {"heading": "Swing Phase", "text": "Much like in the stance phase, each muscle has an initial constant excitation value (qm). The leg motion relies significantly on passive dynamics during the swing phase [Collins et al. 2005], as most muscles are only excited at low levels. The main exceptions are the TA, which maintains the length feedback (u L TA ) to avoid toestubbing, and the HAM, which is activated at late swing phase to prevent the knee from being overextended before landing. The HFL introduces a hip flexion torque through a length feedback, which is suppressed when the HAM is stretched in during late swing. The amount of excitation in the HFL also depends on the value of upper body lean at the beginning of the swing phase (\u0398lto): the further the upper body leans forward compared to the reference lean angle (\u0398 d ), the more excitation is supplied from the HFL during the swing phase. Note that \u0398 d is the same as the target angle in u \u0398 HFL . Non-constant control laws during the swing phase are as follows:\nuTA = qTA + u L TA , uHAM = qHAM + u F HAM , uGLU = qGLU + u F GLU , uHFL = qHFL + u L HFL \u2212 u L HAM + k\u0398(\u0398lto \u2212 \u0398 d ).\nThe controller enters into the stance preparation whend <dSP, where the swing leg enters into a PD-control mode. The GLU, HFL, and VAS work to guide the hip and knee joints toward a desired pose to prepare for ground contact:\nuVAS = qVAS + u \u03b8 k VAS , uGLU = qGLU + u \u03b8 h GLU , uHFL = qHFL + u \u03b8 h HFL .\nA single desired hip target angle (\u03b8 h ) is adjusted according to the SIMBICON balance feedback law [Yin et al. 2007] and is shared by both the GLU and HFL. We found the addition of the stance preparation state to be important for discovering running gaits. The balance feedback law allows robust control strategies to be found in difficult environments (e.g., being pushed by random forces).", "publication_ref": ["b6", "b51"], "figure_ref": [], "table_ref": []}, {"heading": "Out-of-Plane and Upperbody Control", "text": "The rest of the DOFs are controlled using standard joint-space PDcontrollers with state-dependent parameters. Following Wang et al. [2010], the target features for the ankle and hip joints in the coronal plane are the global foot and pelvis orientations, respectively. The coronal swing hip target angles follow the same feedback law as \u03b8 h . Additionally, we set the toe joint to be a spring with spring constant of 30 Nm/rad, target angle 0, and no damping. Unlike in previous work, where a gait cycle is broken down into four states, only two are needed (triggered by left/right foot-strike) since DOFs with the most complex activities are actuated by muscles.\nOur upper body control also largely follows Wang et al. [2010], with the exception that the target feature of our back joint in the coronal plane is the global orientation of the torso instead of the local joint angle between the torso and the pelvis. This global target allows our model to better keep the head upright during locomotion. We fix the spring and damper constants for all arm joints to 30 Nm/rad and 3 Nms/rad, respectively, with target angles set to 0. We found that more human-like arm swing can be generated by relating the elbow and shoulder target angles as \u03b8 l s = \u03b1arm \u03b8 l h \u2212 \u03b8 r h + \u03b2\u03b8 d e and \u03c6 l s = \u03b3\u03b8 d e , where \u03b8 l s and \u03c6 l s are the shoulder angles in the sagittal and transverse planes, respectively; \u03b8 l h and \u03b8 r h are the current left and right sagittal hip angles; \u03b8 d e is the desired elbow angle, \u03b2, \u03b3 are constants chosen based on human motion data (see supplemental material), and \u03b1arm is a scale constant that determines the magnitude of the arm swing. This formulation captures the tendency to rotate the shoulder backwards and inwards while bending the elbow. The scale constant and the desired elbow angle are among the parameters set by optimization, as described in the next section.\nThe control algorithm specified in Section 4 has a large number of parameters, which we set by optimization [Wang et al. 2010]. More specifically, each of the u F m , u L m , and u \u03b8 m laws have one, two, and three parameters, respectively. There are 56 parameters in total (30 stance, 26 swing) for the MTU control laws. For the upper body and the non-sagittal DOFs in the lower body, we optimize the PDcontrol parameters (spring-damper constants, target angle, balance feedback) for all joints except for arms, where only a target elbow angle and a swing scale parameter are optimized (Section 4.4). When combined with 33 free parameters describing the initial state of the simulation, 124 parameters (w) fully define a simulated motion {s1 . . . sT } over T timesteps. We optimize control parameters and the initial state using Covariance Matrix Adaptation (CMA) [Hansen 2006], with stepsize \u03c3 = 0.005 and 50 samples per iteration.\nThe optimization aims to maximize the following return function:\nR (w) = T t=1 r(st) \u2212 weJeffort.\nHere r is a scalar reward function of the current state st, Jeffort measures the effort of the synthesized motion, and we is set to 0.004 divided by the mass of the model, motivated by Wang et al. [2010].\nThe reward is defined as the negative sum of a number of task terms (i.e., r(st) = \u2212 i Ki(st)), which can be thought of as high-priority goals that the controller must satisfy while minimizing effort. In practice, these terms are weighed more heavily than the effort term. The tasks include moving the COM forward at a target velocity while not falling down for 10 seconds, and maintaining head stability and upper body orientation. The task terms are based on Wang et al. [2010] and are defined in the supplemental material. Note that unlike in previous work, we did not need to include human-like speed to step-length ratio and minimal angular momentum about the COM as task terms.", "publication_ref": ["b46", "b46", "b46", "b16", "b46", "b46"], "figure_ref": [], "table_ref": []}, {"heading": "Effort Term", "text": "The main contribution to our effort measurement is the total rate of metabolic energy expenditure (\u0116) over all MTUs. To quantif\u1e8f E, we implement a model described by Anderson [1999], which is later expanded by Bhargava et al. [2004]. The rate of metabolic energy expenditure for a given muscle can be modeled as the sum of heat released and mechanical work done by the muscle:\nE =\u0226 +\u1e40 +\u1e60 +\u1e86 ,\nwhere\u0226 is the muscle activation heat rate,\u1e40 is the muscle maintenance heat rate,\u1e60 is the muscle shortening heat rate, and\u1e86 is the positive mechanical work rate.\nThe muscle activation heat rate models the rate of energy that is converted to heat by a muscle given a certain level of activation, and is a function of both the mass of the muscle and the excitation signal. The maintenance heat rate similarly models the heat rate for the muscle to maintain contraction at a certain level, and depends additionally on the current fiber length. Specifically,\nA = mass \u2022 fA(u) and\u1e40 = mass \u2022 g(l CE )fM (a),\nwhere mass is the muscle mass andl CE is the normalized muscle fiber length. The forms of fA, fM , and g are described in the supplemental material. The dependence on muscle mass captures the fact that while larger muscles are generally capable of generating more force, they are also more costly to use.\nThe muscle shortening heat rate models the heat generated by the shortening of muscle fibers and is proportional to the current force generated by the muscle and the shortening velocity:\nS = 0.25F MTU {\u2212v CE }+.\nFinally, the positive mechanical work rate is the mechanical power produced by the active element of the MTU during contraction:\nW = F CE {\u2212v CE }+.\nNote that\u1e60 is close to one-quarter of\u1e86 . The difference is that F MTU is the net force (both active and passive) produced in the MTU, while F CE is only the active force.\nLet\u0116m,t denote the rate of metabolic energy expenditure computed for MTU m at timestep t. We define the average rate of metabolic expenditure due to MTUs as\nJM =\u1e02 + 1 T T t=1 m\u2208M\u0116 m,t,\nwhere\u1e02 is the basal metabolic energy rate, set to 1.51 times body mass [Anderson 1999]. M is the set of all sixteen muscles defined in the model.\nAdditionally, torques generated by the PD-controllers in the rest of the DOFs are penalized by the average sum of torque squared objective:\nJR = 1 T T t=1 j\u2208Qr \u03c4 2 j,t ,\nwhere Qr is the set of all joint DOFs except for the sagittal hips, knees, and ankles. We similarly define JL to penalize the average sum of squared soft joint limit torques for the hip, knee, and ankle joints, specified in Geyer and Herr [2010].\nThe overall effort of a particular motion is defined as Jeffort = wM JM + wRJR + wLJL, a weighted sum between the terms. We empirically set wM = 100, wR = 1, and wL = 0.5 for all experiments.", "publication_ref": ["b3", "b4", "b3", "b13"], "figure_ref": [], "table_ref": []}, {"heading": "Experiments", "text": "The simulations were implemented using Open Dynamics Engine (ODE) with a frequency of 2400 Hz. We simulate for T = 24000 timesteps (10 s) in each evaluation. The optimization is terminated after 3000 iterations, which takes approximately 10 hours using 50 compute cores on a cluster of Dell PowerEdge 1950 servers. An optimized controller can be simulated at interactive rates using standard hardware. We initialize walking parameters of the MTU control laws based on hand-tuned values for 2D walking from Geyer and Herr [2010]. For running, we double the initial gain parameters of GAS and SOL, and initialize \u03b8 d e to set the elbow in a bent position. The precise initialization values are provided in the supplemental material.", "publication_ref": ["b13"], "figure_ref": [], "table_ref": []}, {"heading": "Ground Truth Data", "text": "Human joint moment (torque) curves during locomotion can be computed from motion capture and ground reaction force data.\nIn this work we are particularly interested in comparing our results to the mean and standard deviation curves for the sagittal hip, knee, and ankle joints for multiple subjects over multiple walking and running speeds. While such data for walking is readily available [Perry and Burnfield 2010],  [Coros et al. 2009] matches joint angle data relatively well, but lacks hip extension and relies primarily on hip torques. The robust feature-based controller [Mordatch et al. 2010] walks in a crouch and uses large knee torques. A controller optimized for human-like torque distributions [Wang et al. 2010] fails to generate human-like joint angles and torques. Our result (swalk in Table 1), optimized with a target velocity of 1.0 m/s, best matches human data.\nonly scattered data are available for running [Novacheck 1998;Yokozawa et al. 2007;Hamner et al. 2010]. Instead, we acquired our own ground truth data using an instrumented treadmill with 20 subjects.\nThis data is available from http://graphics.stanford.edu/projects/bio-locomotion.\nWe acquired kinematics and dynamics data for a range of walking and running speeds (from 1.0 m/s to 5.0 m/s). The supplemental material includes angle and moment plots for all speeds, as well as details on our data collection. Comparing the mean curves for walking speeds from 1.0 m/s to 1.75 m/s, we found that the range of hip angles in our subjects during walking increased by approximately 10 \u2022 , while the location of maximum ankle plantarflexion shifted slightly earlier in the gait cycle. More pronounced differences are present between running data at different speeds. The hip angle range and maximum knee flexion both increased by 30 \u2022 as running speed increased from 2.0 m/s to 5.0 m/s, while locations of both the maximum hip extension and ankle plantarflexion shifted earlier by 5% and 10%, respectively. Both the hip and ankle torque outputs increased with speed, though the ankle torque curves did not differ significantly between 4.0 m/s and 5.0 m/s.", "publication_ref": ["b35", "b7", "b31", "b46", "b34", "b52", "b15"], "figure_ref": [], "table_ref": []}, {"heading": "Walking Controllers", "text": "We first optimized for a normal walking controller (referred to below as nwalk) with a target velocity of 1.25 m/s, which is approx-imately the human self-selected walking speed. Initializing with the normal controller, we then optimized for a 1.0 m/s slow walk controller (swalk) and a 1.5 m/s fast walk controller (fwalk). A 1.75 m/s very fast walk controller (vfwalk) is optimized by initializing from fwalk.\nComparison to ground truth. Supplemental figures indicate that our kinematic patterns generally agree with data over a range of speeds and especially at lower speeds. Two main discrepancies are the timing of knee flexion during stance, and ankle dorsiflexion before heel-strike. For higher speeds, the maximum knee flexion angle is lower than human data, and the location of maximum ankle plantarflexion occurs earlier in the gait cycle. All angle and moment curves shown are averaged over multiple cycles. Note that we found time-delays to be important for generating human-like motion given our control model. Optimizing without activation dynamics and with \u2206tm = 0 for all MTUs results in a solution where ankle torques build up too quickly in the stance phase, leading to shorter step-lengths compared to human data.\nFigure 6a shows the hip, knee, and ankle angles of walking data generated by our 1.0 m/s controller (swalk) compared to controllers of similar speeds presented by previous contributions [Coros et al. 2009;Mordatch et al. 2010;Wang et al. 2010], as well as human data at 1.0 m/s. A major artifact from all of the previous works is the lack of hip extension during mid-gait, which does not occur in our result. The feature-based controller of  is robust and flexible, but their basic walking gait shows an obvious crouch. Our result also exhibits a range of knee motion more similar to humans compared to previous works. However, all four controllers show excessive dorsiflexion before heel-strike.\nAn important advantage of optimization over hand-tuning is the ability to create controllers based on high-level objectives such as walking speed. As demonstrated in supplemental material, our controllers generate more human-like gaits compared to optimized controllers from Wang et al. [2010] at faster walking speeds (Wang10f, Wang10vf ) as well. An obvious artifact of all controllers from Wang et al. [2010] is the excessive plantarflexion in the early swing phase, which is not present in our result. 1\nExamining differences in torque generation, we can see that the controller presented by Coros et al. [2009] does not employ a human-like torque distribution between the joints (Figure 6b). In particular, as was the case in SIMBICON [Yin et al. 2007], the gait is largely hip-driven, as can be seen by the large hip torques and small ankle torques compared to human data. In turn, controllers from Wang et al. [2010] generated larger amounts of ankle torque by optimizing for a human-like torque ratio, but did not come close to matching the shapes of human torque data. Note that our work does not exhibit unnatural torque spikes due to state switching that are present in the previous works.\nTable 1 shows quantitative comparisons between the controllers. We compute the mean standard score against human data over 100 evenly spaced points on the curves. Note that our results show the lowest average standard score for all speeds.\nEvaluation of objective. We evaluate the metabolic energy expenditure objective described in Section 5 against the simple sum of squared torques objective, by redefining\nJM = 1 T T t=1 j\u2208Qs \u03c4 2 j,t ,\nwhere Qs is the set of sagittal hip, knee, and ankle DOFs (with wM = 5). Controllers optimized for each of the two objectives (nwalk, min torque) are demonstrated in the accompanying video.\nFor this comparison, we use a target speed of 1.25 m/s, which is the same as nwalk. The gait resulting from torque minimization exhibits too much knee flexion during the swing phase and too much dorsiflexion before heel-strike. Closer examination reveals that the TA muscle, responsible for dorsiflexion, is highly activated throughout the gait when only torque is being minimized. Since the foot is a relatively light link, the actual magnitude of the dorsiflexion torque is not large even when the TA is fully activated, therefore it does not incur a large penalty in the torque objective. In contrast, the metabolic energy objective captures the fact that activating and maintaining contraction of TA generates significant heat and should therefore be discouraged. Note that unlike dorsiflexion torques, large ankle plantarflexion torques can be generated with relative ease. Simply increasing the penalty on ankle torques does not account for the effort difference between generating torques in different directions.\nA simple objective that could approximate effort given a musculoskeletal model is the sum of squared muscle activations, which is commonly used in static optimization-a technique for recovering activations given motion capture and force plate data [Anderson 1999]. However, as demonstrated in the accompanying video, this objective also does not lead to faithful walking kinematics. Here we define\nJM = 1 T T t=1 m\u2208M a 2 m,t ,\nwhere M is the set of MTUs, and am,t is the activation level of MTU m at timestep t (with wM = 60000). In the gait produced by the controller that minimizes this objective (min act), activations from the GAS/SOL are significantly lowered, while activations from VAS are increased. While the total amount of activations is reduced, the resulting gait walks in a crouch and relies heavily on the knee.\nTable 1 includes average standard score values compared against human data at 1.25 m/s. Controllers optimized using the torque and activation objectives both exhibit large errors compared to nwalk, especially at the ankle joint. While noticeable kinematic differences are seen in the gaits produced by different objectives, the torque curves are smooth due to the muscle model and the control parameterization.\nChanging muscle properties. The plantarflexors (GAS and SOL) are largely responsible for forward propulsion in normal walking [Liu et al. 2008]. We found that weakening the GAS and SOL to a quarter of their original strength, while keeping all other objectives identical (target speed 1.25 m/s), results in a mild crouch gait characterized by excessive knee flexion (see accompanying video). Our result suggests that under the condition of weakened plantarflexors, the mild crouch gait may be metabolically efficient compared to other gait choices. The crouch gait is commonly found in cerebral palsy patients, and weakness in the plantarflexors is one of many factors thought to contribute to the gait abnormality [Steele et al. 2010].\nKnee hyperextension, another common gait abnormality, causes patients to vault the body forward over the extended stance limb, and can result from hamstring lengthening surgery in cerebral palsy patients [Kay et al. 2002]. In the accompanying video, we show that our optimization indeed results in a mild hyperextension gait after weakening HAM to a quarter of its original strength, with a minimum knee flexion angle of 2 \u2022 . Note that the same angle for the gait generated by nwalk is 9 \u2022 . Another cause of knee hyperextension is weakened quadriceps, which can be simulated by weakening the VAS in our model. We found that weakening the VAS to one-tenth of its original strength leads to a motion similar to quadriceps avoidance gait, which is seen in patients with quadriceps weakness and anterior cruciate ligament (ACL) deficiency [Timoney et al. 1993].  ", "publication_ref": ["b7", "b31", "b46", "b46", "b46", "b7", "b51", "b46", "b3", "b30", "b41", "b21", "b44"], "figure_ref": ["fig_5", "fig_5"], "table_ref": []}, {"heading": "Running Controllers", "text": "Our controller architecture and objective function is not limited or specific to walking alone. By simply changing the target velocity and initialization (changing the initial velocity from 1.3 m/s to 3.05 m/s, doubling the initial force feedback gains for GAS and SOL, and bending the elbow), the same procedure yields running controllers, without any modifications to the control parameterization. In contrast, previous optimization-based control synthesis methods required including torque ratios specific to walking as part of the objective [Wang et al. 2009] or adding spring elements for running [Wu and Popovi\u0107 2010]. Our unified approach to both walking and running is consistent with the view that humans select between walking and running by minimizing energy at different speeds [Srinivasan and Ruina 2006].\nWe compare running motions generated by our controller at 4.0 m/s with human running data in Figure 7. Our running kinematic results do not match human data as well as walking, though the basic features of the curves are still present. A main discrepancy is that our hip and knee joints both reach maximum extension earlier than human running data. Similar to our walking results, our knee joint flexes less during the stance phase compared to humans. Our maximum knee flexion is also lower than human data.\nFigure 7b reveals possible causes for the kinematic differences. Our knee extension torque reaches maximum earlier than human data, which can cause the knee to extend too quickly during the stance phase. On the other hand, our plantarflexion torques have a lower peak than human data, resulting in a strategy that relies on the knees more than the ankles. In the supplemental material and the video, we include results for running at speeds ranging from 3.0 m/s to 5.0 m/s. The faster running results are optimized sequentially in 0.5 m/s increments (e.g., 4.0 m/s initialized from 3.5 m/s). As the target velocity increases, finding a satisfactory local minimum appears more difficult. We use 100 samples per iteration and a 0.25 m/s optimization increment for speeds over 4.0 m/s.", "publication_ref": ["b45", "b49", "b40"], "figure_ref": ["fig_7", "fig_7"], "table_ref": []}, {"heading": "Robustness", "text": "In this work, we have chosen to focus on reproducing humanlike kinematics and torque trajectories. Likely due to our modeling of human-like torque generation and activation delays, our controllers cannot tolerate nearly as much external force as recently developed controllers for purely joint-actuated characters [Mordatch et al. 2010;Wang et al. 2010]. However, we can still follow Wang et al. [2010] and optimize explicitly for controllers that can deal with external forces. In particular, we optimized controllers that can tolerate 100 N, 0.4 s pushes to the torso. These controllers chose to walk in a stiff crouch gait, with lowered COM and a constantly dorsiflexed ankle to ensure foot clearance (see accompanying video). Note that 100 N is approximately the weight of a 10 kg object, a significant push to a human. Comparatively, the corresponding 100 N controller presented by Wang et al. [2010], who did not model biological torque generation constraints, did not employ a gait that is significantly different from the undisturbed baseline controller. We also optimized for a 4.0 m/s running controller tolerant of 50 N, 0.4 s pushes, as shown in the video.\nWe have presented a biologically-motivated control parameterization that can be used to automatically generate 3D human-like walking and running controllers of different speeds. Controllers are optimized to satisfy a set of high-level task terms while minimizing an effort term based on modeling the rate of metabolic energy expenditure. Notably, walking and running emerge from the same optimization process simply by changing the target velocity and initialization. Through comparisons to kinematic and torque data of human walking, we show that our results adopt a human-like torque generation strategy while producing kinematic data significantly closer to humans than previous work. Our work demonstrates the importance of modeling constraints on torque generation due to muscle physiology, both in restricting the space of possible torque trajectories and in providing a realistic model of effort.\nWe chose to focus on generating human-like locomotion in a straight line and on flat ground. A natural extension is to investigate whether our control parameterization and effort term can be combined with the popular task-space controllers [Coros et al. 2010;de Lasa et al. 2010;Wu and Popovi\u0107 2010] and higher-level planning [Coros et al. 2009;Mordatch et al. 2010] to create humanlike motions on uneven terrains [Wu and Popovi\u0107 2010] or obstacle courses [Mordatch et al. 2010;Ye and Liu 2010]-scenarios that have only been addressed using purely joint-actuated characters.\nFinally, an exciting area for future work is to automatically synthesize locomotion controllers for more detailed, fully muscle-actuated human models [Weinstein et al. 2008;Lee et al. 2009]. As we have touched on in Section 6.2, our approach can be used to develop predictive biomechanical models to investigate the effects of muscle and control properties on gait. However, more scientific validation of our simulation results is needed before we can conclude that our results apply to real humans. One clear aspect for improvement is to adopt a more physically-accurate simulation engine [Sherman et al. 2011], as ODE \"emphasizes speed and stability over physical accuracy\" [Smith 2006]. More accurate simulations and detailed models present additional computational challenges both in simulation speed and in parameter optimization, but are crucial for potential scientific and medical applications.", "publication_ref": ["b31", "b46", "b46", "b46", "b8", "b10", "b49", "b7", "b31", "b49", "b31", "b50", "b48", "b27", "b38"], "figure_ref": [], "table_ref": []}, {"heading": "Acknowledgements", "text": "We thank Stelian Coros and Igor Mordatch for making their simulation data available. Thanks to Jared Duke for early contributions, Tim Dorn for comments on the manuscript, and Ajay Seth, Edith Arnold, and Katherine Steele for inspiring technical discussions. We thank the anonymous reviewers for their helpful and constructive comments. This work was funded in part by NSF grants IIS-1017938 and CNS-0619926, NIH grants U54 GM072970, R24 HD065690, and R01 HD033929, and an AWS research grant. This research was conducted in conjunction with the Intel Science and Technology Center for Visual Computing.", "publication_ref": [], "figure_ref": [], "table_ref": []}], "references": [{"ref_id": "b0", "title": "Optimality principles for model-based prediction of human gait", "journal": "Journal of Biomechanics", "year": "2010", "authors": "M Ackermann;  Van Den; A J Bogert"}, {"ref_id": "b1", "title": "Principles of Animal Locomotion", "journal": "Princeton University Press", "year": "2003", "authors": "R M Alexander"}, {"ref_id": "b2", "title": "Dynamic optimization of human walking", "journal": "Journal of Biomechanical Engineering", "year": "2001", "authors": "F C Anderson; M G Pandy"}, {"ref_id": "b3", "title": "A dynamic optimization solution for a complete cycle of normal gait", "journal": "", "year": "1999", "authors": "F C Anderson"}, {"ref_id": "b4", "title": "A phenomenological model for estimating metabolic energy consumption in muscle contraction", "journal": "Journal of Biomechanics", "year": "2004", "authors": "L J Bhargava; M G Pandy; F C Anderson"}, {"ref_id": "b5", "title": "The spring-mass model for running and hopping", "journal": "Journal of Biomechanics", "year": "1989", "authors": "R Blickhan"}, {"ref_id": "b6", "title": "Efficient bipedal robots based on passive-dynamic walkers", "journal": "Science", "year": "2005", "authors": "S Collins; A Ruina; R Tedrake; M Wisse"}, {"ref_id": "b7", "title": "Robust task-based control policies for physics-based characters", "journal": "ACM Transactions on Graphics", "year": "2009", "authors": "S Coros; P Beaudoin;  Van De; M Panne"}, {"ref_id": "b8", "title": "", "journal": "Generalized biped walking control. ACM Transactions on Graphics", "year": "2010", "authors": "S Coros; P Beaudoin;  Van De; M Panne"}, {"ref_id": "b9", "title": "Interactive simulation of stylized human locomotion", "journal": "ACM Transactions on Graphics", "year": "2008", "authors": " Da; M Silva; Y Abe; J Popovi\u0107"}, {"ref_id": "b10", "title": "Feature-based locomotion controllers", "journal": "ACM Transactions on Graphics", "year": "2010", "authors": "M De Lasa; I Mordatch; A Hertzmann"}, {"ref_id": "b11", "title": "Composable controllers for physics-based character animation", "journal": "ACM", "year": "2001", "authors": "P Faloutsos; M Van De Panne; D Terzopoulos"}, {"ref_id": "b12", "title": "Templates and anchors: Neuromechanical hypotheses of legged locomotion on land", "journal": "The Journal of Experimental Biology", "year": "1999", "authors": "R J Full; D E Koditschek"}, {"ref_id": "b13", "title": "A muscle-reflex model that encodes principles of legged mechanics produces human walking dynamics and muscle activities", "journal": "IEEE Transactions on Neural Systems and Rehabilitation Engineering", "year": "2010", "authors": "H Geyer; H Herr"}, {"ref_id": "b14", "title": "Positive force feedback in bouncing gaits?", "journal": "Proceedings of the Royal Society B", "year": "2003", "authors": "H Geyer; A Seyfarth; R Blickhan"}, {"ref_id": "b15", "title": "Muscle contributions to propulsion and support during running", "journal": "Journal of Biomechanics", "year": "2010", "authors": "S R Hamner; A Seth; S L Delp"}, {"ref_id": "b16", "title": "The CMA evolution strategy: A comparing review", "journal": "Springer", "year": "2006", "authors": "N Hansen"}, {"ref_id": "b17", "title": "Human gait simulation with a neuromusculoskeletal model and evolutionary computation", "journal": "Journal of Visualization and Computer Animation", "year": "2003", "authors": "K Hase; K Miyashita; S Ok; Y Arakawa"}, {"ref_id": "b18", "title": "Animating human athletics", "journal": "ACM", "year": "1995", "authors": "J K Hodgins; W L Wooten; D C Brogan; J F Brien"}, {"ref_id": "b19", "title": "Controlling physics-based characters using soft contacts", "journal": "ACM Transactions on Graphics", "year": "2011", "authors": "S Jain; C K Liu"}, {"ref_id": "b20", "title": "Optimization-based interactive motion synthesis", "journal": "ACM Transactions on Graphics", "year": "2009", "authors": "S Jain; Y Ye; C K Liu"}, {"ref_id": "b21", "title": "Outcome of medial versus combined medial and lateral hamstring lengthening surgery in cerebral palsy", "journal": "Journal of Pediatric Orthopaedics", "year": "2002", "authors": "R M Kay; S A Rethiefsen; D Skaggs; A Leet"}, {"ref_id": "b22", "title": "A simple model of bipedal walking predicts the preferred speed-step length relationship", "journal": "Journal of Biomechanical Engineering", "year": "2001", "authors": "A D Kuo"}, {"ref_id": "b23", "title": "Control systems for human running using an inverted pendulum model and a reference motion capture sequence", "journal": "", "year": "2010", "authors": "T Kwon; J Hodgins"}, {"ref_id": "b24", "title": "Limit cycle control and its application to the animation of balancing and walking", "journal": "ACM", "year": "1996", "authors": "J F Laszlo; M Van De Panne; E Fiume"}, {"ref_id": "b25", "title": "Heads up!: Biomechanical modeling and neuromuscular control of the neck", "journal": "ACM Transactions on Graphics", "year": "2006", "authors": "S.-H Lee; D Terzopoulos"}, {"ref_id": "b26", "title": "Realistic modeling for facial animation", "journal": "ACM", "year": "1995", "authors": "Y Lee; D Terzopoulos; K Waters"}, {"ref_id": "b27", "title": "Comprehensive biomechanical modeling and simulation of the upper body", "journal": "ACM Transactions on Graphics", "year": "2009", "authors": "S.-H Lee; E Sifakis; D Terzopoulos"}, {"ref_id": "b28", "title": "Data-driven biped control", "journal": "ACM Transactions on Graphics", "year": "2010", "authors": "Y Lee; S Kim; J Lee"}, {"ref_id": "b29", "title": "Learning physics-based motion style with nonlinear inverse optimization", "journal": "ACM Transactions on Graphics", "year": "2005", "authors": "C K Liu; A Hertzmann; Z Popovi\u0107"}, {"ref_id": "b30", "title": "Muscle contributions to support and progression over a range of walking speeds", "journal": "Journal of Biomechanics", "year": "2008", "authors": "M Q Liu; F C Anderson; M H Schwartz; S L Delp"}, {"ref_id": "b31", "title": "Robust physics-based locomotion using low-dimensional planning", "journal": "ACM Transactions on Graphics", "year": "2010", "authors": "I Mordatch; M De Lasa; A Hertzmann"}, {"ref_id": "b32", "title": "Contact-aware nonlinear control of dynamic characters", "journal": "ACM Transactions on Graphics", "year": "2009", "authors": "U Muico; Y Lee; J Popovi\u0107; Z Popovi\u0107"}, {"ref_id": "b33", "title": "A neuromuscular locomotion controller that realizes human-like responses to unexpected disturbances", "journal": "IEEE", "year": "1997", "authors": "A Murai; K Yamane"}, {"ref_id": "b34", "title": "The biomechanics of running. Gait and Posture", "journal": "", "year": "1998", "authors": "T F Novacheck"}, {"ref_id": "b35", "title": "Gait Analysis: Normal and Pathological Function", "journal": "Slack Incorporated", "year": "2010", "authors": "J Perry; J Burnfield"}, {"ref_id": "b36", "title": "Animation of dynamic legged locomotion", "journal": "ACM", "year": "1991", "authors": "M H Raibert; J K Hodgins"}, {"ref_id": "b37", "title": "Modeling and optimal control of human-like running", "journal": "IEEE/ASME Transactions on Mechatronics", "year": "2010", "authors": "G Schultz; K Mombaur"}, {"ref_id": "b38", "title": "Simbody: Multibody dynamics for biomedical research", "journal": "", "year": "2011", "authors": "M Sherman; A Seth; S L Delp"}, {"ref_id": "b39", "title": "Automatic determination of facial muscle activations from sparse motion capture marker data", "journal": "ACM Transactions on Graphics", "year": "2005-02", "authors": "E Sifakis; I Neverov; R Fedkiw"}, {"ref_id": "b40", "title": "Computer optimization of a minimal biped model discovers walking and running", "journal": "Nature", "year": "2006", "authors": "M Srinivasan; A Ruina"}, {"ref_id": "b41", "title": "Muscle contributions to support and progression during single-limb stance in crouch gait", "journal": "Journal of Biomechanics", "year": "2010", "authors": "K M Steele; A Seth; J L Hicks; M S Schwartz; S L Delp"}, {"ref_id": "b42", "title": "Musculotendon simulation for hand animation", "journal": "ACM Transactions on Graphics", "year": "2008", "authors": "S Sueda; A Kaufman; D K Pai"}, {"ref_id": "b43", "title": "A model of the neuro-musculo-skeletal system for human locomotion. I. Emergence of basic gait", "journal": "Biological Cybernetics", "year": "1995", "authors": "G Taga"}, {"ref_id": "b44", "title": "Return of normal gait patterns after anterior cruciate ligament reconstruction", "journal": "The American Journal of Sports Medicine", "year": "1993", "authors": "J M Timoney; W S Inman; P M Quesada; P F Sharkey; R L Barrack; H B Skinner; A H Alexander"}, {"ref_id": "b45", "title": "Optimizing walking controllers", "journal": "ACM Transactions on Graphics", "year": "2009", "authors": "J M Wang; D J Fleet; A Hertzmann"}, {"ref_id": "b46", "title": "Optimizing walking controllers for uncertain inputs and environments", "journal": "ACM Transactions on Graphics", "year": "2010", "authors": "J M Wang; D J Fleet; A Hertzmann"}, {"ref_id": "b47", "title": "A muscle model for animation threedimensional facial expression", "journal": "ACM", "year": "1987", "authors": "K Waters"}, {"ref_id": "b48", "title": "Impulse-based control of joints and muscles", "journal": "IEEE Transactions on Visualization and Computer Graphics", "year": "2008", "authors": "R Weinstein; E Guendelman; R Fedkiw"}, {"ref_id": "b49", "title": "Terrain-adaptive bipedal locomotion control", "journal": "ACM Transactions on Graphics", "year": "2010", "authors": "J.-C Wu; Z Popovi\u0107"}, {"ref_id": "b50", "title": "Optimal feedback control for character animation using an abstract model", "journal": "ACM Transactions on Graphics", "year": "2010", "authors": "Y Ye; C K Liu"}, {"ref_id": "b51", "title": "SIMBI-CON: Simple biped locomotion control", "journal": "ACM Transactions on Graphics", "year": "2007", "authors": "K Yin; K Loken;  Van De; M Panne"}, {"ref_id": "b52", "title": "Muscle activities of the lower limb during level and uphill running", "journal": "Journal of Biomechanics", "year": "2007", "authors": "T Yokozawa; N Fujii; M Ae"}, {"ref_id": "b53", "title": "Muscle and tendon: Properties, models, scaling, and application to biomechanics and motor control", "journal": "Critical Reviews in Biomedical Engineering", "year": "1989", "authors": "F E Zajac"}, {"ref_id": "b54", "title": "Breathe easy: Model and control of human respiration for computer animation", "journal": "Graphical Models", "year": "2006", "authors": "V B Zordan; B Celly; B Chiu; P C Dilorenzo"}], "figures": [{"figure_label": "1", "figure_type": "figure", "figure_id": "fig_0", "figure_caption": "Figure 1 :1Figure 1: Humanoid model. (a) Sixteen Hill-type MTUs, shown in red, generate torques for the hips, knees, and ankles. Note that the back joint is not rendered for aesthetic reasons. (b) Five uniarticular muscles in each leg produce flexion or extension torques at single joints. (c) Three biarticular muscles in each leg generate torques at pairs of joints. See Section 3 for details.", "figure_data": ""}, {"figure_label": "", "figure_type": "figure", "figure_id": "fig_1", "figure_caption": "-are exclusively generated by eight", "figure_data": ""}, {"figure_label": "4", "figure_type": "figure", "figure_id": "fig_3", "figure_caption": "Figure 4 :4Figure 4: High-level control states for each leg. The stance and swing phases are triggered by ground contact conditions. The signed horizontal distance between the COM and the ankle (d) normalized by leg length (d) is compared against two thresholdparameters (dSI,dSP)  to start swing initiation (SI) and stance preparation (SP), respectively. SI can also be started when the opposing leg makes ground contact (double stance).", "figure_data": ""}, {"figure_label": "5", "figure_type": "figure", "figure_id": "fig_4", "figure_caption": "Figure 5 :5Figure5: Effects of muscle physiology on activation illustrated by GAS activation and normalized fiber length during the stance phase. Note the nonlinearity of the activation curve generated by the linear force feedback control law(Section 4.1). While the foot is flat on the ground during mid-stance, GAS activation does not significantly change the fiber length, and force feedback leads to an activation build-up. As heel loses contact during late-stance, the fiber rapidly shortens and reduces f l and fv (Figure3). As the generated force decreases, the same force feedback leads to a drop-off in activation.", "figure_data": ""}, {"figure_label": "6", "figure_type": "figure", "figure_id": "fig_5", "figure_caption": "Figure 6 :6Figure 6: Comparison between walking controllers with speeds near 1.0 m/s. The shaded areas represent one standard deviation of the ground truth human data at 1.0 m/s. The hand-tuned SIMBICON-style controller[Coros et al. 2009] matches joint angle data relatively well, but lacks hip extension and relies primarily on hip torques. The robust feature-based controller[Mordatch et al. 2010] walks in a crouch and uses large knee torques. A controller optimized for human-like torque distributions[Wang et al. 2010] fails to generate human-like joint angles and torques. Our result (swalk in Table1), optimized with a target velocity of 1.0 m/s, best matches human data.", "figure_data": ""}, {"figure_label": "7", "figure_type": "figure", "figure_id": "fig_7", "figure_caption": "Figure 7 :7Figure 7: Comparison of running. Our result is optimized with a target velocity of 4.0 m/s. The shaded regions represent one standard deviation of the human running data at 4.0 m/s.", "figure_data": ""}], "formulas": [{"formula_id": "formula_0", "formula_text": "F MTU = F CE + F PE , F CE = aF 0 f l (l CE )fv(\u1e7d CE ),", "formula_coordinates": [3.0, 120.73, 637.45, 106.59, 25.99]}, {"formula_id": "formula_1", "formula_text": "\u03c4 hip = \u03c4GLU + \u03c4 hip HAM \u2212 \u03c4HFL \u2212 \u03c4 hip RF , \u03c4 knee = \u03c4 knee RF + \u03c4VAS \u2212 \u03c4 knee HAM \u2212 \u03c4 knee GAS , \u03c4 ankle = \u03c4 knee GAS + \u03c4SOL \u2212 \u03c4TA.", "formula_coordinates": [3.0, 370.42, 585.67, 135.11, 42.02]}, {"formula_id": "formula_2", "formula_text": "u F m = GmF MTU m (t \u2212 \u2206tm),", "formula_coordinates": [4.0, 122.93, 546.86, 102.18, 11.37]}, {"formula_id": "formula_3", "formula_text": "u L m = Gm l CE m (t \u2212 \u2206tm) \u2212 Hm + , wherel CE m (t \u2212 \u2206tm)", "formula_coordinates": [4.0, 317.95, 364.88, 195.34, 35.89]}, {"formula_id": "formula_4", "formula_text": "u \u03b8 m = Km(\u03b8(t \u2212 \u2206tm) \u2212 \u03b8m) + Dm\u03b8(t \u2212 \u2206tm) \u00b1 ,", "formula_coordinates": [4.0, 331.64, 526.71, 212.67, 15.67]}, {"formula_id": "formula_5", "formula_text": "uSOL = pSOL + u F SOL , uTA = pTA + u L TA \u2212 u F SOL , uGAS = pGAS + u F GAS , uVAS = pVAS + u F VAS + k \u03b8 (\u03b8 k (t \u2212 \u2206tVAS) \u2212 \u03b8 off k ) \u2212,\u03b8 k <0 , uHAM = pHAM + {u \u0398 HAM }lead, uRF = pRF, uGLU = pGLU + {u \u0398 GLU }lead, uHFL = pHFL + {u \u0398 HFL }lead.", "formula_coordinates": [5.0, 62.71, 242.84, 222.61, 123.25]}, {"formula_id": "formula_6", "formula_text": "uVAS = uVAS \u2212 sVAS, uRF = uRF + sRF, uGLU = uGLU \u2212 sGLU, uHFL = uHFL + sHFL.", "formula_coordinates": [5.0, 134.34, 455.91, 79.35, 47.82]}, {"formula_id": "formula_7", "formula_text": "uTA = qTA + u L TA , uHAM = qHAM + u F HAM , uGLU = qGLU + u F GLU , uHFL = qHFL + u L HFL \u2212 u L HAM + k\u0398(\u0398lto \u2212 \u0398 d ).", "formula_coordinates": [5.0, 350.01, 161.21, 175.92, 57.55]}, {"formula_id": "formula_8", "formula_text": "uVAS = qVAS + u \u03b8 k VAS , uGLU = qGLU + u \u03b8 h GLU , uHFL = qHFL + u \u03b8 h HFL .", "formula_coordinates": [5.0, 398.38, 284.55, 79.18, 43.7]}, {"formula_id": "formula_9", "formula_text": "R (w) = T t=1 r(st) \u2212 weJeffort.", "formula_coordinates": [6.0, 110.25, 250.4, 127.54, 27.05]}, {"formula_id": "formula_10", "formula_text": "E =\u0226 +\u1e40 +\u1e60 +\u1e86 ,", "formula_coordinates": [6.0, 129.61, 531.92, 88.82, 8.97]}, {"formula_id": "formula_11", "formula_text": "A = mass \u2022 fA(u) and\u1e40 = mass \u2022 g(l CE )fM (a),", "formula_coordinates": [6.0, 66.2, 652.9, 215.64, 10.59]}, {"formula_id": "formula_12", "formula_text": "S = 0.25F MTU {\u2212v CE }+.", "formula_coordinates": [6.0, 391.12, 95.67, 93.71, 10.59]}, {"formula_id": "formula_13", "formula_text": "W = F CE {\u2212v CE }+.", "formula_coordinates": [6.0, 400.21, 144.54, 75.53, 10.58]}, {"formula_id": "formula_14", "formula_text": "JM =\u1e02 + 1 T T t=1 m\u2208M\u0116 m,t,", "formula_coordinates": [6.0, 381.65, 242.79, 112.64, 27.2]}, {"formula_id": "formula_15", "formula_text": "JR = 1 T T t=1 j\u2208Qr \u03c4 2 j,t ,", "formula_coordinates": [6.0, 395.96, 347.91, 84.04, 27.21]}, {"formula_id": "formula_16", "formula_text": "JM = 1 T T t=1 j\u2208Qs \u03c4 2 j,t ,", "formula_coordinates": [8.0, 122.1, 594.02, 103.83, 12.8]}, {"formula_id": "formula_17", "formula_text": "JM = 1 T T t=1 m\u2208M a 2 m,t ,", "formula_coordinates": [8.0, 382.99, 269.03, 109.98, 12.8]}], "doi": ""}