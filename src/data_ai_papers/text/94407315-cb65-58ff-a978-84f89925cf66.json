{"title": "Recovering from Selection Bias in Causal and Statistical Inference", "authors": "Elias Bareinboim; Jin Tian; Judea Pearl", "pub_date": "", "abstract": "Selection bias is caused by preferential exclusion of units from the samples and represents a major obstacle to valid causal and statistical inferences; it cannot be removed by randomized experiments and can rarely be detected in either experimental or observational studies. In this paper, we provide complete graphical and algorithmic conditions for recovering conditional probabilities from selection biased data. We also provide graphical conditions for recoverability when unbiased data is available over a subset of the variables. Finally, we provide a graphical condition that generalizes the backdoor criterion and serves to recover causal effects when the data is collected under preferential selection.", "sections": [{"heading": "Introduction", "text": "Selection bias is induced by preferential selection of units for data analysis, usually governed by unknown factors including treatment, outcome, and their consequences, and represents a major obstacle to valid causal and statistical inferences. It cannot be removed by randomized experiments and can rarely be detected in either experimental or observational studies. 1 For instance, in a typical study of the effect of training program on earnings, subjects achieving higher incomes tend to report their earnings more frequently than those who earn less. The data-gathering process in this case will reflect this distortion in the sample proportions and, since the sample is no longer a faithful representation of the population, biased estimates will be produced regardless of how many samples were collected.\nThis preferential selection challenges the validity of inferences in several tasks in AI (Cooper 1995;Elkan 2001;Zadrozny 2004;Cortes et al. 2008) and Statistics (Whittemore 1978; Little and Rubin 1986;Jewell 1991;Kuroki and Cai 2006) as well as in the empirical sciences (e.g., Genetics (Pirinen, Donnelly, and Spencer 2012;Mefford and Witte 2012), Economics (Heckman 1979;Angrist 1997), and Epidemiology (Robins 2001;Glymour and Greenland 2008)).\nTo illuminate the nature of preferential selection, consider\nCopyright c 2014, Association for the Advancement of Artificial Intelligence (www.aaai.org). All rights reserved. 1 Remarkably, there are special situations in which selection bias can be detected even from observations, as in the form of a non-chordal undirected component (Zhang 2008).\nthe data-generating model in Fig. 1(a) in which X represents an action, Y represents an outcome, and S represents a binary indicator of entry into the data pool (S = 1 means that the unit is in the sample, S = 0 otherwise). If our goal is to compute the population-level conditional distribution P (y|x), and the samples available are collected under selection, only P (y, x|S = 1) is accessible for use. 2 Given that in principle these two distributions are just loosely connected, the natural question to ask is under what conditions P (y|x) can be recovered from data coming from P (y, x|S = 1). In this specific example, both action and outcome affect the entry in the data pool, which will be shown not to be recoverable (see Corollary 1) -i.e., there is no method capable of unbiasedly estimating the population-level distribution using data gathered under this selection process.\nThe bias arising from selection differs fundamentally from the one due to confounding, though both constitute threats to the validity of causal inferences. The former bias is due to treatment or outcome (or ancestors) affecting the inclusion of the subject in the sample (Fig. 1(a)), while the latter is the result of treatment X and outcome Y being affected by a common omitted variables U (Fig. 1(b)). In both cases, we have unblocked extraneous \"flow\" of information between treatment and outcome, which appear under the rubric of \"spurious correlation,\" since it is not what we seek to estimate.\nIt is instructive to understand selection graphically, as in Fig. 1(a). The preferential selection that is encoded through conditioning on S creates spurious association between X and Y through two mechanisms. First, given that S is a collider, conditioning on it induces spurious association between its parents, X and Y (Pearl 1988). Second, S is also a descendant of a \"virtual collider\" Y , whose parents are X and the error term U Y (also called \"hidden variable\") which is always present, though often not shown in the diagram. 3 ", "publication_ref": ["b6", "b10", "b31", "b8", "b19", "b16", "b18", "b24", "b14", "b1", "b25", "b12", "b32", "b20"], "figure_ref": ["fig_0", "fig_0", "fig_0", "fig_0"], "table_ref": []}, {"heading": "Related work and Our contributions", "text": "There are three sets of assumptions that are enlightening to acknowledge if we want to understand the procedures avail-able in the literature for treating selection bias -qualitative assumptions about the selection mechanism, parametric assumptions regarding the data-generating model, and quantitative assumptions about the selection process.\nIn the data-generating model in Fig. 1(c), the selection of units to the sample is treatment-dependent, which means that it is caused by X, but not Y . This case has been studied in the literature and Q = P (y|x) is known to be non-parametrically recoverable from selection (Greenland and Pearl 2011). Alternatively, in the data-generating model in Fig. 1(d), the selection is caused by Y (outcomedependent), and Q is not recoverable from selection (formally shown later on), but is the odds ratio 4 (Cornfield 1951;Whittemore 1978;Geng 1992;Didelez, Kreiner, and Keiding 2010). As mentioned earlier, Q is also not recoverable in the graph in Fig. 1(a). By and large, the literature is concerned with treatment-dependent or outcome-dependent selection, but selection might be caused by multiple reasons and embedded in more intricate realities. For instance, a driver of the treatment Z (e.g., age, sex, socio-economic status) may also be causing selection, see Fig. 1(e,f). As it turns out, Q is recoverable in Fig 1(e) but not in (f), so different qualitative assumptions need to be modelled explicitly since each topology entails a different answer for recoverability.\nThe second assumption is related to the parametric form used by recoverability procedures. For instance, one variation of the selection problem was studied in Econometrics, and led to the celebrated method developed by James Heckman (Heckman 1979). His two-step procedure removes the bias by leveraging the assumptions of linearity and normality of the data-generating model. A graph-based parametric analysis of selection bias is given in (Pearl 2013).\nThe final assumption is about the probability of being selected into the sample. In many settings in Machine learning and Statistics (Elkan 2001;Zadrozny 2004;Smith and Elkan 2007;Storkey 2009;Hein 2009;Cortes et al. 2008), it is assumed that this probability, P (S = 1|P a s ), can be modelled explicitly, which often is an unattainable requirement for the practitioner (e.g., it might be infeasible to assess the differential rates of how salaries are reported).\nOur treatment differs fundamentally from the current literature regarding these assumptions. First, we do not constrain the type of data-generating model as outcome-or treatment-dependent, but we take arbitrary models (including these two) as input, in which a node S indicates selection for sampling. Second, we do not make parametric assumptions (e.g. linearity, normality, monotonicity) but operate non-parametrically based on causal graphical models (Pearl 2000), which is more robust, less prone to model misspecifications. Third, we do not rely on having the selection's probability P (S = 1|P a s ), which is not always available in practice. Our work hinges on exploiting the qualitative knowledge encoded in the data-generating model for yielding recoverability. This knowledge is admittedly a demanding requirement for the scientist, but we now under- stand formally its necessity for any approach to recoverability -any procedure aiming for recoverability, implicitly or explicitly, relies on this knowledge (Pearl 2000). 5 The analysis of selection bias requires a formal language within which the notion of data-generating model is given precise characterization, and the qualitative assumptions regarding how the variables affect selection can be encoded explicitly. The advent of causal diagrams (Pearl 1995;Spirtes, Glymour, and Scheines 2000;Pearl 2000;Koller and Friedman 2009) provides such a language and renders the formalization of the selection problem possible.\nUsing this language, (Bareinboim and Pearl 2012) provided a complete treatment for selection relative to the OR 4 . We generalize their treatment considering the estimability of conditional distributions and address three problems:\n1. Selection without external data: The dataset is collected under selection bias, P (v|S = 1); under which conditions is P (y|x) recoverable? 2. Selection with external data: The dataset is collected under selection bias, P (v|S = 1), but there are unbiased samples from P (t), for T \u2286 V; under which conditions is P (y|x) recoverable? 3. Selection in causal inferences: The data is collected under selection bias, P (v|S = 1), but there are unbiased samples from P (t), for T \u2286 V; under which conditions is the interventional distribution P (y|do(x)) estimable?\nWe provide graphical and algorithmic conditions for these problems without resorting to parametric assumptions nor selection probabilities. Furthermore, the solution for selection without external data is complete, in the sense that whenever a quantity is said not to be recoverable by our conditions, there exists no procedure that are able to recover it (without adding assumptions). In estimating the effects of interventions, we generalize the backdoor criterion for when data is collected under selection.", "publication_ref": ["b13", "b7", "b30", "b11", "b9", "b14", "b23", "b10", "b31", "b26", "b15", "b8", "b23", "b23", "b22", "b27", "b23", "b17", "b2"], "figure_ref": ["fig_0", "fig_0", "fig_0", "fig_0"], "table_ref": []}, {"heading": "Recoverability without External Data", "text": "We first introduce the formal notion of recoverability for conditional distributions when data is under selection. 6 Definition 1 (s-Recoverability). Given a causal graph G s augmented with a node S encoding the selection mechanism (Bareinboim and Pearl 2012), the distribution Q = P (y | x) is said to be s-recoverable from selection biased data in G s if the assumptions embedded in the causal model renders Q expressible in terms of the distribution under selection bias P (v | S = 1). Formally, for every two probability distributions P 1 and P 2 compatible with G s ,\nP 1 (v | S = 1) = P 2 (v | S = 1) > 0 implies P 1 (y | x) = P 2 (y | x). 7\nConsider the graph G s in Fig. 1(c) and assume that our goal is to establish s-recoverability of Q = P (y|x). Note that by d-separation (Pearl 1988), X separates Y from S, (or (Y \u22a5 \u22a5 S|X)), so we can write P (y|x) = P (y|x, S = 1). This is a very special situation since these two distributions can be arbitrarily distant from each other, but in this specific case G s constrains Q in such a way that despite the fact that data was collected under selection and our goal is to answer a query about the overall population, there is no need to resort to additional data external to the biased study. Now we want to establish whether Q is s-recoverable in the graph G s in Fig. 1(d). In this case, S is not d-separated from Y if we condition on X, so (S \u22a5 \u22a5 Y |X) does not hold in at least one distribution compatible with G s , and the identity P (y|x) = P (y|x, S = 1) is not true in general. One may wonder if there is another way to s-recover Q in G s , but this is not the case as formally shown next. That is, the assumptions encoded in G s imply a universal impossibility; no matter how many samples of P (x, y|S = 1) are accumulated or how sophisticated the estimation technique is, the estimator of P (y|x) will never converge to its true value. Lemma 1. P (y|x) is not s-recoverable in Fig. 1(d).\nProof. We construct two causal models such that P 1 is compatible with the graph G s in Fig. 1(d) and P 2 with the subgraph G 2 = G s \\ {Y \u2192 S}. We will set the parameters of P 1 through its factors and then computing the parameters of P 2 by enforcing P 2 (V | S = 1) = P 1 (V | S = 1). Since P 2 (V|S = 1) = P 2 (V), we will be enforcing P 1 (V|S = 1) = P 2 (V). Recoverability should hold for any parametrization, so we assume that all variables are binary. Given a Markovian causal model (Pearl 2000), P 1 can be parametrized through its factors in the decomposition over observables, P 1 (X), P 1 (Y |X), P 1 (S = 1|Y ), for all X, Y .\nWe can write the conditional distribution in the second causal model as follows:\nP 2 (y|x) = P 1 (y|x, S = 1) = P 1 (y, x, S = 1) P 1 (x, S = 1)(1)\n6 This definition generalizes G-admissibility given in (Bareinboim and Pearl 2012). 7 We follow the conventions given in (Pearl 2000). We use typical graph notation with families (e.g., children, parents, ancestors). We denote variables by capital letters and their realized values by small letters. We use bold to denote sets of variables. We denote the set of all variables by V, except for the selection mechanism S.", "publication_ref": ["b2", "b20", "b23", "b23"], "figure_ref": ["fig_0", "fig_0", "fig_0", "fig_0"], "table_ref": []}, {"heading": "=", "text": "P 1 (S = 1|y)P 1 (y|x) P 1 (S = 1|y)P 1 (y|x) + P 1 (S = 1|y)P 1 (y|x) ,\nwhere the first equality, by construction, should be enforced, and the second and third by probability axioms. The other parameters of P 2 are free and can be chosen to match P 1 . Finally, set the distribution of every family in P 1 but selection variable equal to 1/2, and set the distribution P 1 (S = 1|y) = \u03b1, P 1 (S = 1|y) = \u03b2, for 0 < \u03b1, \u03b2 < 1 and \u03b1 = \u03b2. This parametrization reduces eq. (2) to P 2 (y|x) = \u03b1/(\u03b1+\u03b2) and P 1 (y|x) = 1/2, the result follows.\nCorollary 1. P (y|x) is not s-recoverable in Fig. 1(a).\nThe corollary follows immediately noting that lack of s-recoverability with a subgraph (Fig. 1(d)) precludes srecoverability with the graph itself since the extra edge can be inactive in a compatible parametrization (Pearl 1988) (the converse is obviously not true). Lemma 1 is significant because Fig. 1(d) can represent a study design that is typically used in empirical fields known as case-control studies. The result is also theoretically instructive since Fig. 1(d) represents the smallest graph structure that is not s-recoverable, and its proof will set the tone for more general and arbitrary structures that we will be interested in (see Theorem 1).\nFurthermore, consider the graph in Fig. 1(e) in which the independence (S \u22a5 \u22a5 Y |X) holds, so we can also recover Q from selection (P (y|x, S = 1) = P (y|x)). However, (S \u22a5 \u22a5 Y |X) does not hold in Fig. 1(f) -there is an open path passing through X's ancestor\nW (i.e. S \u2190 Z \u2192 X \u2190 W \u2192 Y )\n-and the natural question that arises is whether Q is recoverable in this case. It does not look obvious whether the absence of an independence precludes s-recoverability since there are other possible operators in probability theory that could be used leading to the s-recoverability of Q. To illustrate this point, note that it is not the case in causal inference that the inapplicability of the backdoor criterion (Pearl 2000, Ch. 3), which is also an independence constraint, implies the impossibility of recovering certain effects.\nRemarkably, the next result states that the lack of this independence indeed precludes s-recoverability, i.e., the probe of one separation test in the graph is sufficient to evaluate whether a distribution is or is not s-recoverable. Theorem 1. The distribution P (y|x) is s-recoverable from G s if and only if (S \u22a5 \u22a5 Y |X). 8 In words, Theorem 1 provides a powerful test for srecoverability without external data, which means that when it disavows s-recoverability, there exists no procedure that would be capable of recovering the distribution from selection bias (without adding assumptions). Its sufficiency part is immediate, but the proof of necessity is somewhat involved since we need to show that for all graphical structures in which the given d-separation test fails, each of these structures does not allow for s-recoverability (i.e., a counterexample can always be produced showing agreement on P (v|S = 1) and disagreement on P (y|x)).\nThe next corollary provides a test for s-recoverability of broader joint distributions (including Y alone):\nCorollary 2. Let Z = An(S) \\ An(Y ) including S, and A = P a(Z)\u2229(An(Y )\\{Y }). P (Y, An(Y )\\(A\\{Y })|A) is s-recoverable if and only if Y is not an ancestor of S.\nThis result can be embedded as a step reduction in an algorithm to s-recover a collection of distributions in the form of the corollary. We show such algorithm in (Bareinboim, Tian, and Pearl 2014) 9 . The main idea is to traverse the graph in a certain order s-recovering all joint distributions with the form given in the corollary (updating S along the way). If the algorithm exits with failure, it means that the distributions of its predecessors are not s-recoverable.", "publication_ref": ["b20", "b5"], "figure_ref": ["fig_0", "fig_0", "fig_0", "fig_0", "fig_0", "fig_0"], "table_ref": []}, {"heading": "Recoverability with External Data", "text": "A natural question that arises is whether additional measurements in the population level over certain variables can help recovering a given distribution. For example, P (age) can be estimated from census data which is not under selection bias.\nTo illustrate how this problem may arise in practice, consider Fig. 2 and assume that our goal is to s-recover Q = P (y|x). It follows immediately from Thm. 1 that Q cannot be s-recovered without additional assumptions. Note, however, that the parents of the selection node Pa s = {W 1 , W 2 } separates S from all other nodes in the graph, which indicates that it would be sufficient for recoverability to measure T = {W 1 , W 2 } \u222a {X} from external sources. To witness, note that after conditioning Q on W 1 and W 2 , we obtain: where the last equality follows from (Y \u22a5 \u22a5 S | X, W 1 , W 2 ). That is, Q can be s-recovered and is a combination of two different types of data; the first factor comes from biased data under selection, and the second factor is available from external data collected over the whole population.\nP (y|x) = w 1 ,w 2 P (y|x,\nOur goal is to understand the interplay between measurements taken over two types of variables, M, T \u2286 V , where M are variables collected under selection bias, P (M|S = 1), and T are variables collected in the population-level, P (T). In other words, we want to understand when (and how) can this new piece of evidence P (T) together with the data under selection (P (M|S = 1)) help in extending the treatment of the previous section for recovering the true underlying distribution Q = P (y|x). 10 Formally, we need to redefine s-recoverability for accommodating the availability of data from external sources. Definition 2 (s-Recoverability). Given a causal graph G s augmented with a node S, the distribution Q = P (y | x)\nFigure 2: Causal model in which Q = P (y|x) is not recoverable without external data (Thm. 1), but it is recoverable if measurements on the set Pa s = {W 1 , W 2 } are taken (Thm. 2). Alternatively, even if not all parents of S are measured, any set including {W 2 , Z 3 } would yield recoverability of Q.\nis said to be s-recoverable from selection bias in G s with external information over T \u2286 V and selection biased data over M \u2286 V (for short, s-recoverable) if the assumptions embedded in the causal model render Q expressible in terms of P (m | S = 1) and P (t), both positive. Formally, for every two probability distributions P 1 and P 2 compatible with G s , if they agree on the available distributions, P 1 (m | S = 1) = P 2 (m | S = 1) > 0, P 1 (t) = P 2 (t) > 0, they must agree on the query distribution, P 1 (y\n| x) = P 2 (y | x).\nThe observation leading to eq. (3) provides a simple condition for s-recoverability when we can choose the variables to be collected. Let Pa s be the parent set of S. If measurements on the set T = Pa s \u222a {X} can be taken without selection, we can write P (y|x) = pas P (y|x, pa s , S = 1)P (pa s |x), since S is separated from all nodes in the graph given its parent set. This implies s-recoverability where we have a mixture in which the first factor is obtainable from the biased data and the second from external sources.\nThis solution is predicated on the assumption that Pa s can be measured in the overall population, which can be a strong requirement, and begs a generalization to when part of Pa s is not measured. For instance, what if in Fig. 2 W 1 cannot be measured? Would other measurements over a different set of variables also entail s-recoverability?\nThis can be expressed as a requirement that subsets of T and M can be found satisfying the following criterion: Theorem 2. If there is a set C that is measured in the biased study with {X, Y } and in the population level with X such that (Y \u22a5 \u22a5 S|{C, X}), then P (y|x) is s-recoverable as P (y|x) = c P (y|x, c, S = 1)P (c|x).\n(4)\nIn the example in Fig. 2, it is trivial to confirm that any (pre-treatment) set C containing W 2 and Z 3 would satisfy the conditions of the theorem. In particular, {W 2 , Z 3 } is such a set, and it allows us to s-recover Q without measuring W 1 (W 1 \u2208 Pa s ) through eq. (4). Note, however, that the set C = {W 2 , Z 1 , Z 2 } is not sufficient for s-recoverability. It fails to satisfy the separability condition of the theorem since conditioning on {X, W 2 , Z 1 , Z 2 } leaves an unblocked path between S and Y (i.e., S \u2190 W\n1 \u2192 T 1 \u2192 X \u2190 Z 3 \u2192 Y ).\nIt can be computationally difficult to find a set satisfying the conditions of the theorem since this could imply a search over a potentially exponential number of subsets. Remarkably, the next result shows that the existence of such a set can be determined by a single d-separation test. Theorem 3. There exists some set C \u2286 T \u2229 M such that Y \u22a5 \u22a5 S|{C, X} if and only if the set (C \u222aX) d-separates S from Y where C = [(T\u2229M)\u2229An(Y \u222aS\u222aX)]\\(Y \u222aS\u222aX).\nIn practice, we can restrict ourselves to minimal separators, that is, looking only for minimal set C \u2286 T \u2229 M such that (Y \u22a5 \u22a5 S|{C, X}). The algorithm for finding minimal separators has been given in (Acid and de Campos 1996;Tian, Paz, and Pearl 1998).\nDespite the computational advantages given by Thm. 3, Thm. 2 still requires the existence of a separator C measured in both the biased study (M) and in the overall population (T), and it is natural to ask whether this condition can be relaxed. Assume that all we have is a separator C \u2286 M, but C (or some of its elements) is not measured in population T, and therefore P (c|x) in eq. ( 4) still needs to be s-recovered. We could s-recover P (c|x) in the spirit of Thm. 2 as\nP (c|x) = c1 P (c|x, c 1 , S = 1)P (c 1 |x),(5)\nif there exists a set C 1 \u2286 M\u2229T such that (S \u22a5 \u22a5 C|X, C 1 ). Now if this fails in that we can only find a separator C 1 \u2286 M not measured in T, we can then attempt to recover P (c 1 |x) in the spirit of Thm. 2 by looking for another separator C 2 , and so on. At this point, it appears that Thm. 2 can be extended. We further extend this idea by considering other possible probabilistic manipulations and embed them in a recursive procedure. For W, Z \u2286 M, consider the problem of recovering P (w|z) from P (t) and P (m|S = 1), and define procedure RC(w, z) as follows:\n1. If W \u222a Z \u2286 T, then P (w|z) is s-recoverable. 2. If (S \u22a5 \u22a5 W|Z), then P (w | z) is s-recoverable as P (w | z) = P (w | z, S = 1). 3. For minimal C \u2286 M such that (S \u22a5 \u22a5 W|(Z \u222a C)), P (w|z) = c P (w|z, c, S = 1)P (c|z). If C \u222a Z \u2286 T, then P (w|z) is s-recoverable.\nOtherwise, call RC(c, z). 4. For some W \u2282 W, P (w|z) = P (w |w \\ w , z)P (w \\ w |z). Call RC(w , {w \\ w } \u222a z) and RC(w \\ w , z)).\n5. Exit with FAIL (to s-recover P (w|z)) if for a singleton W, none of the above operations are applicable. Now, we define recoverability based on this procedure: Definition 3. We say that P (w|z) is C-recoverable if and only if it is recovered by the procedure RC(w, z).\nRemarkably, the manipulations considered in RC() are not actually more powerful than Thm. 2, as shown next. Theorem 4. For X \u2286 T, Y / \u2208 T, Q = P (y|x) is Crecoverable if and only if it is recoverable by Theorem 2, that is, if and only if there exists a set C \u2286 T\u2229M such that (Y \u22a5 \u22a5 S|{C, X}) (where C could be empty). If s-recoverable, P (y|x) is given by P (y|x) = c P (y|x, c, S = 1)P (c|x).\nThis result suggests that the constraint between measurement sets cannot be relaxed through ordinary decomposition and Thm. 2 captures the bulk of s-recoverable relations. (See proof in (Bareinboim, Tian, and Pearl 2014).) Importantly, this does not constitute a proof of necessity of Thm. 2. Now we turn our attention to some special cases that appear in practice. Note that, so far, we assumed X being measured in the overall population, but in some scenarios Y 's prevalence might be available instead. So, assume Y \u2208 T but some variables in X are not measured in the populationlevel. Let X 0 = X \u2229 T and X m = X \\ X 0 , we have\nP (y|x) = P (x m |y, x 0 )p(y|x 0 ) y P (x m |y, x 0 )p(y|x 0 ) (6)\nTherefore, P (y|x) is recoverable if P (x m |y, x 0 ) is recoverable. We could use the previous results to recover P (x m |y, x 0 ). In particular, Theorems 2 and 3 lead to: \nCorollary 3. P (y|x) is recoverable if there exists a set C \u2286 T \u2229 M (C could be empty) such that (X m \u22a5 \u22a5 S|{C \u222a Y \u222a X 0 }).\n(C \u222a Y \u222a X 0 ) d-separates S from X m where C = [(T \u2229 M) \u2229 An(Y \u222a S \u222a X)] \\ (Y \u222a S \u222a X).\nFor example, in Fig. 2, assuming M = {X, Y, W 1 , W 3 , Z 3 } and T = {Y, W 1 , W 3 , Z 3 }, we have S \u22a5 \u22a5 X|{Y, W 1 , W 3 , Z 3 }, therefore we can s-recover P (x|y) = w 1 ,w 3 ,z 3 P (x|y, w1, w3, z3, S = 1)P (w1, w3, z3|y),\nas well as P (y|x) by substituting back eq. (8) in eq. ( 6). Furthermore, it is worth examining when no data is gathered over X or Y in the population level. In this case, P (y|x) may be recoverable through P (x, y), as shown in the sequel.\nCorollary 5. P (y|x) is recoverable if there exists a set C \u2286 T\u2229M such that ({Y }\u222aX \u22a5 \u22a5 S|C). If recoverable, P (y, x) is given by P (y, x) = c P (y, x|c, S = 1)P (c).\nFor instance, P (x, y) is s-recoverable in Fig. 2 \nif T \u2229 M contains {W 2 , T 1 , Z 3 } or {W 2 , T 1 , Z 1 } (without {X, Y }) .", "publication_ref": ["b0", "b29", "b5"], "figure_ref": [], "table_ref": []}, {"heading": "Recoverability of Causal Effects", "text": "We now turn our attention to the problem of estimating causal effects from selection biased data. 11 Our goal is to recover the effect of X on Y , P (y|do(x)) given the structure of G s . Consider the graph G s in Fig. 3(a), in which X and Y are not confounded, hence, P (y|do(x)) = P (y|x) and, based on Theorem 1, we conclude that P (y|do(x)) is not recoverable in G s . Fig. 3(b) and 3(c), on the other hand, contains covariates W 1 and W 2 that may satisfy conditions similar to those in Theorem 1 that would render P (y|do(x)) recoverable. These conditions, however, need to be strengthened significantly, to account for possible confounding between X and Y which, even in the absence of selection bias, might require adjustment for admissible covariates, namely, covariates that satisfy the backdoor condition (Pearl 1993). For example, {W 2 } satisfies the backdoor condition in both Fig. 3(b) and (c), while {W 1 } satisfies this condition in (b) but not in (c).\nDefinition 4 below extends the backdoor condition to selection bias problems by identifying a set of covariates Z that accomplishes two functions. Conditions (i) and (ii) assure us that Z is backdoor admissible (Pearl and Paz 2013) 12 , while conditions (iii) and (iv) act to separate S from Y , so as to permit recoverability from selection bias. Definition 4 (Selection-backdoor criterion). Let a set Z of variables be partitioned into Z + \u222aZ \u2212 such that Z + contains all non-descendants of X and Z \u2212 the descendants of X. Z is said to satisfy the selection backdoor criterion (s-backdoor, for short) relative to an ordered pairs of variables (X, Y ) and an ordered pair of sets (M, T) in a graph G s if Z + and Z \u2212 satisfy the following conditions:\n(i) Z + blocks all back door paths from X to Y ; (ii) X and Z + block all paths between Z \u2212 and Y , namely, (Z \u2212 \u22a5 \u22a5 Y |X, Z + ); (iii) X and Z block all paths between S and Y , namely,\n(Y \u22a5 \u22a5 S|X, Z); (iv) Z \u222a {X, Y } \u2286 M, and Z \u2286 T.\nConsider Fig. 3(a) where Z \u2212 = {W }, Z + = {} and Z \u2212 is not separated from Y given {X}\u222aZ + in G s , which means that condition (ii) of the s-backdoor is violated. So, despite the fact that the relationship between X and Y is unconfounded and (Y \u22a5 \u22a5 S|{W, X}), it is improper to adjust for {W } when computing the target effect.\nFor the admissible cases, we are ready to state a sufficient condition that guarantees proper identifiability and recoverability of causal effects under selection bias: Theorem 5 (Selection-backdoor adjustment). If a set Z satisfies the s-backdoor criterion relative to the pairs (X, Y ) and (M, T) (as given in def. 2), then the effect of X on Y is identifiable and s-recoverable and is given by the formula P (y|do(x)) = z P (y|x, z, S = 1)P (z)\nInterestingly, X does not need to be measured in the overall population when the s-backdoor adjustment is applicable, which contrasts with the expression given in Theorem 2 where both X and Z (equivalently C) are needed.\nConsider Fig. 3(b) and assume our goal is to establish Q = P (y|do(x)) when external data over {W 2 } is available in both studies. Then, Z = {W 2 } is s-backdoor admissible and the s-backdoor adjustment is applicable in this case. However, if T = {W 1 }, Z = {W 1 } is backdoor admissible, but it is not s-backdoor admissible since condition (iii) is violated (i.e., (S \u22a5 \u22a5 Y |{W 1 , X}) does not hold in G s ). This is interesting since the two sets {W 1 } and {W 2 } are c-equivalent (Pearl and Paz 2013), having the same potential for bias reduction in the general population. To understand why c-equivalence is not sufficient for s-recoverability, note that despite the equivalence for adjustment, w1 P (y|x, w 1 )P (w 1 ) = w2 P (y|x, w 2 )P (w 2 ), the r.h.s. is obtainable from the data, while the l.h.s. is not. Now we want to recover Q = P (y|do(x)) in Fig. 3(c) (U is a latent variable) with T = {W 2 }. Condition (iii) of the s-backdoor fails since (S \u22a5 \u22a5 Y |{X, W 2 }) does not hold. Alternatively, if we discard W 2 and consider the null set for adjustment (Z = {}), condition (i) fails since there is an open backdoor path from X to Y (X \u2190 W 2 \u2190 U \u2192 Y ). Despite the inapplicability of the s-backdoor, P (y|do(x)) is still s-recoverable since, using do-calculus, we can show that Q = P (y|do(x), S = 1), which reduces to w2 P (y|x, w 2 , S = 1)P (w 2 |S = 1), both factors srecoverable without the need for external information.\nThe reliance on the do-calculus in recovering causal effects is expected since even when selection bias is absent, there exist identifiability results beyond the backdoor. Still, this criterion, which is generalized by the s-backdoor criterion, is arguably the most used method for identifiability of causal effects currently available in the literature.", "publication_ref": ["b21", "b20"], "figure_ref": ["fig_3", "fig_3", "fig_3", "fig_3", "fig_3", "fig_3"], "table_ref": []}, {"heading": "Conclusions", "text": "We provide conditions for recoverability from selection bias in statistical and causal inferences applicable for arbitrary structures in non-parametric settings. Theorem 1 provides a complete characterization of recoverability when no external information is available. Theorem 2 provides a sufficient condition for recoverability based on external information; it is optimized by Theorem 3 and strengthened by Theorem 4. Verifying these conditions takes polynomial time and could be used to decide what measurements are needed for recoverability. Theorem 5 further gives a graphical condition for recovering causal effects, which generalizes the backdoor adjustment. Since selection bias is a common problem across many disciplines, the methods developed in this paper should help to understand, formalize, and alleviate this problem in a broad range of data-intensive applications. This paper complements another aspect of the generalization problem in which causal effects are transported among differing environments (Bareinboim and Pearl 2013a;2013b).", "publication_ref": ["b3", "b4"], "figure_ref": [], "table_ref": []}, {"heading": "Acknowledgments", "text": "The authors would like to thank the reviewers for their comments that help improve the manuscript. This research was supported in parts by grants from NSF #IIS-1249822 and #IIS-1302448, and ONR #N00014-13-1-0153 and #N00014-10-1-0933.", "publication_ref": [], "figure_ref": [], "table_ref": []}], "references": [{"ref_id": "b0", "title": "An algorithm for finding minimum d-separating sets in belief networks", "journal": "Morgan Kaufmann", "year": "1996", "authors": "S Acid; L De Campos"}, {"ref_id": "b1", "title": "Conditional independence in sample selection models", "journal": "Economics Letters", "year": "1997", "authors": "J D Angrist"}, {"ref_id": "b2", "title": "Controlling selection bias in causal inference", "journal": "JMLR", "year": "2012", "authors": "E Bareinboim; J Pearl"}, {"ref_id": "b3", "title": "Meta-transportability of causal effects: A formal approach", "journal": "", "year": "2013", "authors": "E Bareinboim; J Pearl"}, {"ref_id": "b4", "title": "Causal transportability with limited experiments", "journal": "", "year": "2013", "authors": "E Bareinboim; J Pearl"}, {"ref_id": "b5", "title": "Recovering from selection bias in causal and statistical inference", "journal": "", "year": "2014", "authors": "E Bareinboim; J Tian; J Pearl"}, {"ref_id": "b6", "title": "Causal discovery from data in the presence of selection bias", "journal": "Artificial Intelligence and Statistics", "year": "1995", "authors": "G Cooper"}, {"ref_id": "b7", "title": "A method of estimating comparative rates from clinical data; applications to cancer of the lung, breast, and cervix", "journal": "Journal of the National Cancer Institute", "year": "1951", "authors": "J Cornfield"}, {"ref_id": "b8", "title": "Sample selection bias correction theory", "journal": "Springer-Verlag", "year": "2008", "authors": "C Cortes; M Mohri; M Riley; A Rostamizadeh"}, {"ref_id": "b9", "title": "Graphical models for inference under outcome-dependent sampling", "journal": "Statistical Science", "year": "2010", "authors": "V Didelez; S Kreiner; N Keiding"}, {"ref_id": "b10", "title": "The foundations of cost-sensitive learning", "journal": "Morgan Kaufmann Publishers Inc", "year": "2001", "authors": "C Elkan"}, {"ref_id": "b11", "title": "Collapsibility of relative risk in contingency tables with a response variable", "journal": "Journal Royal Statistical Society", "year": "1992", "authors": "Z Geng"}, {"ref_id": "b12", "title": "Causal diagrams", "journal": "Lippincott Williams & Wilkins", "year": "2008", "authors": "M Glymour; S Greenland"}, {"ref_id": "b13", "title": "Adjustments and their consequences -collapsibility analysis using graphical models", "journal": "International Statistical Review", "year": "2011", "authors": "S Greenland; J Pearl"}, {"ref_id": "b14", "title": "Sample selection bias as a specification error", "journal": "Econometrica", "year": "1979", "authors": "J Heckman"}, {"ref_id": "b15", "title": "Binary classification under sample selection bias", "journal": "MIT Press", "year": "2009", "authors": "M Hein"}, {"ref_id": "b16", "title": "Some surprising results about covariate adjustment in logistic regression models", "journal": "International Statistical Review", "year": "1991", "authors": "N P Jewell"}, {"ref_id": "b17", "title": "Probabilistic Graphical Models: Principles and Techniques", "journal": "MIT Press", "year": "2009", "authors": "D Koller; N Friedman"}, {"ref_id": "b18", "title": "On recovering a population covariance matrix in the presence of selection bias", "journal": "Biometrika", "year": "2006", "authors": "M Kuroki; Z Cai"}, {"ref_id": "b19", "title": "Statistical Analysis with Missing Data", "journal": "PLoS Genet", "year": "1986", "authors": "R J A Little; D B Rubin"}, {"ref_id": "b20", "title": "Probabilistic Reasoning in Intelligent Systems", "journal": "Morgan Kaufmann", "year": "1988", "authors": "J Pearl; Paz ; A "}, {"ref_id": "b21", "title": "Aspects of graphical models connected with causality", "journal": "", "year": "1993", "authors": "J Pearl"}, {"ref_id": "b22", "title": "Causal diagrams for empirical research", "journal": "Biometrika", "year": "1995", "authors": "J Pearl"}, {"ref_id": "b23", "title": "Lindear models: A useful \"microscope\" for causal analysis", "journal": "Journal of Causal Inference", "year": "2000", "authors": "J Pearl"}, {"ref_id": "b24", "title": "Including known covariates can reduce power to detect genetic effects in case-control studies", "journal": "Nature Genetics", "year": "2012", "authors": "M Pirinen; P Donnelly; C Spencer"}, {"ref_id": "b25", "title": "Data, design, and background knowledge in etiologic inference", "journal": "Epidemiology", "year": "2001", "authors": "J Robins"}, {"ref_id": "b26", "title": "Making generative classifiers robust to selection bias", "journal": "ACM", "year": "2007", "authors": "A T Smith; C Elkan"}, {"ref_id": "b27", "title": "When training and test sets are different: characterising learning transfer", "journal": "MIT Press", "year": "2000", "authors": "P Spirtes; C Glymour; R Scheines"}, {"ref_id": "b28", "title": "Adjustment criteria in causal diagrams: An algorithmic perspective", "journal": "AUAI Press", "year": "2011", "authors": "J Textor; M Liskiewicz"}, {"ref_id": "b29", "title": "Finding minimal separating sets", "journal": "", "year": "1998", "authors": "J Tian; A Paz; J Pearl"}, {"ref_id": "b30", "title": "Collapsibility of multidimensional contingency tables", "journal": "Journal of the Royal Statistical Society, Series B", "year": "1978", "authors": "A Whittemore"}, {"ref_id": "b31", "title": "Learning and evaluating classifiers under sample selection bias", "journal": "ACM", "year": "2004", "authors": "B Zadrozny"}, {"ref_id": "b32", "title": "On the completeness of orientation rules for causal discovery in the presence of latent confounders and selection bias", "journal": "Artif. Intell", "year": "2008", "authors": "J Zhang"}], "figures": [{"figure_label": "1", "figure_type": "figure", "figure_id": "fig_0", "figure_caption": "Figure 1 :1Figure 1: (a,b) Simplest examples of selection and confounding bias, respectively. (c,d) Treatment-dependent and outcome-dependent studies under selection, Q = P (y|x) is recoverable in (c) but not in (d). (e,f) Treatment-dependent study where selection is also affected by driver of treatment Z (e.g., age); Q is recoverable in (e) but not in (f).", "figure_data": ""}, {"figure_label": "", "figure_type": "figure", "figure_id": "fig_1", "figure_caption": "w1, w2)P (w1, w2|x) = w 1 ,w 2 P (y|x, w1, w2, S = 1)P (w1, w2|x), (3)", "figure_data": ""}, {"figure_label": "", "figure_type": "figure", "figure_id": "fig_2", "figure_caption": "If recoverable, P (y|x) is given by Eq. (6) whereP (x m |y, x 0 ) = c P (x m |y, x 0 , c, S = 1)P (c|y, x 0 ) (7)Corollary 4. P (y|x) is recoverable via Corollary 3 if and only if the set", "figure_data": ""}, {"figure_label": "3", "figure_type": "figure", "figure_id": "fig_3", "figure_caption": "Figure 3 :3Figure 3: (a) Causal diagram in which(S \u22a5 \u22a5 Y |{X, W }) but P (y|do(x)) is not s-backdoor admissible. (b) P (y|do(x)) is s-recoverable through T = {W 2 } but not {W 1 }. (c) {W 2 }does not satisfy the s-backdoor criterion but P (y|do(x)) is still recoverable.", "figure_data": ""}], "formulas": [{"formula_id": "formula_0", "formula_text": "P 1 (v | S = 1) = P 2 (v | S = 1) > 0 implies P 1 (y | x) = P 2 (y | x). 7", "formula_coordinates": [3.0, 54.0, 174.29, 238.5, 20.61]}, {"formula_id": "formula_1", "formula_text": "P 2 (y|x) = P 1 (y|x, S = 1) = P 1 (y, x, S = 1) P 1 (x, S = 1)(1)", "formula_coordinates": [3.0, 70.13, 601.22, 222.37, 23.23]}, {"formula_id": "formula_3", "formula_text": "W (i.e. S \u2190 Z \u2192 X \u2190 W \u2192 Y )", "formula_coordinates": [3.0, 420.29, 354.99, 137.71, 8.96]}, {"formula_id": "formula_4", "formula_text": "P (y|x) = w 1 ,w 2 P (y|x,", "formula_coordinates": [4.0, 60.36, 350.57, 102.28, 18.6]}, {"formula_id": "formula_5", "formula_text": "| x) = P 2 (y | x).", "formula_coordinates": [4.0, 488.57, 355.32, 69.43, 9.68]}, {"formula_id": "formula_6", "formula_text": "1 \u2192 T 1 \u2192 X \u2190 Z 3 \u2192 Y ).", "formula_coordinates": [5.0, 178.29, 68.12, 110.86, 9.65]}, {"formula_id": "formula_7", "formula_text": "P (c|x) = c1 P (c|x, c 1 , S = 1)P (c 1 |x),(5)", "formula_coordinates": [5.0, 88.59, 325.97, 203.91, 19.64]}, {"formula_id": "formula_8", "formula_text": "1. If W \u222a Z \u2286 T, then P (w|z) is s-recoverable. 2. If (S \u22a5 \u22a5 W|Z), then P (w | z) is s-recoverable as P (w | z) = P (w | z, S = 1). 3. For minimal C \u2286 M such that (S \u22a5 \u22a5 W|(Z \u222a C)), P (w|z) = c P (w|z, c, S = 1)P (c|z). If C \u222a Z \u2286 T, then P (w|z) is s-recoverable.", "formula_coordinates": [5.0, 51.51, 478.51, 240.99, 71.5]}, {"formula_id": "formula_9", "formula_text": "P (y|x) = P (x m |y, x 0 )p(y|x 0 ) y P (x m |y, x 0 )p(y|x 0 ) (6)", "formula_coordinates": [5.0, 355.23, 209.3, 202.77, 26.32]}, {"formula_id": "formula_10", "formula_text": "Corollary 3. P (y|x) is recoverable if there exists a set C \u2286 T \u2229 M (C could be empty) such that (X m \u22a5 \u22a5 S|{C \u222a Y \u222a X 0 }).", "formula_coordinates": [5.0, 319.5, 279.85, 238.5, 30.72]}, {"formula_id": "formula_11", "formula_text": "(C \u222a Y \u222a X 0 ) d-separates S from X m where C = [(T \u2229 M) \u2229 An(Y \u222a S \u222a X)] \\ (Y \u222a S \u222a X).", "formula_coordinates": [5.0, 319.5, 351.88, 238.5, 21.29]}, {"formula_id": "formula_13", "formula_text": "if T \u2229 M contains {W 2 , T 1 , Z 3 } or {W 2 , T 1 , Z 1 } (without {X, Y }) .", "formula_coordinates": [5.0, 319.5, 528.29, 238.5, 20.64]}, {"formula_id": "formula_14", "formula_text": "(Y \u22a5 \u22a5 S|X, Z); (iv) Z \u222a {X, Y } \u2286 M, and Z \u2286 T.", "formula_coordinates": [6.0, 58.98, 342.02, 142.58, 21.62]}], "doi": ""}