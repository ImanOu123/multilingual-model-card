{"title": "Generalized Adjustment Under Confounding and Selection Biases", "authors": "Juan D Correa; Jin Tian; Elias Bareinboim", "pub_date": "2017-11", "abstract": "Selection and confounding biases are the two most common impediments to the applicability of causal inference methods in large-scale settings. We generalize the notion of backdoor adjustment to account for both biases and leverage external data that may be available without selection bias (e.g., data from census). We introduce the notion of adjustment pair and present complete graphical conditions for identifying causal effects by adjustment. We further design an algorithm for listing all admissible adjustment pairs in polynomial delay, which is useful for researchers interested in evaluating certain properties of some admissible pairs but not all (common properties include cost, variance, and feasibility to measure). Finally, we describe a statistical estimation procedure that can be performed once a set is known to be admissible, which entails different challenges in terms of finite samples.", "sections": [{"heading": "Introduction", "text": "A fundamental challenge pervasive throughout science is the study of cause and effect relationships from a combination of non-experimental observations and substantive knowledge about the phenomenon under investigation. Causal relations are deemed more interpretable and robust than their statistical counterparts. They are more amenable to extrapolation to new, unforeseen situations. Understanding the world and constructing explanations are almost invariably accomplished through the presentation of causal knowledge with a coherent articulation of a causal story (Pearl 2000;Spirtes, Glymour, and Scheines 2001;Bareinboim and Pearl 2016;Pearl, Glymour, and Jewell 2016).\nTwo of the most common obstacles to discovering causal relations appear in the form of two biases -confounding and selection. The first one may arise from the lack of control over the decision-making process and the selection of actions, possibly due to costs, ethical, or technical considerations. This implies that the data is collected under an observational regime, where the population follows its natural tendency. Our goal, however, is to predict how the population will react when it undergoes a change (intervention), following a new, compulsory decision protocol. For instance, one is usually not interested in estimating the correlation between smoking and cancer (natural), but to establish whether the incidence of cancer would decrease had smoking been banned in the corresponding population.\nThe problem of identifiability gives formal dressing to this issue (Pearl 2000, Ch. 3). Specifically, it is concerned with determining the effect of a treatment (X) on an outcome (Y ), denoted P (y|do(x)), based on the observational, non-experimental distribution P (v) (where V represents observable variables) and causal assumptions commonly represented as a directed acyclic graph. The difference between P (y|do(x)) and its probabilistic counterpart, P (y|x), is known as confounding bias (Bareinboim and Pearl 2016). For the graph in Fig. 1(a), the probability distribution P (y|x) includes variations due to the \"backdoor\" path X Z ! Y , while the distribution P (y|do(x)) describes a regime (Fig. 1(b)) where the incoming arrows towards X are cut and only causal influence remains. Confounding bias, in this case, appears in the form of extraneous variations of Y that are not legitimately explained by X, but are generated by a third variable, Z in this case.\nThe problem of confounding has been extensively studied in the literature. A systematic mathematical treatment was given in (Pearl 1995), which included the do-calculus. The do-calculus was shown complete for non-parametric identifiability (Tian and Pearl 2002;Huang and Valtorta 2006;Shpitser and Pearl 2006;Bareinboim and Pearl 2012a).\nDespite the generality of such results, in practice, the most common and pervasive method for controlling confounding bias is known as the backdoor-adjustment (Pearl 1995). The backdoor-adjustment formula dictates that the effect of X on Y can be computed by controlling for a set of covariates Z, i.e., averaging the conditional distribution of outcome Y given treatment X and Z, weighted by the marginal distribution of Z. Pearl provided a formal and graphical justification for under what conditions a set Z could make the adjustment formula valid (for a survey, see (Pearl 1995)).\nThe second bias, selection, may appear because of preferential exclusion of units from the sample. For instance, in a typical study of the effect of grades on college admission, subjects with higher achievement tend to report their scores more frequently than those who scored lower. In this case, the data-gathering process will reflect a distortion in the sample's proportions and, since the data is no longer a faithful representation of the underlying population, biased estimates will be produced regardless of the number of sam-ples collected (even if the treatment is controlled).\nThe problem of selection bias can also be modeled graphically. In Fig. 1(c), for example, S represents a binary indicator of entry into the data pool, such that S=1 if a unit is included in the sample and S=0 otherwise (Bareinboim and Pearl 2012b). In this case, the selection is affected by the treatment as represented by the arrow X ! S (e.g., people with higher grades have a higher chance of reporting their scores). Clearly, when the sampling process is completely random, S is independent of all variables in the analysis. When samples are collected preferentially, the causal effects not only need to be identified, but also recovered (Bareinboim and Pearl 2012b) from the distribution P (v|S=1) instead of P (v).\nSelection bias has been studied in a wide range of subjects and contexts, including different tasks in AI (Cooper 1995;Elkan 2001;Zadrozny 2004;Cortes et al. 2008), statistics (Whittemore 1978;Little and Rubin 1987;Robinson and Jewell 1991;Kuroki and Cai 2006;Evans and Didelez 2015), throughout the empirical sciences (e.g., genetics (Pirinen, Donnelly, and Spencer 2012;Mefford and Witte 2012), economics (Heckman 1979;Angrist 1997), and epidemiology (Robins 2001;Glymour and Greenland 2008)).\nThe backdoor-adjustment was not used to control for selection bias until recently. Bareinboim, Tian, and Pearl (2014) provided a sufficient condition, formally showing that adjustment could be used to control for both confounding and selection biases. Later on,  studied how externally available, unbiased data over the covariates could be leveraged to further the reach of this technique. For instance, the effect P (y|do(x)) for the model in Fig. 1(c) can be identified and recovered only if external data over Z, (i.e. P (z)) is available. In this case, the adjustment averages the biased conditional distribution of outcome Y given the treatment X (P (y|x, z, S=1)) weighted by the unbiased distribution of Z (P (z)).\nThere are still simple (but subtle) situations that remain unsolved by these previous results. To witness, consider the model in Fig. 1(d), where X represents whether a patient took or not a drug, Y indicates whether the patient recovered or not from the disease, Z 1 and Z 2 represent if the patient has a certain genetic condition and has severe headaches, respectively. The arrow from Z 2 to the selection mechanism (S) encodes the fact that patients with a headache are more likely to seek help in the hospital and, therefore, are more likely of being sampled.\nThe previous methods require one to collect unbiased (external) data on Z 1 , which may prove too costly. In fact, this would require performing a genetic test on a significant amount of patients, which is not routinely done in the hospital when the person reports a headache. Nevertheless, unbiased measurements of Z 2 may be obtained from test reports conducted over the whole population, given that headache is a pervasive side effect and vast amounts of demographic information are available about it. It will be shown later on that the adjustment technique can be extended to combine the partial unbiased data with biased data to produce an estimand of the causal effect in the overall population.\nThe goal of this paper is to explain the general principle\nX Y Z (a) X Y Z (b) X Y Z S (c) X Y Z 1 Z 2 S (d)\nFigure 1: (a, b) represent the pre-and post-interventional models where X, Y, Z are, respectively, the treatment, outcome, and set of confounders. (c) Setting where both selection and confounding biases are present. (d) Settings where confounding or selection can be controlled, but not both, unless external data on P (Z 1 ), P (Z 2 ) or both are available.\nthat licenses this extrapolation to take place. We will characterize the use of covariate adjustment for causal effect identification under selection bias for arbitrary causal graphs when a combination of biased and unbiased datasets are available. Specifically, the contributions of our paper are: 1. (Graphical Characterization) We introduce a generalized notion of adjustment formula to produce an estimand that combines biased and unbiased datasets. We then prove a necessary and sufficient graphical condition for the admissibility of a set of covariates for adjustment. 2. (Algorithmic Characterization) We construct a complete algorithm that efficiently finds all sets that are admissible for generalized adjustment. The algorithm runs with polynomial delay and is useful for identifying admissible sets with certain special properties (e.g., low measurement cost, higher statistical precision). 3. (Statistical Procedure) We demonstrate a general statistical procedure based on inverse probability weighting (IPW) to estimate the adjustment formula from data.\nAll proofs can be found in the sup. material (Correa, Tian, and Bareinboim 2017).", "publication_ref": ["b23", "b29", "b3", "b20", "b3", "b22", "b31", "b14", "b27", "b1", "b22", "b22", "b2", "b6", "b10", "b33", "b9", "b32", "b16", "b26", "b15", "b11", "b24", "b18", "b13", "b0", "b25", "b12", "b4", "b8"], "figure_ref": ["fig_4", "fig_4", "fig_4", "fig_4", "fig_4", "fig_4"], "table_ref": []}, {"heading": "Definitions and Related Work", "text": "The systematic analysis of confounding and selection biases requires a formal language where the characterization of the underlying data-generating model can be encoded explicitly.\nWe use the language of Structural Causal Models (SCM) (Pearl 2000, pp. 204-207). Formally, a SCM M is a 4-tuple hU, V, F, P (u)i, where U is a set of exogenous (latent) variables and V is a set of endogenous (measured) variables. F represents a collection of functions F = {f i } such that each endogenous variable V i 2 V is determined by a function f i 2 F , where f i is a mapping from the respective domain of\nU i [ PA i to V i , U i \u2713 U , PA i \u2713 V \\V i ,\nand the entire set F forms a mapping from U to V . The uncertainty is encoded through a probability distribution over the exogenous variables, P (u). Within the structural semantics, performing an action X = x is represented through the do-operator, do(X = x), which encodes the operation of replacing the original equation of X by the constant x and induces a submodel M\nx . For a detailed discussion on the properties of structural models, we refer readers to (Pearl 2000, Ch. 7).\nIn this paper, bold capital letters denote sets of variables, while bold lower-case letters stand for particular assignments to those variables. The family relationships in the graph are written as An(X), Pa(X), De(X), which stand for the set of ancestors, parents, and descendants, respectively, of a given variable X. Variables are assumed to be ancestors and descendants of themselves. The letter G is used to refer to the causal graph, G X the graph resulting from the removal of all incoming edges to X in G, and G X the graph resulting from removing all outgoing edges from X.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "Adjustment for Confounding Bias", "text": "We discuss in this section the notion of adjustment and how it is used to control for confounding bias. It also provides a basic survey of the most significant results in the literature.\nDefinition 1 (Adjustment (Pearl 2000)). Given a causal diagram G containing a set of variables V and pairwise disjoint sets X, Y, Z \u2713 V, the set Z is called covariate adjustment for estimating the causal effect of X on Y (or usually just adjustment), if for every distribution P (v) compatible with G it holds that\nP (y | do(x)) = X Z P (y | x, z)P (z).(1)\nFinding an adjustment set relative to X and Y enables the identification of the corresponding causal effect. Several criteria have been developed to determine whether a set Z is valid for adjustment. The most representative result for controlling for confounding bias by adjustment is known as the \"Backdoor criterion\" (Pearl 1993;2000), defined below: Definition 2 (Backdoor Criterion). A set of variables Z satisfies the Backdoor Criterion relative to a pair of variables (X, Y ) in a directed acyclic graph G if:\n(i) No node in Z is a descendant of X .\n(ii) Z blocks every path between X and Y that contains an arrow into X .\nIntuitively, the backdoor criterion identifies the sets that block the non-causal paths (paths with arrows incoming towards X) while leaving the causal paths undisturbed.\nIt was further noted that certain descendants of X could be included in the adjustment set without sacrificing its validity (Pearl and Paz 2010). When selection bias is not present, Shpitser, VanderWeele, and Robins (2010) further showed that adjustment is complete if the non-proper causal paths are blocked (while the proper ones are left undisturbed), namely: Definition 3 (Proper Causal Path). Let X and Y be sets of nodes. A causal path from a node in X to a node in Y is called proper if it does not intersect X except at the starting point. van der Zander, Liskiewicz, and Textor (2014) proposed an alternative complete formulation of adjustment called \"Constructive Backdoor\", which led to an efficient algorithmic treatment of the problem (without selection bias). This characterization follows a graph transformation that will prove useful in the context of selection bias: Definition 4 (Proper Backdoor Graph). Let G be a causal diagram, and X, Y be disjoint subsets of variables. The proper backdoor graph, denoted as G pbd XY , is obtained from G by removing the first edge of every proper causal path from X to Y.", "publication_ref": ["b23", "b21", "b23", "b19", "b28", "b31"], "figure_ref": [], "table_ref": []}, {"heading": "Adjustment for Confounding and Selection Bias", "text": "Formally, the task of estimating a probabilistic quantity from a selection-biased distribution is known as recovering from selection bias (Bareinboim, Tian, and Pearl 2014). From now on, we assume that the set V stands for all the observed variables measured under selection bias (not including the selection mechanism S). In this context, the input usually consists of a distribution collected under selection bias, P (v|S=1). The probability of selection P (s) is assumed to be unknown. The goal of the analysis is to determine the unbiased causal distribution P (y|do(x)). In practical applications, unbiased observations of a subset of the variables may be available for use (e.g., the age and gender distributions). We'll show this data can be leveraged to help the recoverability of causal effects by adjustment. We use T to denote the set of externally and unbiasedly measured variables, and consider P (t) as an input to the analysis. Bareinboim, Tian, and Pearl (2014) studied the use of adjustment for simultaneously controlling for both confounding and selection biases. In particular, they introduced the Selection-Backdoor criterion (called s-backdoor), which is a sufficient condition for recovering causal effects from a biased distribution P (v | S=1) and externally unbiased data P (t). Building on these results,  devised a set of complete conditions for when none of the covariates are measured (Def. 5) externally (Z \\ T = ;), and the case when all of them are (Def. 6) measured without selection bias (Z \u2713 T). Let X, Y, Z be disjoint sets of variables and G a causal diagram augmented with a variable S, then the criteria are shown next:\nDefinition 5 (Generalized Adjustment Criterion Type 1 (GACT1)). Z satisfies the criterion w.r.t. X,Y in G if:\n(a) No element of Z is a descendant in G X of any W / 2 X which lies on a proper causal path from X to Y. (b) All non-causal paths between X and Y in G are blocked by Z and S.\n(c) Y is d-separated from S given X under the intervention do(x), i.e., (Y ? ? S | X) G X . (d) Every X 2 X is either a non-ancestor of S or it is in- dependent of Y in G X , i.e., 8 X2X\\An(S) (X ? ? Y) G X\nDefinition 6 (Generalized Adjustment Criterion Type 2 (GACT2)). Z satisfies the criterion w.r.t. X,Y in G if:\n(a) No element of Z is a descendant in G X of any W / 2 X which lies on a proper causal path from X to Y. (b) All non-causal paths between X and Y in G are blocked by Z. (c) Y is d-separated from the selection mechanism S given Z and X, i.e., (Y ? ? S | X, Z).\nIt was shown that a set Z satisfies the criterion in Def. 5 if and only if:\nP (y | do(x)) = X Z P (y | x, z, S=1)P (z | S=1), (2)\nand Z satisfies the criterion in Def. 6 if and only if:\nP (y | do(x)) = X Z P (y | x, z, S=1)P (z).\n(3)", "publication_ref": ["b4", "b4"], "figure_ref": [], "table_ref": []}, {"heading": "Generalized Adjustment with Partial External Data", "text": "The criteria discussed above (Defs. 5 and 6) are complete to decide whether an adjustment set Z is valid to identify the effect P (y|do(x)) from the inputs {P (v | S=1)} and {P (v | S=1), P (t); with T \u25c6 Z}, respectively. We note that these tasks represent two extremes over the spectrum of how much unbiased data may be available for the researcher -the former assume that no external data is available, while the latter that all covariates are externally available.\nA natural question to ask is whether it is possible to find valid adjustment sets within this spectrum, that is, to perform adjustment when only a subset Z T of the covariates Z require external measurements (i.e., Z T \u2713 Z \\ T).\nThe possibility of using different subsets of covariates for adjustment has practical implications in the design of the study and the feasibility of estimating causal effects by adjustment. To witness, consider the causal diagram in Fig. 1(d), and note that there is no set Z satisfying Def. 5, and that sets Z={Z 1 } and Z={Z 1 ,Z 2 } are valid for adjustment with respect to Def. 6, if the distribution P (z) is available in addition to P (x, y, z 1 , z 2 |S=1). As discussed previously, in practical terms, unbiased measurements of Z 2 may be obtainable from test reports of the drug, but getting unbiased data for Z 1 may prove very challenging. Interestingly enough, the causal effect can still be identified by adjustment on the set Z={Z 1 ,Z 2 }, if P (z 2 ) is available even if P (z 1 ) is not, which is shown in the expression below:\nP (y|do(x)) = X Z P (y|x, z, S=1)P (z1|z2, S=1)P (z2) (4)\nEven when unbiased data over all the candidate covariates is available, it may be the case that no valid adjustment in the form given by Eqs. (2) and (3) exists, while it is still possible to adjust by a subset of the covariates. To witness, consider the model shown in Fig. 2 and note that while neither criteria is applicable, the effect of X on Y is estimable by adjustment using external data on Z 2 , i.e.:\nP (y|do(x))= X Z P (y|x,z,S=1)P (z1,z3|z2,S=1)P (z2) (5)\nThis adjustment requires Z 1 to be used, but only its biased measurements. If external measurements on Z 1 are included the adjustment is no longer valid. This may be surprising since a biasing path between S and Y is opened when X 1 or Z 1 are observed. In fact, selection bias can be controlled by external measurements over Z 2 alone (refer to the appendix for the detailed derivation of (4) and ( 5)). The following definition extends the notion of adjustment to account for selection bias and external data: Definition 7 (Adjustment Pair). Given a causal diagram G augmented with selection variable S, disjoint sets of variables X, Y, Z, and a set Z T \u2713 Z, Z, Z T is said to be an adjustment pair for recovering the causal effect of X on Y if for every model compatible with G it holds that:\nX 1 X 2 Y Z 1 Z 2 Z 3 S\nP (y|do(x)) = X Z P (y|x,z,S=1)P (z\\z T |z T ,S=1)P (z T )(6)\nRemark. The expression given in Eq. ( 6) is a natural extension of Eq. (1) and it captures the orthogonal nature of confounding and selection biases while allowing for the use of unbiased data over a subset of the covariates. Furthermore, Eqs.\n(2) and (3) are special cases of (6) corresponding, respectively, to the pairs (Z, ;) and (Z, Z).\nThe following criterion determines whether a pair (Z, Z T ) yields a valid adjustment: Definition 8 (Generalized Adjustment Criterion Type 3 (GACT3)). Given a causal diagram G augmented with selection variable S, disjoint sets of variables X,Y,Z and a set Z T \u2713Z; Z, Z T is an admissible pair relative to X,Y in G if: (a) No element in Z is a descendant in G X of any W / 2 X lying on a proper causal path from X to Y. In other words, cond. (a) prevents causal paths to be compromised by conditioning on an element in Z, (b) requires all non-causal paths to be blocked by Z, and (c) ensures that the influence of the selection mechanism on the outcome is nullified by Z T .\nThe following theorem states that the pairs admissible by the graphical criterion in Def. 8 are exactly those that constitute adjustment pairs as in Def. 7.\nTheorem 1 (Admissible Pairs are Adjustment Pairs). Z, Z T is an adjustment pair for X, Y in G if and only if it is admissible by Def. 8.\nCorollary 2 (Causal Effects Recovery by Adjustment). Let G be a causal diagram augmented with a variable S representing the selection mechanism. Let V be the set of variables measured under selection bias, and T \u21e2 V the set of variables measured externally in the overall population. Consider disjoint sets of variables X, Y \u2713 V, then the causal effect P (y | do(x)) is recoverable from {P (v | S=1), P (t)} by the adjustment expression (6) while Z T \u2713 T, in every model inducing G if and only if Z, Z T is an admissible pair relative to X, Y in G according to Def. 8.\nCorollary 2 answers to the proposed task of obtaining causal effects by adjustment from the data assumed as input. This means that the causal effect of X on Y can be estimated if an admissible pair Z, Z T \u2713 T exists.\nAs noted, Eq. ( 6) reduces to expression (2) and ( 3) when considering pairs of the form (Z, ;) and (Z, Z), respectively. By the same token, GACT1 and GACT2 are special cases of GACT3. That is, Def. 8 will be equivalent to Def. 5 when Z T = ; and equivalent to Def. 6 when Z T = Z, as stated in the following propositions.\nProposition 1. If Z T = ;, then GACT1 () GACT3. Proposition 2. If Z T = Z, then GACT2 () GACT3.\nFig. 3 summarizes the inputs and adjustment expressions associated with each criterion.", "publication_ref": [], "figure_ref": ["fig_4", "fig_0", "fig_6"], "table_ref": []}, {"heading": "Finding Admissible Sets", "text": "Once the admissibility of adjustment pairs has been characterized, it's natural to ask how to find them systematically and efficiently. This task is especially relevant since factors such as feasibility, cost, and statistical power may be relevant when choosing one of such sets.\nTo illustrate the complexity of this task, suppose we want to list all possible adjustment sets for the causal diagram given in Fig. 4. It contains`non-causal paths from X to Y . For any pair Z, Z T admissible in this model, Z and Z T must contain at least one variable in every one of the`paths. For path i, either V i1 , V i2 , or both should be in those sets. In total, there are 3`different Z, and for each one of them there are 3 k sets Z T , where k is the number of paths that contain both variables in Z. The possible admissible pairs are in the Cartesian product of those sets, which amounts to O(3 2`) possibilities. It is clear that any algorithm that aims to output all admissible sets will take exponential time. Hence, no efficient algorithm exists for this task. In order to ameliorate this problem, we consider a special complexity class called polynomial delay (Takata 2010). Algorithms belonging to this class have the special property that the time required to output the first solution (or indicate failure), and the time between the outputs of consecutive solutions, is polynomial in the size of the input.\nWe show next an alternative, equivalent version of the criterion given in Def. 8 that will prove useful to operate within the polynomial delay class.\nDefinition 9 (Generalized Adjustment Criterion Type 3 (Alternative) GACT3A). Given a causal diagram G augmented with selection variable S, disjoint sets of variables X, Y, Z and a set\nZ T \u2713 Z; Z, Z T is an admissible pair relative to X, Y in G if: (a) Z \\ Dpcp(X, Y) = ; (b) (Y ? ? X | Z, S) G pbd XY (c) (Y ? ? S | Z T ) G pbd XY where Dpcp(X,Y) = De (De(X) G X \\ X) \\ An(Y) G X .\nThe set Dpcp(X, Y) was originally introduced in (van der Zander, Liskiewicz, and Textor 2014) to account for the set of descendants of variables that lie in a proper causal path from X to Y. Proposition 3. Def. 9 is equivalent to Def. 8.\nIn fact, Def. 9 is appealing to our task since each of the conditions can be easily verified, algorithmically, in a graph.\nThe following definition will be used to describe a collection of sets that separate variables in a causal model, subject to subset and superset constraints: Definition 10 (Family of Separators). Let X, Y, R be disjoint sets of variables in a causal diagram G, and let I \u2713 R be another set. Define\nZG (X,Y) hI,Ri := {Z | (X? ?Y|Z)G and I\u2713Z\u2713R} (7)\nto be the family of all sets Z that d-separate X and Y in G and contain all elements in I but no element outside R.\nFor convenience, let the set of viable candidates for adjustment be denoted and defined as:\nC = V \\ (X [ Y [ Dpcp(X,Y))(8)\nUsing this notation, the families that satisfy the conditions of our criterion can be specified. For conditions (a) and (b):\nZ a,b = n Z Z [ {S}2Z G pbd XY (X,Y) h{S},C [ {S}i o (9)\nWe would like our algorithm to take into account the availability of external data over a set of covariates T. In order to obtain admissible pairs for which the adjustment is estimable using the input as in Corollary 2, the set T is incorporated in the definition of the family for condition (c):\nZc = Z G pbd XY ({S},Y) h;,Ti .(10)\nOur task can be summarized as finding pairs in the set:\nZ a,b,c = n\u21e3 Z, Z T \u2318 2 Z a,b \u21e5 Zc Z T \u2713 Z o (11)\nAlgorithm 1 presents the procedure LISTADJPAIRS that solves this problem, as well as auxiliary routines used by it. Specifically it may be used to:\n1. Given external data P (t), list all admissible pairs such that Z T \u2713 T.", "publication_ref": ["b30"], "figure_ref": ["fig_2"], "table_ref": []}, {"heading": "List all admissible pairs (by setting", "text": "T = V \\ (X [ Y))\nsuch that scientists know what external data to measure.\nFunctions LISTSEPAB and LISTSEPC are modifications of the enumeration algorithm LISTSEP in (van der Zander, Liskiewicz, and Textor 2014). The function FINDSEP is also described in that paper, and works as follows: given a graph G, sets of variables X, Y, I, R, where X, Y, R are disjoint and I \u2713 R; FINDSEP is guaranteed to output a e Z 2 Z G (X,Y) hI,Ri whenever there exists a separator C such that I\u2713C\u2713R; otherwise it returns ? denoting failure.\nProposition 4 (Correctness of LISTSEPC). Given a graph G, a variable S, sets of variables Y, I, R, Z, where {S}, Y, Z are disjoint and I \u2713 R \u2713 Z; LISTSEPC outputs all pairs Z, Z T , where \nZ T 2 Z G ({S},Y) hI,Ri. Criterion Input Adjustment Expression Biased Data Unbiased Data GACT1 {P (v | S=1)} P Z P (y | x, z, S=1) P (z | S=1) GACT2 {P (v | S=1), P (t)} P Z P (y | x, z, S=1) P (z) GACT3 {P (v | S=1), P (t)} P Z P (y | x, z, S=1) P z \\ z T | z T , S=1 P z T Figure 3: Comparison of the Adjustment Types X Y V 11 V 12 V 21 V 22 . . . . . . V`1 V`2 S\nZ, Z T 2 ZG (X,Y) hI,Ri \u21e5 ZG ({S},Y) h;,Ti Z T \u2713Z .\nThe following theorem states that the algorithm LISTAD-JPAIRS can solve the task proposed in this section.\nTheorem 3 (Correctness of LISTADJPAIRS). Given a graph G, disjoint sets X, Y, T, and a selection variable S, LISTADJPAIRS outputs all admissible pairs Z, Z T relative to X, Y in G such that Z T \u2713 T.\nIt is worth noting that a straightforward adaptation of the algorithm LISTSEP (van der Zander, Liskiewicz, and Textor 2014) may be used to find sets in Z 2 Z a,b and Z T 2 Z c . However, the condition Z T \u2713Z has to be verified so as to produce admissible pairs. One strategy could be to search for sets in Z a,b first, and then, while a second run outputs each set in Z c , validate if it is a subset of any output from the first batch of sets. In the worst case, exponential time is required to output the first admissible pair. A better idea would be to search for sets in Z T 2 Z c | Z T \u2713 Z as soon as some Z2Z a,b is found, and then output pairs made of Z and the outputs of the secondary search. While improving over the original strategy, it may be the case that, for some sets in Z a,b , there is no set in Z c , which would lead to an exponential waiting time to get the first output.\nProp. 6 and Thm. 4 show that LISTADJPAIRS is, in fact, able to achieve O(n(n + m)) delay by carefully combining the search for the components of the pairs, where n, m are the number of variables and edges in G, respectively.  G pbd", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "XY", "text": "Compute proper backdoor graph from G\n3: R (V [ {S}) \\ (X [ Y [ Dpcp(X, Y)) 4:\nLISTSEPAB(G pbd XY , X, Y, S, {S}, R, T) 5: end function 6: function LISTSEPAB(G, X, Y, S, I, R, T) end if 27: end function Using covariates from An(X[Y) is sufficient to block any biasing path when controlling for confounding bias, which does not hold when selection bias comes into play. The proposition below constitutes a natural extension of this result when searching for adjusting pairs, in particular, considering the set An(X[Y[{S}).\nProposition 7. Suppose a pair Z, Z T is admissible relative to X, Y in G. Then, the pair Z A , Z T A , where\nZ T A =Z T \\An(X[Y[{S}) and Z A =Z\\An(X[Y[{S}), is also admissible.\nIf the data scientist is not interested in deciding among different adjustment pairs to use, it is possible to explicitly construct a pair if one exists, namely:\nTheorem 5 (Explicit admissible set construction). There exists an admissible pair in a causal diagram G relative to disjoint sets of variables X, Y if and only if the pair Z, Z T is admissible, where\nZ = An(X [ Y [ {S}) G pbd XY \\ C (12) Z T = (An({S} [ Y) G pbd XY \\ T) \\ C (13)\nCorollary 6 (Admissible pair can be constructed in linear time). One can determine the existence of an admissible pair and construct one in O(n + m) time.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "Inverse Probability Weighting Estimation", "text": "Covariate adjustment is currently the most widely used method for causal effect estimation in practice, even when more powerful identification methods have been developed in recent years (Pearl 2000). Adjusting for covariates Z involves finding the conditional probability of Y given X for each stratum defined by the possible values of the covariates, which may present computational and sample complexity challenges. The number of different strata may grow rapidly with the cardinality of the set Z, and the number of samples falling under each stratum may be too small to provide a reliable estimate of the conditional distribution.\nThere exist robust statistical estimation procedures for the adjustment expression (1) that circumvent this issue.\nTo do so, one can rewrite the adjustment expression (1) as P (y | do(x)) = P Z P (y, x, z)/P (x | z). If a reliable estimate of the conditional distribution P (x | z) could be obtained, which is known as the \"propensity score\" (Pearl, Glymour, and Jewell 2016), then the causal effect could be estimated by \"weighting\" every observed sample by the factor 1/P (x | z), leading to the widely used \"inverse probability weighed (IPW) estimator\" (Lunceford and Davidian 2004). Assume we are interested in the mean causal effect\n\u00b5 = E[Y | do(x)]. Given observed i.i.d. data {(X i , Y i , Z i )} n i=1 , the IPW estimator for \u00b5 is given b\u0177 \u00b5 IPW = 1 n n X i=1 wiI X i =x Yi (14\n)\nwhere I Xi=x is the indicator function, w i = 1/P (X\ni | Z i ), andP (X i | Z i )\nis the estimator of the propensity score. In practice,P (X i | Z i ) is estimated from data by assuming some parametric model (typically a logistic regression model).\u03bc IPW is a consistent estimator for \u00b5 if the model for P (x | z) is correctly specified.\nNext, we show that IPW style estimator could be constructed for causal effect estimation in the presence of selection bias using the generalized adjustment given in this paper. We rewrite the adjustment expression (6) as follows:\nP (y|do(x)) = X Z P (y|x, z, S=1)P (z \\ z T |z T , S=1)P (z T ) = X Z P (y, x, z | S=1) P (x | z, S=1) P (z T ) P (z T | S=1) (15) = X Z P (y, x, z | S=1) P (x | z, S=1) P (S=1) P (S=1 | z T ) (16)\nThe quotient P (z T )/P (z T | S=1) (in Eq. ( 15)), which is directly computable from the combination of the external and biased datasets, can be equivalently expressed as P (S=1)/P (S=1 | z T ) (in Eq. ( 16)). The later is usually known as the \"inverse probability-of-selection weight (IPSW)\" (Cole and Stuart 2010), and, in practice, is estimated by assuming some parametric model such as logistic regression. Given observed data {(X i , Y i , Z i )} n i=1 under selection bias (from P (v | S=1)), assume we could obtain reliable estimate of the propensity score P (x | z, S=1) and the inverse probability-of-selection P (S=1)/P (S=1 | z T ) from selection biased data and additional unbiased external data. Let\nw 0 i = 1/P (X i | Z i , S=1) and w S i = P (S=1)/P (S=1 | Z T i ).\nThe causal effect can be estimated by first weighting every observed sample under selection bias by the weight w 0 i \u2022 w S i . We propose the following estimator for \u00b5\u03bc\nIPWS = 1 n n X i=1 w 0 i w S i I X i =x Yi.(17)\nTheorem 7.\u03bc IPWS is a consistent estimator for \u00b5 = E[Y | do(x)] if the models for P (x | z, S=1) and P (S=1)/P (S=1 | z T ) are correctly specified.\nFurther, whenever Z T = ;, the IPW estimator for the adjustment expression (2) is given b\u0177\n\u00b5 IPW2 = 1 n n X i=1 w 0 i I X i =x Yi (18)\nNote that in ( 18) the samples only need to be weighted by the propensity score but do not need to be weighted by the IPSW in order to adjust for selection bias. The difference between ( 18) and ( 14) is that in (18) the samples are observed under selection bias. One of the contributions of this paper is that we specify conditions over the adjustment set on how the biased data samples should be weighted in order to obtain unbiased estimates of causal effects.", "publication_ref": ["b23", "b20", "b17", "b5"], "figure_ref": [], "table_ref": []}, {"heading": "Conclusions", "text": "This work generalizes the notion of adjustment set to that of adjustment pairs (Def. 7), that when admissible, recover causal effects via adjustment from a distribution under selection bias and auxiliary external data, while simultaneously controlling for confounding bias. We present a sufficient and necessary graphical condition (Def. 8) to determine if a pair is admissible, valid for any causal diagram G with latent variables in non-parametric settings. We develop the algorithm LISTAJDPAIRS that lists all admissible pairs for given X, Y in G (Theorem 3) with polynomial delay (Theorem 4). These results allow scientists to take into consideration the effort of measuring covariates, such as associated cost, availability, or feasibility. Finally, we describe how to use the inverse probability weighting technique to estimate adjustment under selection bias. Adjustment is not the only method to estimate causal effects, but it is still the most popular one in the empirical sciences. We hope the results presented in this paper will help the broad scientific community to account for selection bias in their studies.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "Appendix Generalized Adjustment with partial External Data", "text": "For convenience we restate some of the definitions below:\nDefinition 5 (Generalized Adjustment Criterion Type 1 (GACT 1)). Z satisfies the criterion w.r.t. X,Y in G if: (a) No element of Z is a descendant in G X of any W / 2 X which lies on a proper causal path from X to Y. (b) All non-causal paths between X and Y in G are blocked by Z and S. (c) Y is d-separated from S given X under the intervention do(x), i.e., (Y ? ? S | X)\nG X . (d) Every X 2 X is either a non-ancestor of S or it is independent of Y in G X , i.e., 8 X2X\\An(S) (X ? ? Y) G X\nDefinition 6 (Generalized Adjustment Criterion Type 2 (GACT 2)). Z satisfies the criterion w.r.t. X,Y in G if: (a) No element of Z is a descendant in G X of any W / 2 X which lies on a proper causal path from X to Y. (b) All non-causal paths between X and Y in G are blocked by Z. (c) Y is d-separated from the selection mechanism S given Z and X, i.e., (Y ? ? S | X, Z).\nFor causal diagram in figure 2(d) the effect of interest can be identified by adjustment on the set Z = {Z 1 , Z 2 } where Z 1 / 2 T and Z 2 2 T as\nP (y|do(x)) = X Z P (y|x, z, S=1)P (z1|z2, S=1)P (z2).(1)\nThe derivation used to obtain (1) is as follows:\nP (y|do(x)) (2) = X Z 1 P (y|do(x), z1)P (z1 | do(x)) (3) = X Z 1 P (y|do(x), z1, S=1)P (z1) (4) = X Z 1 P (y|do(x), z1, S=1) X Z 2 P (z1|z2)P (z2) (5) = X Z P (y|do(x), z, S=1)P (z1 | z2, S=1)P (z2) (6) = X Z P (y|x, z, S=1)P (z1 | z2, S=1)P (z2)(7)\nExpression (3) appears after conditioning for Z 1 . Since Z 1 is not a descendant of X the intervention does not have effect on it and by rule 3 of do-calculus the do(x) can be removed as in (4). In expression (5) the second term has been summed over variable Z 2 and for the last expression (6) the sum is moved to the left and by the independence (Y ? ? Z 2 | X, Z 1 ) G X is used to introduce Z 2 in the conditional part of the first term. Finally, rule 2 of do-calculus can be applied to change the do() operator from X in the first term, resulting in (7).\nX Y Z (a) X Y Z (b) X Y Z S (c) X Y Z 1 Z 2 S (d)\nFigure 2: In (a) Z is a confounder for X and Y , (b) represents model in (a) after an intervention on X. Model (c) has both selection and confounding bias. In (d) we can control for either confounding or selection bias, but not for both unless we have external data on P (Z 1 ), P (Z 2 ) or both. For the model in figure 3 neither of the criteria in Definitions 5 and 6 is applicable. However, the causal effect is estimable by adjustment using external data on Z 2 as follows:\nX 1 X 2 Y Z 1 Z 2 Z 3 S\nP (y | do(x)) (8) = P (y | do(x)) X Z 3 P (z3) (9) = X Z 3 P (y | do(x), z3)P (z3) (10) = X Z 2 ,Z 3 P (y | do(x), z2, z3)P (z2|do(x), z3)P (z3) (11) = X Z 2 ,Z 3 P (y | do(x), z2, z3)P (z2 | z3)P (z3) (12) = X Z 2 ,Z 3 P (y | do(x), z2, z3, S=1)P (z2 | z3)P (z3) (13) = X Z P (y|x,z,S=1)P (z1|do(x),z2,z3, S=1)P (z2,z3) (14) = X Z P (y|x, z, S=1)P (z1|do(x), z2, z3, S=1)P (z3|z2, S=1)P (z2) (15) = X Z P (y | x, z, S = 1)P (z1, z3 | z2, S=1)P (z2)(16)\nTo obtain ( 9) the initial expression is multiplied by P Z3 P (Z 3 ), then the expression is moved inside the sum and the variable Z 3 can be added to the conditional part because (Y ? ?Z 3 | X) G X resulting in (10). Next step is to condition on Z 2 to obtain (11) and use independence (Z 2 ? ? X | Z 3 ) G X(Z 3 ) that yields (12). Introduce the term S=1 in the first factor of (13) by independence (Y ? ? S | Z 2 , Z 3 ) G X . Expression ( 14) follows after conditioning on Z 1 and in (15) the distribution on Z 2 , Z 3 is separated into two factors using the chain rule while S=1 is introduced by independence (Z 3 ? ? S | Z 2 ). Finally, expression (16) is achieved using (Z 1 ? ?\nX | Z 2 , Z 3 ) G X(Z 2 ,Z 3 )\nto remove the do() operator in the second factor. This final expression only requires external data over Z 2 .\nDefinition 7 (Adjustment Pair). Given a causal diagram G augmented with selection variable S, disjoint sets of variables X, Y, Z, and a set Z T \u2713 Z, Z, Z T is said to be an adjustment pair for recovering the causal effect of X on Y if for every model compatible with G it holds that:\nP (y|do(x)) = X Z P (y|x,z,S=1)P (z\\z T |z T ,S=1)P (z T )(17)\nRemark 2 (Generality of the Adjustment Expression). Note that in expression (17) the covariates in the second factor are conditioned by the remaining covariates and S, and the third factor consists of a marginal distribution over the externally measured covariates. This structure is not arbitrary and follows from the assumption that external data is always available in the form of marginal joint probability distributions. Note that the expression can be decomposed in several factors as follows:\nP z \\ z T , S=1 P z T = Y |Z| i=j+1 P (z i | z i 1 , z i 2 , . . . , z 1 , S=1) Y j i=1 P (z i | z i 1 , z i 2 , . . . , z 1 )(18)\nFor some 0 6 j 6 |Z|. If the S variable appears at arbitrary covariate terms, let P (z\nk | z k 1 , z k 2 , .\n. . , z 1 ) be the first (starting from the largest index) not containing the S variable. In order to compute this distribution, external data over\nP (z k , z k 1 , z k 2 , . . . , z 1 ) is required.\nIn consequence, even if the terms with z i for 1 6 i < k do not contain the S variable, external measurements are required on them.", "publication_ref": [], "figure_ref": ["fig_0", "fig_0", "fig_6"], "table_ref": []}, {"heading": "Proof for Theorem 1", "text": "Definition 8 (Generalized Adjustment Criterion Type 3 (GACT 3)). Given a causal diagram G augmented with selection variable S, disjoint sets of variables X,Y,Z and a set Z T \u2713Z; Z, Z T is an admissible pair relative to X,Y in G if:\n(a) No element in Z is a descendant in G X of any W / 2 X lying on a proper causal path from X to Y. (b) All non-causal paths in G from X to Y are blocked by Z and S. (c) Z T d-separates Y from S in the proper backdoor graph, i.e. Y ? ?\nS | Z T G pbd XY .\nTheorem 1 (Admissible Pairs are Adjustment Pairs). Z, Z T is an adjustment pair for X, Y in G if and only if it is admissible by Definition 8.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "Claims and lemmas", "text": "In order to prove the theorem, we will magnify the causal diagram as described in (Shpitser, VanderWeele, and Robins 2010), that is, we will replace every bidirected arrow connecting variables A and B with an observable variable C\nA,B that points to the pair previously connected by the bidirected arrow. Also, we will introduce a new mediator in every arrow leaving from any variable in Y, that is, every edge of the form Y ! A is replaced with Y ! C\nA ! A, where Y 2 Y and A 2 V. Let C be the set of all new variables introduced by the magnification process.\nLet any set with the subscript nd denote all the variables in such set that are not descendants of any variable in X, that is, for any set\nA let A nd = {A 2 A | A / 2 De (X)}.\nAnalogously, the subscript d will denote all the variables in that are descendants of any variable in X.\nWe show that the causal effect can be derived from the available data. In order to perform the steps we will define several subsets of Z such as:\n\u2022 Z S = {Z 2 Z M | (Z ? ? S | Z T )}.", "publication_ref": ["b28"], "figure_ref": [], "table_ref": []}, {"heading": "\u2022 L", "text": "1 to be all the variables in\n(V [ C) \\ (Z [ X [ Y) that: 1. Are d-connected to Y given Z T , Z S in G \\ X 2. Are not descendants of X 3. Are ancestors of some Z 2 Z T [ Z S \u2022 L 2 be defined as all variables in (V [ C) \\ (Z [ X [ Y) that: 1. Are d-connected to Y given Z in G \\ X 2. Are independent of X given Z S , Z T and S on G X(Z S ,Z T ,S)\n3. Are ancestors of some variable in Z.\n\u2022 Z X = n Z 2 Z \\ (Z T [ Z S ) | (Z ? ? X | Z S , Z T , S) G X(Z S ,Z T ,S) o \u2022 Z Y = Z \\ (Z T [ Z S [ Z X ).\nLemma 1 (which is after the claims below) proves independences that will be used in the derivation. But before stating it, we will need the following claims: Claim 1. If there exist a path r 1 between some X 0 2 X and S where S is a descendant of X 0 , such that r 1 does not contain any variable in Z T and the conditions from def 8 are satisfied, then r 1 exists in G pbd XY . Proof. Path r 1 can be absent in G pbd XY only if the edge from X 0 towards S belongs to a proper causal path. For the sake of contradiction suppose this is the case, and let R be the variable at the other end of that edge. It follows that R is in a proper causal path that ends with some Y 00 2 Y, and does not contain any variable in Z for the satisfaction of condition (a). Since the path between R and S is a subpath of r 1 it does not contain any Z T and if it contains any other variable in X 00 2 X restart the argument with X 0 = X 00 . Then, the path formed between S and Y 0 passing through R exists in G pbd XY and is active given Z T , contradicting condition (c). Since we reached a contradiction the edge must be in the mentioned graph and r 1 as well.\nClaim 2. If there exists a path r 1 between a variable W 0 / 2 Z and some Y 0 2 Y that does not contain any variable in X and is active given Z T , Z S . And there exists also, a path r 2 directed from W 0 and S that does not contain any Z T , Z S . Then, condition (c) is violated.\nProof. If r 2 contains some X let X 0 be the closest to W 0 , then X 0 2 An (S) and by claim 1, the path between X 0 and S exists in G pbd XY . Then, r 2 is active in G pbd XY given Z T , Z S . Let r be the path between S and Y 0 composed with edges from r 1 and r 2 . Path r exists in G pbd XY and is active given Z T , then condition (c) is not satisfied.\nClaim 3. If there exists a non-causal path p between some X 0 2 X and some Y 0 2 Y which is active in G X(Z T ,Z S ,S) given Z T , Z S , S. And, such path p does not contain any other variable in X asides from X 0 . Then the conditions in definition 8 are not satisfied.\nProof.\n\u2022 Path p has to be active given Z T , Z S (without S). This is because if not observing S closes p, it implies that S is the descendant of a collider W 0 in p, such that W 0 is active given S but inactive otherwise. Let r 1 be the path between W 0 and Y 0 and let r 2 bet the path between W 0 and S, then by virtue of claim 2 condition (c) is violated, a contradiction.\n\u2022 Since p is a non-causal path, condition (b) requires it to be closed given Z [ {S}. Then, there must exists some Z \u21e4 2 Z \\ (Z T [ Z S ) that closes p (note that S cannot block any path and particularly p). We will show that such Z \u21e4 cannot exists under the criterion's conditions.\n\u2022 Suppose there exists a Z \u21e4 that blocks p. Since Z \u21e4 / 2 Z S , there exist a path q 1 between S and Z \u21e4 that is active given Z T . Let q be the path between S and Y 0 formed using edges from q 1 and p.\n-The path q 1 does not contain any variable in Z S . Since q 1 is active given Z T , any variable in it is not independent of S given Z T , hence none of them can be in Z S .\n-According to condition (c) q has to be blocked given Z T in G pbd XY . Since p does not contain any X (other than X 0 ) and it is active given Z T , Z S the path q must be closed in G pbd XY because (1) Z \u21e4 is a collider in it, (2) there exists a collider in p that belongs to Z S , or (3) there exists some X 00 in q 1 for which one or two edges in q 1 are present in G but not in G pbd XY : (1) If Z \u21e4 is a collider in q, then Z \u21e4 is active because it has a descendant in Z T in G pbd XY . The portion of p that goes from X 0 to Z \u21e4 has an edge coming out of Z \u21e4 for it to block p and be a collider in q at the same time. Regarding that portion: \u21e4 it does not contain any variable in Z S : Suppose it does, then there is a path between S to that variable going through Z \u21e4 that contradicts the definition for Z S . \u21e4 if it has a collider in between, it must be active given Z T , and it is a descendant of Z \u21e4 , implying that Z \u21e4 is active as well. \u21e4 if it is directed from Z \u21e4 to X 0 , then there exists a Z 00 2 Z T which is a descendant of Z \u21e4 . We know that the edge incoming to X 0 exists in G\nX(Z T ,Z S ,S) (by assumption of p), then X 0 must have a descendant in Z T [ Z S [ {S}. Any descendant of X 0 in Z S is d-connected to S\ngiven Z T with a path passing through X 0 and Z \u21e4 unless some variable in Z T is in between that descendant and X 0 , which means that X 0 has to have a descendant Z 00 2 Z T [ {S}.\nIf the descendant of X 0 is S without any Z T in between, let the path between X 0 and S be called r 1 which exists G pbd XY by claim 1. Let p 0 be the path from S to Y 0 formed joining r 1 and p. Path p 0 exists in G pbd XY and cannot contain any variable in Z S because such variable would not satisfy the independence that defines Z S . Therefore, p 0 is active given Z T alone and witnesses a contradiction to condition (c). As a consequence Z 00 2 Z T . The edge outgoing from X 0 towards Z 00 is not in a proper causal path. Assume for the sake of contradiction that it is, then let R be the variable at the other end of that edge (possibly Z 00 itself). This means that R is in a proper causal path and has Z 00 as descendant, contradicting condition (a). As a result, Z 00 2 Z T is a descendant of Z \u21e4 in G pbd XY , which make Z \u21e4 an active collider. (2) If Z \u21e4 is not an inactive collider in q (given Z T ), then q does not contain any variable in Z S . If this was the case, that variable would be d-connected to S given Z T which contradicts the definition of Z S . (3) If neither Z \u21e4 nor some Z S block q, there must exists a X 00 (as defined before), but it is not possible under the criterion conditions: For X 00 to disconnect q in G pbd XY , the path q 1 should have one of the following structures:\n\u21e4 Z \u21e4 \u2022 \u2022 \u2022 X 00 \u2022 \u2022 \u2022 S or Z \u21e4 \u2022 \u2022 \u2022 X 00 ! \u2022 \u2022 \u2022 S\nwhere the outgoing edge from X 00 belongs to a proper causal path: Suppose the edge towards Z \u21e4 is in a proper causal path and let R be the variable at the other end of that edge (possibly Z \u21e4 itself). Then either Z \u21e4 2 De (R) or there exists some variable in Z T [ De (R) in the path between X 00 and Z \u21e4 , in both cases condition (a) is violated because there is a descendant of R that is observed while R is in a proper causal path. Now suppose the edge towards S is in a proper causal path and let R be the variable in the other end of that edge. Then R has to be an ancestor of S otherwise there is a collider in between (possibly R itself) that must be active given Z T which implies that R is in Z T or has a descendant on it, violating condition (a). Then X 00 is an ancestor of S and the path between them has no Z T . By claim 1 the path between them, hence the outgoing edge, exists in\nG pbd XY . \u21e4 Z \u21e4 \u2022 \u2022 \u2022 ! X 00\n\u2022 \u2022 \u2022 S: In this case Z \u21e4 would be independent of S given Z T because of X 00 not being active, contradicting our assumption that Z \u21e4 / 2 Z S because of path q 1 .\nLemma 1. Suppose that in the causal diagram G there are sets of variables Z, X and Y, such that Z is admissible by the criterion in Definition 8 relative to X and Y. Then, the following independences hold in the magnification of G:\n(Y ? ? Z T d , Z S d | L 1 , Z T nd , Z S nd , X) G X (19) (Y ? ? S | Z T , X) G X (20) (Y ? ? S | Z T , Z S , X) G X (21) (L 1 ? ? X | Z T , Z S ) G X(Z T ,Z S ) (22) (Y ? ? Z Y | Z T , Z S , L 2 , Z X , X, S) G X (23) (L 2 ? ? X | Z, S) G X(Z,S)(24)\nProof. We will go over each independence and show that it holds:\n1. (Y ? ? Z T d , Z S d | L 1 , Z T nd , Z S nd , X)\nG X : Suppose it does not hold, then there exists a path p between Z 0 2 Z S d [ Z T d and Y 0 2 Y. The path p cannot contain any variable in X because in the graph G X when X is observed, any path containing it is closed. The path p should have one of the following structures: \n(a) Z 0 ! \u2022 \u2022 \u2022 ! Y 0 : Since Z 0 is a descendant of X\nZ 0 \u2022 \u2022 \u2022 Y 0 : Here Z 0 is a descendant of Y 0 , so Y 0 is not a descendant of X otherwise Z 0 contradicts cond. (a)\nbecause it is a descendant of Y 0 which is part of a proper causal path. But if Y 0 is not a descendant of X, the child of Y 0 in p is a node added in the magnification process and satisfies the definition of L 1 (it is always d-connected to Y 0 , it is not a descendant of X and it is an ancestor of Z 0 ) therefore p is blocked.\n(c) Z 0 \u2022 \u2022 \u2022 ! W \u2022 \u2022 \u2022 Y 0 : There is a collider W in p that belongs or has a descendant W 0 2 L 1 [ Z T nd [ Z S\nnd where W could be equal to W 0 , such that p is active. Without loss of generality assume that W is the closest of such colliders to Y 0 in p. Let L 0 be the parent of W in the section of p that goes from W to Y 0 , we want to show that L 0 belongs to L 1 and blocks p. First, note that L 0 cannot be Y 0 itself because the edge between Y 0 and W would be replaced with a mediator during the magnification process, making the mediator the parent of W in p. Second, we can assure that the path between W 0 and Y 0 does not contain any variable Z \u21e4 2 Z T d [ Z S d because if it does, Z \u21e4 has to be an ancestor of Y 0 or W 0 , in the first case violating condition (a) and in the second W 0 would also be a descendant of X which is not possible given its definition. Third, L 0 is d-connected to Y 0 given Z T , Z S in G \\ X because the path from W 0 to Y 0 is active given Z T nd [ Z S nd and does not contain any Z T d [ Z S d and does not contain any X. L 0 is also an ancestor of all the descendant of W including W 0 , if W 0 belongs to L 1 , it has, by definition, a descendant in Z T [ Z S that are also descendants of L 0 . Finally L 0 is not a descendant of X otherwise W 0 is also descendant of X which is not possible by its definition. Therefore\nW 0 2 L 1 . (d) Z 0 \u2022 \u2022 \u2022 ! Y 0 :\nHere the path is not completely directed in any direction but does not contain any collider. Let L 0 be the common ancestor of Z 0 and Y 0 in p. Note that L 0 satisfy the definition of L 1 and closes p as follows: L 0 is always an ancestor of Z 0 , neither L 0 nor any Z \u21e4 2 Z in the path between L 0 and Y 0 is a descendant of X, otherwise condition (a) is violated because they would lie in a proper causal path with descendants in Z. By assumption L 0 is d-connected to Y 0 given Z T nd , Z S nd , and since no descendant of X (i.e. Z T d , Z S d ) is on the path between them, L 0 and Y 0 are connected given\nZ T , Z S in G \\ X. Therefore, L 0 2 L 1 and p is closed. 2. (Y ? ? S | Z T , X)\nG X : From condition (c) we have:\n(Y ? ? S | Z T ) G pbd XY (25) =)(Y ? ? S | Z T ) G pbd XY X (26) =)(Y ? ? S | Z T , X) G pbd XY X (27) =)(Y ? ? S | Z T , X) G X (28\n)\nEq. (26) follows because removing incoming edges to X never introduces dependencies. Provided that no variable in X has incoming edges, introducing X to the set of observed variables may never compromise a previously established independence hence ( 27) follows. Finally, comparing the graphs G X and G pbd XY X we can see that the former could possibly have edges that are not in the second. Those edges are those that have tails in X and do not belong to a proper causal path. Since X is being observed in the independence any new path including those edges is always block, therefore independence (28) is implied.\n3. (Y ? ? S | Z T , Z S , X) G X : From the previous independence and the definition of Z S we have:\n(Y ? ? S | Z T , X) G X^( Z S ? ? S | Z T ) (29) =)(Y ? ? S | Z T , X) G X^( Z S ? ? S | X, Z T ) G X (30) =)(Y, Z S ? ? S | Z T , X) G X (31) =)(Y ? ? S | Z S , Z T , X) G X (32)\nHere statement (30) follows from the fact that conditioning on X while transforming the graph from G to G X can only add more independences, but does not remove any of the existent ones. Statement (31) follows from the composition axiom that holds whenever d-separation holds. Finally, statement (32) follows by weak union. 4. (L 1 ? ?\nX | Z T , Z S ) G X(Z T ,Z S )\n: Assume for the sake of contradiction that this does not hold. Then, fix a path p 1 from some\nL 0 2 L 1 to some X 0 2 X given Z T , Z S in G X(Z T ,Z S ) (X 0 \u2022 \u2022 \u2022 \u2022 \u2022 \u2022 L 0\n). Without loss of generality assume that X 0 is the closest variable in X to L 0 in p 1 , if it is not, restart the argument with that other X instead. By definition,\nL 0 is d-connected to some Y 0 2 Y by some path p 2 in G \\ X given Z T , Z S (L 0 \u2022 \u2022 \u2022 \u2022 \u2022 \u2022 Y 0 ).\nLet p be the path between X 0 and Y 0 formed using edges in p 1 and p 2 in G, also let W 0 be the closest node to L 0 that belongs to p, possibly L 0 itself.\n\u2022 If W 0 is connected to L 0 by a path that starts with an edge going out from W 0 (i.e. W 0 ! \u2022 \u2022 \u2022 L 0 ), then W 0 has a descendant Z 0 2 Z T [ Z S : Either W 0 is ancestor of L 0 and, by extension, of some\nZ 0 2 Z T [ Z S by definition of L 1 (i.e. W 0 ! \u2022 \u2022 \u2022 ! L 0 ! \u2022 \u2022 \u2022 ! Z 0 )\nor there is an active collider connecting W 0 and L 0 in the very same set, such collider is a\ndescendant of W 0 (W 0 ! \u2022 \u2022 \u2022 ! Z 0 \u2022 \u2022 \u2022 L 0\n). \u2022 p does not contain any variable in X except at the endpoint: This is because p 1 does not include any other X, and p 2 is active in G \\ X. \u2022 p is not a proper causal path. Suppose it is a proper causal path, and consider the relationship between L 0 and W 0 .\n-If W 0 = L 0 then L 0 2 De (X) contradicting the definition of L 1 .\n-If the path between W 0 and L 0 has an edge pointing into W 0 then W 0 is a collider in p 1 implying that X 0 and L 0 are disconnected unless W 0 has a descendant in Z S [Z T . Since W 0 is assumed to be in a proper causal path, such descendant violates condition (a).\n-If the path between L 0 and W 0 has edges outgoing from W 0 then Z 0 is a descendant of W 0 , and since W 0 is in a proper causal path, Z 0 contradicts condition (a). \u2022 W 0 is not an inactive collider in p (given Z T , Z S ): If W 0 is a collider, it is connected to L 0 with an incoming or outgoing edge. If the edge is incoming to W 0 , then W 0 has to be active for p 1 to be active. If the edge is going out from W 0 or W 0 = L 0 , it follows that W 0 is active in p because it is an ancestor of Z 0 . \u2022 By claim 3 the criterion is not satisfied. Note that p is a non-causal path and it is active in G X(Z T ,Z S ) given Z T , Z S and does not contain any variable in X except for X 0 . The path p also exists in G X(Z T ,Z S ,S) because it contains the same or more edges than G X(Z T ,Z S ) . And p is active given Z T , Z S , S also because observing S cannot close it. Therefore, claim 3 applies to p.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "(Y", "text": "? ?Z Y | Z T , Z S , L 2 , Z X , X, S) G X :\nAssume the independence does not hold and fix a path p 1 that connects some\nY 0 2 Y to Z 0 2 Z Y given Z T , Z S , L 2 , Z X , X, S in G X .\nWithout loss of generality assume that Z 0 is the closest of such variables to\nY 0 in p 1 . \u2022 p 1 is active given Z T , Z S , L 2 , Z X , S (without X) in G X .\nPath p 1 does not contain any variable in X except at the endpoint because p 1 is active in G X given X, which means that it would be blocked or missing an edge if it contains X.\n\u2022 p 1 is active given Z T , Z S , Z X , S (without L 2 ) in G X .\nPath p 1 does not contain any variable in L 2 or any collider activated exclusively by L 2 and not by Z T , Z S , Z X , S. Suppose for the sake of contradiction that there is any variable L 0 2 L 2 activating p 1 . Since the path is assumed to be active given L 2 , L 0 may only be a collider in p 1 or it is the descendant of some Q which is a collider in p 1 that is active given L 0 but not Z T , Z S , Z X , S. It must be the case that the path between Q and L 0 does not contain any variable in Z T , Z S , Z X , S. Furthermore, it cannot contain any variable in Z Y either because it would not be independent of X in G X(Z T ,Z S ,S) given Z T , Z S , S because its ancestor in Z Y is not. Let Q 0 denote either L 0 if it is in p 1 or Q in the second case. Let R be the parent of Q 0 in the portion of p 1 that goes towards Y 0 . Note that R cannot be a collider in this path and R 6 = Y 0 because if Y 0 ! Q 0 was an edge in G, a new mediator was introduced during magnification. Furthermore, R 2 L 2 : if L 0 satisfies the first part of the definition of L 2 , R which is an ancestor of L 0 also satisfies it. Even if L 0 is d-connected to a variable in Y other than Y 0 , and behaves as a collider between R and that variable, L 0 is active given Z. For the second part, R has to be independent of X as stated in the definition of L 2 , otherwise L 0 would not satisfy this either. For the third part, L 0 2 An (Z) and R 2 An (L 0 ) then R 2 An (Z). As a consequence of R 2 L 2 , p 1 is blocked by it, which is a contradiction to our assumption, and the conclusion follows.\n\u2022 p 1 is active given Z T , Z S , S (without Z X ) in G X . Follows from the fact that p 1 does not contain any variable in Z X . Suppose this is not true, then letZ 2 Z X be the closest of such variables to Y 0 in p 1 .Z has to be an active collider for p 1 to be active. Let R be the parent ofZ in the portion of p 1 that goes towards Y 0 . Note that R 6 = Y 0 because if Y 0 !Z was an edge in G, a new mediator was introduced during magnification and R would be that mediator. Then, R 2 L 2 and blocks p 1 , because: first, R is d-connected to Y 0 through p 1 given Z unless S is a collider in between, but then independence ( 21) is violated (no variables in Z X [ Z Y are in this portion because we assumedZ and Z 0 were the closest to Y 0 in this path). Second R is independent of X given Z T , Z S , S on G X(Z T ,Z S ,S) elseZ would not satisfy this independence either, which is not the case by definition. Third, R is the ancestor ofZ. Since R would block p 1 ,Z cannot exists in p 1 .\n\u2022 p 1 is active given Z T , Z S (without S) in G X . This is because p 1 does not contain S. Suppose it does, then the subpath between S and Y 0 violates independence (21).\n\u2022 Since Z 0 does not belong to Z X , there exists a path p 2 that connects Z 0 to some\nX 0 2 X in G X(Z T ,Z S\n,S) given Z T , Z S , S. Assume, without loss of generality, that X 0 is the closest variable in X to Z 0 in the path p 2 . Let p the path between X 0 and Y 0 that uses edges in p 1 and p 2 and let W 0 be the closest node to Z 0 in p, possibly Z 0 itself. \u2022 p is not a causal path. For the sake of contradiction suppose p is a causal path, since p 1 exists in G X and p 2 only contains X 0 from X, p is also a proper causal path. Now, consider the path between W 0 and Z 0 :\nif W 0 = Z 0 we have a contradiction to condition (a).\nif it starts with an incoming edge, then W 0 is an active collider in p 2 , with a descendant in\nZ T [ Z S [ {S}. If the descendant is specifically in Z T [ Z S \u2713 Z there is a violation to condition (a).\nIf W 0 is an ancestor of S, let r 1 be the path between W 0 and Y 0 , which cannot contain any Z [ X by condition (a) and definition of proper causal path. Also let r 2 be the path between W 0 and S which does not contain any Z T , Z S . Then, by claim 2 condition (c) is violated.\nif it starts with an outgoing edge, then W 0 is an ancestor of Z 0 or a collider that is active in p 2 (i.e. Z T , Z S , S). If it is ancestor of Z 0 condition (a) is not satisfied. If ancestor of S the same argument as before applies again.\n\u2022 p 2 does not contain any variable in Z X [ L 2 : Both sets require the independence (Z X , L 2 ? ? X | Z T , Z S , S) G X(Z T ,Z S ,S)\n. Any variable in p 2 does not satisfy that independence by definition of p 2 .\n\u2022 If W 0 does not block p given Z T , Z S , S, then by claim 3 the conditions of the criterion in definition 8 are violated. To see this observe that if W 0 does not block p then it is active in the graph G X(Z T ,Z S ,S) given Z T , Z S , S and does not contain X except for X 0 , hence claim 3 applies to it.\n\u2022 If W 0 blocks p given Z T , Z S , S, then the criterion in definition 8 is violated: In this case W 0 has to be an inactive collider in p. If the edge that has Y 0 as endpoint in p is outgoing from Y 0 , let Q be the variable introduced as a mediator during magnification. If the edge is incoming to Y 0 , let Q be farthest ancestor of Y 0 in p. Note that Q cannot be W 0 itself because, even if Y 0 was the parent of W 0 in G, Q is a mediator. Here Q is d-connected to Y 0 given Z (no variable in Z X , Z Y is in p at all and any from Z T [ Z S would block p 1 ). Also Q is an ancestor of some Z (because the portion of p from Q to W 0 is either directed and W 0 is ancestor of Z 0 , or the subpath has a collider in Z T [ Z S ). No incoming edge to Q is possible in this section because its neighbor would be the farthest ancestor of Y 0 instead of Q and if Q is the mediator the edge must be outgoing. Then Q will be in L 2 unless it is not independent of X in G\nX(Z T ,Z S ,S) given Z T , Z S , S. If Q 2 L\n2 , p 1 is closed by Q. Hence, Q must not satisfy this independence. Yet the reason is not because of the path p, where Q is independent of X 0 in this sense. It follows that there exists a path p 0 1 between some X 00 2 X and Q in G X(Z T ,Z S ,S) , active given Z T , Z S , S. Without loss of generality assume X 00 is the closest of such variables to Q in p 0 1 . Meanwhile, the path p 0 2 from Q to Y 0 is open in G X given Z T , Z S , S. Let p 0 be the path formed between X 00 and Y 0 by joining edges from p 0 1 and p 0 2 . The path p 0 has one of the following structures:\n-X 00 \u2022 \u2022 \u2022 Q Y 0 (if Y 0\nis a parent of Q then it is a mediator because of the magnification).\n-\nX 00 \u2022 \u2022 \u2022 Q ! \u2022 \u2022 \u2022 ! Y 0 -Q Y 0 \u2022 \u2022 \u2022 X 00 (here Y 0 lies in p 0 1 ) -Q ! \u2022 \u2022 \u2022 ! Y 0 \u2022 \u2022 \u2022 X 00 (here Y 0 lies in p 0 1 ) In the four cases the path p 0 is active in G X(Z T ,Z S\n,S) given Z T , Z S , S and does not contain any X asides from X 00 . Then, claim 3 provides that the existence of p 0 contradicts our assumption that criterion in definition 8 was satisfied, a contradiction.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "(L", "text": "2 ? ? X | Z, S) G X(Z,S) : Suppose this does not hold. Then, there exists a path p 1 from X 0 2 X to L 0 2 L 2 active given Z, S in G X(Z,S) . Assume without loss of generality that X 0 is the variable in X closest to L 0 in the path p 1 . By definition of L 2 there is also a path p 2 from L 0 to some Y 0 2 Y that is active when Z is observed in G \\ X. Let p be the path between X 0 and Y 0 formed using edges from p 1 and p 2 and let W 0 be the closest variable to L 0 that lies in p, possibly L 0 itself.\n\u2022 The only variable in X that p contains is X 0 . This follows by the assumption that X 0 is the closest to L 0 in p 1 and the fact that p 2 cannot be active in G \\ X if it contains any variable in X. \u2022 L 0 has a descendant Z 0 2 Z by definition of L 2 \u2022 If W 0 is connected to L 0 by a path that starts with an edge going out from W 0 (i.e. W 0 ! \u2022 \u2022 \u2022 L 0 ), then W 0 has a descendant Z \u21e4 2 Z [ {S}: Either W 0 is ancestor of L 0 and, by extension, of Z 0 (i.e.\nW 0 ! \u2022 \u2022 \u2022 ! L 0 ! \u2022 \u2022 \u2022 ! Z 0 = Z \u21e4 ) or there is an active collider in Z [ {S} connecting W 0 and L 0 , such collider is descendant of W 0 (W 0 ! \u2022 \u2022 \u2022 ! Z 0 \u2022 \u2022 \u2022 L 0 ).\n\u2022 the path p is not causal. Suppose it is causal, then by the previous argument it has to be a proper one too. Consider the relationship between L 0 and W 0 .\n-If W 0 = L 0 . By definition of L 2 , L 0 has a descendant in Z which contradicts condition (a) because W 0 is assumed to be in a proper causal path.\n-If the path between W 0 and L 0 has an edge pointing into W 0 , then W 0 is a collider in p 1 implying that X 0 and L 0 are disconnected unless W 0 has a descendant in Z [ {S}. If the descendant is in Z it violates condition (a). If W 0 is an ancestor of S, let r 1 be the path between W 0 and Y 0 , which cannot contain any Z [ X by condition (a) and definition of proper causal path. Also let r 2 be the path between W 0 and S which does not contain any Z, and in particular, any Z T , Z S . Then, by claim 2 condition (c) is violated.\n-If the path between L 0 and W 0 has edges outgoing from W 0 , then Z \u21e4 2 Z [ S is a descendant of W 0 . And as in the previous argument either condition (a) or condition (c) is violated. \u2022 p needs to be blocked to satisfy condition (b), which is possible only if W 0 is an inactive collider that blocks the path.\nHowever, this is not the case:\n-If W 0 = L 0 , then W 0 is active because it is an ancestor of Z 0 .\n-If W 0 is a collider in p, consider if it is connected to L 0 with an incoming or outgoing edge: \u21e4 If the edge is incoming to W 0 , it is also a collider in p 1 and has to be active by assumption. \u21e4 If the edge is going out from W 0 , then W 0 is an ancestor of Z \u21e4 and is active. Therefore, p is active and a contradiction is reached.\nTheorem's proof Proof. (of Theorem 1). (If) Suppose the set Z = Z T [ Z M satisfies the conditions of the criterion relative to the pair X and Y in a given causal diagram G.\nUsing the independences just proved in lemma 1 we proceed with a derivation of the target causal effect ending with the proposed adjustment expression:\nWe start the derivation by conditioning on Z S nd , Z T nd and L 1 P (y | do(x))\n= X L1,Z T nd ,Z S nd P (y | do(x), l 1 , z T nd , z S nd )P (l 1 , z T nd , z S nd | do(x))(33)\nSince all the variables in the second term are non-descendants of X by definition, it holds that (L 1 , Z T nd , Z S nd ? ? X) G X and the third rule of the do-calculus can be applied to drop the do() operator\n= X L1,Z T nd ,Z S nd P (y | do(x), l 1 , z T nd , z S nd )P (l 1 , z T nd , z S nd )(35)\nWe can employ independence (19) from lemma 1, (Y ? ? \nZ T d , Z S d | L 1 , Z T nd , Z S nd , X) G X to\nUsing lemma 1-( 21), (Y ? ? S | Z T , Z S , X) G X , one can introduce the S variable into the first term\n= X Z T ,Z S P (y | do(x), z T , z S , S=1)P (z S | z T , S=1)P (z T ) (41) Conditioning on L 2 , Z X we get = X Z T ,Z S ,L2,Z X P (y | do(x), z T , z S , l 2 , z X , S=1)P (l 2 , z X | do(x), z T , z S , S=1)P (z S | z T , S=1)P (z T )(42)\nUsing the independence (L 2 ? ?\nX | Z T , Z S , S) G X(Z T ,Z S ,S)\nfrom the definition of L 2 , and (Z X ? ?\nX | Z T , Z S , S) G X(Z T ,Z S ,S)\nfrom the definition of Z X , we can remove the do() operator from the second factor by applying rule 3 of do-calculus 23), we can sum over Z Y in the second term, move the new to the left and add Z Y in the first term\n= X Z T ,Z S ,L2,Z X P (y | do(x), z T , z S , l 2 , z X , S=1)P (l 2 , z X | z T , z S , S=1)P (z S | z T , S=1)P (z T ) (43) By independence (Y ? ? Z Y | Z T , Z S , L 2 , Z X , X, S) G X from lemma 1-(\n= X Z,L2 P (y | do(x), z, l 2 , S=1)P (l 2 , z Y , z X | z S , z T , S=1)P (z S | z T , S=1)P (z T )(44)\nRearranging using the chain rule\n= X Z,L2 P (y | do(x), z, l 2 , S=1)P (l 2 | z Y , z X , z T , z S , S=1)P (z Y , z X , z S | z T , S=1)P (z T )(45)\nWe can introduce do(x) in the second term using the independence (L 2 ? ?\nX | Z, S) G X(Z,S) from lemma 1-(24). Also consid- ering that Z = Z Y [ Z X [ Z T [ Z S , we can rewrite as = X Z,L2 P (y | do(x), z, l 2 , S=1)P (l 2 | do(x), z, S=1)P (z Y , z X , z S | z T , S=1)P (z T )(46)\nThe first and second term can be combined using the chain rule. Then summing out L 2 :\n= X Z P (y | do(x), z, S=1)P (z Y , z X , z S | z T , S=1)P (z T ) (47) Renaming the sets Z Y [ Z X [ Z S as Z \\ Z T = X Z P (y | do(x), z, S=1)P (z \\ z T | z T , S=1)P (z T ) (48) X W 0 Z 1 W 1 \u2022 \u2022 \u2022 W k S W k+1 \u2022 \u2022 \u2022 W n 1 Z n W n Y 0\nFigure 4: Non-causal path between X and Y activated when S and Z is observed From condition (b) we have that (Y ? ? X | Z, S) G X , then the do() operator can be removed in the first term\n= X Z P (y | x, z, S=1)P (z \\ z T | z T , S=1)P (z T )(49)\nSince the adjustment holds in the magnified graph using only variables present in G, the same adjustment is admissible for the original model as well.\n(Only if) For this direction of the proof we will establish that if the adjustment is valid then the conditions must be satisfied. In order to do so, we prove the contrapositive statement, that is: failing to satisfy any of the conditions implies that the adjustment is not valid. First, let condition (b)' be a part of condition (b) that says that all non-causal paths must be blocked given Z (without S). Then, (b)' will correspond to the second condition in the adjustment criterion (Shpitser, VanderWeele, and Robins 2010). First, assume that conditions (a) or (b)' do not hold. Then, the adjustment formula itself will not always identify the causal effect P (y | do(x)). For instance, consider any model compatible with G S (which is also compatible with G). Then, the adjustment formula (17) reduces to adjustment without selection bias:\nX Z P (y | x, z, S=1) P z \\ z T | z T , S=1 P z T = X Z P (y | x, z) P (z) 6 = P (y | do(x))(50)\nThe last inequality follows by the adjustment criterion (Shpitser, VanderWeele, and Robins 2010), which implies that this expression will not always be equal to P (y | do(x)) whenever (a) or (b)' are not satisfied. Now suppose conditions (a) and (b)' are satisfied but condition (b) is not. Then, there exists a non-causal path p that is blocked given Z but is opened when S is observed. Path p must contain S as a collider and has the form X 0 \u2022 \u2022 \u2022 ! S \u2022 \u2022 \u2022 Y 0 where X 0 2 X and Y 0 2 Y. We need to find a model M compatible with a graph G that contains a path like p and show that the causal effect P (y | do(x)) is different from the adjustment expression (17). Consider a model compatible with the causal diagram depicted in figure 4.\nThe diagram evidences a non-causal path that is active when Z = {Z 1 , . . . Z n } and S are observed. The elements in Z may be assigned to Z T in any way. Since the variables in W = {W 0 , . . . , W n } do not have any parents we can parametrize their distributions directly when constructing M. If we let every variable in Z [ S behave as an xor of its parents, P (W i =1) = 1 2 \u270f, i = {1, . . . , n}, where epsilon is a real constant, and P (x) = P (w 0 ), P (y) = P (w n ) we obtain that:\nP (Y =1 | do(X=1)) = P (Y =1) = 1 2 \u270f X Z P (Y =1 | X=1, z, S=1)P (z \\ z T | S=1)P (z T ) = 1 2 (\u270f 2 2\u270f + 2)\nFor any \u270f 2 (1, 2) we have that the two quantities above are different (figure 5).\nThen this is an M where the effect is not identifiable by the adjustment expression, because condition (b)' is not satisfied, impliying its necessity. If the path between any W i and Z j for any 0 6 i 6 n, 1 6 j 6 n, i 6 = j has more variables in between we can make any variable be equal to its parent. Similarly, if Z j is actually a descendant of a collider Q j in the path, we can make every variable in the path to take the value of its parent, including Z j . With those adjustments the model induces exactly the same distribution. If X or Y are parents of W 0 or W n respectively the model is in the same equivalence class that the one presented and the conclusion holds.\nContinuing with the remaining condition, assume that (a) and (b) are satisfied but condition (c) is not. Then, there exists a path p between S and some Y 0 2 Y that is active in the graph G pbd non-causal. Then, the adjustment expression for any model in that family can be reduced as follows:\nX Z P (y | x, z, S=1)P (z \\ z T | S=1)P (z T ) (51) = X Z P (y | z, S=1)P (z \\ z T | S=1)P (z T ) (52) = X Z T P (y | z T , S=1)P (z T )(53)\nEquation ( 52) follows because of the independence (X ? ?\nY | Z, S) G pbd XY .\nThe final expression is reached by combining the first two factors and summing out the variables in Z \\ Z T . Since G pbd XY has no causal paths between X and Y, the effect P (y | do(x)) = P (y). Also consider the effect P (y | do(s)), which is always equals to P (y). Consider the adjustment criterion relative to the pair (S, Y) in G pbd XY , note that Z T is not admissible since there is a non-causal path p that goes from S to Y. Therefore, by the completeness of the adjustment criterion (Shpitser, VanderWeele, and Robins 2010), there exists a model M compatible with G pbd XY where\nP (y | do(s)) 6 = X Z T P (y | s, z T )P (z T )(54)\nThe right hand side of eq. (54) includes eq. (53). We have then:\nP (y | do(x)) = P (y) = P (y | do(s)) 6 = X\nZ T P (y | s, z T )P (z T )(55)\nWhich proves that the adjustment expression does not rely the causal effect of interest in the model M, which is also compatible with G.\nCorollary 2 (Causal Effects Recovery by Adjustment). Let G be a causal diagram augmented with a variable S representing the selection mechanism. Let V be the set of variables measured under selection bias, and T \u21e2 V the set of variables measured externally in the overall population. Consider disjoint sets of variables X, Y \u2713 V, then the causal effect P (y | do(x)) is recoverable from {P (v | S=1), P (t)} by the adjustment expression (17) while Z T \u2713 T, in every model inducing G if and only if Z, Z T is an admissible pair relative to X, Y in G according to Definition 8.\nProof. If Z, Z T is an admissible pair for X, Y in G then Theorem 1 ensures that P (y | do(x)) is equal to expression (17).\nSince P (y | x, z, S=1), P z \\ z T | S=1 can be obtained from P (v | S=1), and P z T from P (t), the expression can be computed from the input. On the other hand, if P (y | do(x)) is recoverable by the adjustment expression (17), by Theorem 1, Z, Z T is an admissible pair.\nProposition 1. If Z T = ;, then GACT 1 () GACT 3.\nProof. For the right direction of the implication we have that conditions (a), (b) from the two criteria are identical. Then, we need to show that conditions (c) and (d) in Type 1 imply condition (c) in Type 3. Starting from condition (c):\n(Y ? ? S | X) G X^8 X2X\\An(S) (X ? ? Y) \nStatement ( 57) follows from ( 56) because the change in graph may only remove edges which could only increase the number of independences. Next, X can be safely removed from (58) because for any path previously blocked by X, it contains a portion from some X 0 2 X to some Y 0 2 Y that should be either causal or non-causal. If it is causal then the edge outgoing from X 0 is not present in the graph anyway, and if it is not causal it must have a collider before reaching Y 0 but since nothing is observed, such collider is inactive. Finally, (59) adds edges incoming to variables in X. This could create new paths with two structures S \u2022 \u2022 \u2022 ! X 0\n\u2022 \u2022 \u2022 Y 0 and S \u2022 \u2022 \u2022 X 0 \u2022 \u2022 \u2022 Y 0 where X 0 2 X and Y 0 2 Y. The first kind of paths are always closed without any variable being observed and the second kind are open only if X 0 2 An (S). But by condition (d) any path between such X 0 2 An (S) and Y with the second structure must be closed.\nFor the left direction we already established that conditions (a) and (b) are identical in both criteria. Next, from condition (c) in Type 3 we derive condition (c) in Type 1: 61) follows because removing edges preserves all independences. Observing X in (62) will not produce new colliders in the graph therefore no new active paths. Finally, edges added back in the graph for (62) are blocked by the observed set X.\n(Y ? ? S) G pbd XY (60) =)(Y ? ? S) G pbd XY X (61) =)(Y ? ? S | X) G pbd XY X (62) =)(Y ? ? S | X) G X (63) Statement (\nAll that is left is to show that condition (c) in Type 3 implies condition (d) in Type 1. To do this, we will prove the contrapositive statement, that is: 9 X 0 2X\\An(S),Y 0 2Y,p st. p is a path that connects X 0 to Y 0 in G X =) (Y ? 6 ? S)\nG pbd XY (64\n)\nThe implication holds because path p exists in the graph G pbd XY .\nProposition 2. If Z T = Z, then GACT 2 () GACT 3. Proof. Condition (a) from the two criteria is identical.\nTo complete the forward direction we will show (1) that condition (b), (c) in Type 2 imply condition (b) in Type 3. And, (2) that condition (c) in Type 1 implies condition (c) in Type 3:\n(1) Assuming that condition (b) holds in Type 2, the same condition in Type 3 may fail if there exists a path p from some X 0 2 X to some Y 0 2 Y that is closed given Z but open given Z, S. However, the subpath q covering the portion of p from S to Y 0 contradicts condition (c) in Type 2 unless q contains some X 00 2 X, but in this case the portion of p between X 00 and Y \u2022 With edges incoming to X \u2022 With edges outgoing from X that do not belong to a proper causal path In both cases the new paths are non-causal and must be blocked by Z.\nFor the left direction, first note that condition (b) implies condition conditions (b) in Type 2 because not observing S could only close paths. Second, we will show that (c) in Type 3 imply condition (c) in Type 2: \nEq. (69) follows because removing incoming edges to X never introduces dependencies. Provided that no variable in X has incoming edges, introducing X to the set of observed variables may never compromise a previously established independence hence ( 70) follows. Next, comparing the graphs G X and G pbd XY X we can see that the former could possibly have edges that are not in the second. Those edges are those that have tails in X and do not belong to a proper causal path. Since X is being observed in the independence any new path including those edges is always block, therefore independence ( 71) is implied. Finally, when the edges incoming to X are added in (72), any new S Y path using one of those edges is non-causal and must be blocked by Z (since S cannot block it).\nFirst we rewrite the adjustment expression (17) as follows: ", "publication_ref": ["b28", "b28", "b28"], "figure_ref": ["fig_2", "fig_2", "fig_9"], "table_ref": []}, {"heading": "Acknowledgments", "text": "This research was supported in parts by grants from NSF [IIS-1704352]  and DARPA [ARO W911NF-16-1-0579].", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "", "text": "Finding Admissible Sets for Generalized Adjustment Definition 9 (Generalized Adjustment Criterion Type 3 (Alternative) GACT 3A). Given a causal diagram G augmented with selection variable S, disjoint sets of variables X, Y, Z and a set Z T \u2713 Z; Z, Z T is an admissible pair relative to X, Y in G if:\nProposition 3. Definition 9 is equivalent to Definition 8. Proof. Condition (c) is exactly the same in both definitions. Similarly, definition 8-(a) says that Z should not contain any variable in Dpcp(X, Y) which is exactly the set of nodes forbidden in definition 9-(a). Then, both conditions are equivalent.\nTo prove definition 9 =) definition 8 it is left to show that definition 9(a),(b),(c) imply definition 8(b). Definition 9(b) ensures that all non-causal paths from X to Y in G pbd XY are blocked. Assume for the sake of contradiction that there exists a non-causal path p absent from G pbd XY and present in G. Any such path has to contain some edge going out from some X 0 2 X that belongs to a proper causal path q. Without loss of generality assume that X 0 is the only variable in p that belongs to X, otherwise restart the argument with that variable instead of X 0 . Let W be the variable at the other end of the missing edge and let Y 0 2 Y be the variable at the end of q. Similarly, let Y 00 2 Y be the variable at the end of p.\nClearly, p should not be directed from X 0 to some Y 00 because it is not causal. Consequently, there exists some collider in p before reaching Y 00 . By definition 9(a) that collider is not in Z because it is a descendant of W which is in a proper causal path by assumption. Then, the collider has to be S, but this implies that there is a path r that goes from S to Y 0 passing through W that do not contain any Z and exists in G pbd XY , a contradiction to definition 9(c). Hence, p cannot exists and the conclusion follows.\nTo finish the other direction (definition 8 =) definition 9) we observe that all paths in G pbd XY are non-causal and definition 8(b) ensures that all of them are closed.\nProposition 4 (Correctness of LISTSEPC). Given a graph G, a variable S, sets of variables Y, I, R, Z, where {S}, Y, Z are disjoint and I \u2713 R \u2713 Z; LISTSEPC outputs all pairs Z, Z T , where Z T 2 Z G ({S},Y) hI,Ri. Proof. Consider the recursion tree associated with LISTSEPC. We want to show that when a node is visited with I 0 , R 0 it will output Z, Z T where Z T 2 Z G ({S},Y) hI 0 ,R 0 i by structural induction: \u2022 Base case: Pick any particular leaf of the tree. The recursion stops when I = R, then I 0 = R 0 . The family associated with a leaf is Z G ({S},Y) hI 0 ,I 0 i which may contain I 0 if it is a valid separator, or be empty. Indeed the algorithm will output (Z, I 0 ) if and only if condition in line 18 is true, which implies that I 0 is a separator in G.\nAlgorithm 1 Routines used to list admissible pairs 1: function LISTADJPAIRS(G, X, Y, S, V, T)\nLISTSEPAB(G pbd XY , X, Y, S, {S}, R, T) 5: end function 6: function LISTSEPAB(G, X, Y, S, I, R, T) end if 27: end function \u2022 Inductive step: Pick a particular non-leaf node and assume the statement holds for its two children. The family for the node is Z G ({S},Y) hI 0 ,R 0 i which can be expressed as two families Z G ({S},Y) hI 0 [ {V },R 0 i [ Z G ({S},Y) hI 0 ,R 0 \\ {V }i which are clearly disjoint, because in the first family every set contains V while in the second none of them does. By assumption the children output exactly the sets in those families. If condition in line 18 returns ? it means that there is no separator C such that I 0 \u2713 C \u2713 R 0 hence the branch can be aborted and the output will be empty. If the condition does not fail, each children outputs its family pairs, satisfying the statement.\nProposition 5 (Correctness of LISTSEPAB). Given a graph G, a variable S, sets of variables X, Y, I, R, T, where X, Y, {S}, R are disjoint, I\u2713R and T\u2713C; LISTSEPAB outputs all pairs in\nProof. Consider the recursion tree associated with LISTSEPAB. Similar to the proof for proposition 4, we want to show that when a node is visited; it will output the stated set of pairs with I = I 0 , R = R 0 where I 0 and R 0 are the particular values for that node, then by structural induction:\n\u2022 Base case: Pick any particular leaf of the tree. The recursion stops when I = R, then I 0 = R 0 . The family associated with a leaf is Z G (X,Y) hI 0 ,I 0 i which may contain I 0 if it is a valid separator, or be empty. The function will provide any output if and only if condition in line 7 is true, which implies that I 0 is a separator in G. If I 0 a separator, LISTSEPC(G, S, Y, ;, I 0 \\ T, I 0 ) is called, and by proposition 4 its output will satisfy the claim.\n\u2022 Inductive step: Consider any non-leaf node and assume the statement holds for its two children. The family for the node is Z G (X,Y) hI 0 ,R 0 i which can be expressed as two disjoint families Z\nBy the inductive assumption the children output each of those families. If condition in line 7 succeeds the recursive calls are performed and the parent node will output the union of the children's output, satisfying the statement. The condition may fail for any of two reasons:\n(1) The family Z G (X,Y) hI 0 ,R 0 i is empty, in which case the branch can be aborted because it will produce no output.\n(2) The family Z G ({S},Y) h;,R 0 \\ Ti is empty, then regardless of any set Z \u21e2 R 0 that is found there is no set Z T \u21e2 R 0 \\T that will form a valid pair for Z. As a consequence, the branch can be aborted and the output will be empty for the node, which is consistent with the statement.\nTheorem 3 (Correctness of LISTADJPAIRS). Given a graph G, disjoint sets X, Y, T, and a selection variable S, LISTADJPAIRS outputs all admissible pairs Z, Z T relative to X, Y in G such that Z T \u2713 T.\nProof. Follows by the fact that LISTADJPAIRS calls LISTSEPAB \u21e3 G pbd XY , X, Y, S, {S}, R, T \u2318 that by proposition 5 will output pairs in Z a,b,c .\nProposition 6 (Complexity of LISTSEPAB). LISTSEPAB works with O(n(n + m)) delay.\nProof. Consider the recursion tree for LISTSEPAB. Every time a node in the tree is visited there two calls to FINDSEP which can be implemented in O(n + m) time (van der Zander, Liskiewicz, and Textor 2014). If FINDSEP fails (outputs ?) in any of the two calls, the branch is aborted because either it will not generate any set in Z a,b or there is no set Z T in Z c that is a subset of R \\ T, hence no pair generated will be in Z a,b,c . In order to produce an output is produced a leaf of the tree for LISTSEPAB has to be reached, that is when I = R and since in every level the set R \\ I reduces by one, the depth of that tree is at most n. At that point a call to FINDSEPC is performed. Similarly, this function produces an output when a leaf in its recursion tree is visited. By the same argument as before, the depth of a leaf is at most n. Then, the time required to produce an output is O(2n(n + m)) = O(n(n + m)). Because of condition in line 7 any branch that does not produce a valid pair is immediately aborted. In the worst case, there could be n aborted branches in the tree for LISTSEPAB and n aborted branches in the one for LISTSEPC; before reaching the first pair. Then the time to get the first solution or fail is at most O(n(n + m)). Therefore, the delay is O(n(n + m)).\nFurthermore, every pair is produced only once, because at any node in both recursive functions the output for the children are disjoint.\nTheorem 4 (Complexity of LISTADJPAIRS). LISTADJPAIRS outputs all admissible pairs such that Z T \u2713 T with O(n(n+m)) polynomial delay.\nProof. First note that Dpcp(X, Y) can be computed in O(n + m) time and O(n) space since it consists of finding sets of ancestors and descendant which can be done by traversing the graph a constant number of times. A list of ancestors or descendants uses at most O(n) space.\nThe graph G pbd XY can be computed from G in O(n + m) time and space. To do this we first compute Dpcp(X, Y) and then remove from G any edge of the from X 0 ! W 0 where X 0 2 X and W 0 2 Dpcp(X, Y).\nThe function LISTSEPAB is called to find sets in the family Z a,b,c , which, by Proposition 6, will take O(n(n + m)) time between the outputs of consecutive pairs. The time required for the initial pair output (including constructing the set Dpcp, G pbd XY ) is overall O(n(n + m)) which means that the algorithm works with that delay.\nLemma 2 (Ancestral Path Separator). Let G be a causal diagram, and let X, Y, Z and W be disjoint sets of variables in G. Let p be a path (not necessarily directed) with some X 0 2 X and Y 0 2 Y as endpoints that is blocked (in the d-separation sense) when Z is observed. Let Z\ne. the variables in Z that are ancestors any node in X[Y [W. Then p is also blocked when Z\nA is observed. Proof. Assume for the sake of contradiction that p is active when Z\nA is observed. This implies that there exists Z 0 2 Z \\ Z\nA that is needed to block p. For a variable Z 0 to block a path, at least one of the arrows in that path must be going out of Z 0 (i.e. Z 0 is not descendant of a collider in p). If we follow p starting at Z 0 in the direction of one of the outgoing arrows, there should be a collider before reaching X 0 (or Y 0 depending where the outgoing arrows is heading to in p), otherwise Z 0 would be an ancestor of X 0 (Y) which is not the case by the definition of Z 0 . For p to be open, this collider must belong to Z A , but, since Z 0 is an ancestor of the collider Z 0 is also an ancestor of X [ Y [ W, contradicting its definition. Moreover, Z 0 cannot exists, neither p, and a contradiction is reached.\nLemma 3 (Ancestral Separator Set). Let G be a causal diagram, and let X, Y, Z and W be disjoint sets of variables in G.\nholds if and only if every path p with some X 0 2 X and Y 0 2 Y as endpoints, is blocked by Z, by virtue of Theorem 2, all such paths are also blocked by Z A , implying (X ? ? Y | Z A ).\nProposition 7. Suppose a pair Z, Z T is admissible relative to X, Y in G. Then, the pair Z A , Z T A , where ), is also admissible.\nProof. Lets verify that Z A satisfies each one of the four conditions of the criterion. (a) Since Z\nA is a subset of Z all its elements must satisfy this condition too. (b) Any path between X and Y blocked by Z, and in particular the non-causal ones, are also blocked by Z\nA by virtue of lemma 2. If S is a descendant of a collider in some non-causal path p, it must be the case that Z blocks the subpath from between X and S or between S and Y. Then again, by lemma 2, the set Z A block the same subpath. Therefore, the overall path is blocked too. (c) By lemma 3 (Y ? ?\nSince all conditions hold, the criterion holds overall.\nLemma 4 ((van der Zander, Liskiewicz, and Textor 2014)). Let X, Y, I, R be sets of nodes with I \u2713 R, R \\ (X [ Y) = ;. If there exists an separator Z 0 for X, Y, with\nTheorem 5 (Explicit admissible set construction). There exists an admissible pair in a causal diagram G relative to disjoint sets of variables X, Y if and only if the pair Z, Z T is admissible, where\nProof. This is easy to show using lemma 4. Suppose there exists some admissible pair Z 0 , Z T 0 . Theorem 1 implies that the pair must satisfy the conditions in definition 9. Furthermore, assume that Z T 0 \u2713 T so that the adjustment is estimable from the assumed input. Then: ", "publication_ref": [], "figure_ref": [], "table_ref": []}], "references": [{"ref_id": "b0", "title": "Conditional independence in sample selection models", "journal": "Economics Letters", "year": "1997", "authors": "J D Angrist"}, {"ref_id": "b1", "title": "Causal Inference by Surrogate Experiments: z-Identifiability", "journal": "AUAI Press", "year": "2012", "authors": "E Bareinboim; J Pearl"}, {"ref_id": "b2", "title": "Controlling Selection Bias in Causal Inference", "journal": "", "year": "2012", "authors": "E Bareinboim; J Pearl"}, {"ref_id": "b3", "title": "Causal inference and the data-fusion problem", "journal": "Proceedings of the National Academy of Sciences", "year": "2016", "authors": "E Bareinboim; J Pearl"}, {"ref_id": "b4", "title": "Recovering from Selection Bias in Causal and Statistical Inference", "journal": "AAAI Press", "year": "2014", "authors": "E Bareinboim; J Tian; J Pearl"}, {"ref_id": "b5", "title": "Generalizing evidence from randomized clinical trials to target populations: The ACTG 320 trial", "journal": "American Journal of Epidemiology", "year": "2010", "authors": "S R Cole; E A Stuart"}, {"ref_id": "b6", "title": "Causal Discovery from Data in the Presence of Selection Bias", "journal": "", "year": "1995", "authors": "G Cooper"}, {"ref_id": "b7", "title": "Causal Effect Identification by Adjustment under Confounding and Selection Biases", "journal": "", "year": "2017", "authors": "J D Correa; E Bareinboim"}, {"ref_id": "b8", "title": "Adjustment under confounding and selection bias", "journal": "", "year": "2017", "authors": "J D Correa; J Tian; E Bareinboim"}, {"ref_id": "b9", "title": "Sample Selection Bias Correction Theory", "journal": "", "year": "2008", "authors": "C Cortes; M Mohri; M Riley; A Rostamizadeh"}, {"ref_id": "b10", "title": "The foundations of cost-sensitive learning", "journal": "", "year": "2001", "authors": "C Elkan"}, {"ref_id": "b11", "title": "Recovering from selection bias using marginal structure in discrete models", "journal": "", "year": "2015", "authors": "R J Evans; V Didelez"}, {"ref_id": "b12", "title": "Causal Diagrams", "journal": "", "year": "2008", "authors": "M M Glymour; S Greenland"}, {"ref_id": "b13", "title": "Sample Selection Bias as a Specification Error", "journal": "Econometrica", "year": "1979", "authors": "J J Heckman"}, {"ref_id": "b14", "title": "Pearl's Calculus of Intervention Is Complete", "journal": "AUAI Press", "year": "2006", "authors": "Y Huang; M Valtorta"}, {"ref_id": "b15", "title": "On recovering a population covariance matrix in the presence of selection bias", "journal": "Biometrika", "year": "2006", "authors": "M Kuroki; Z Cai"}, {"ref_id": "b16", "title": "Statistical analysis with missing data", "journal": "Wiley & Sons, Inc", "year": "1987", "authors": "R Little; Rubin ; D "}, {"ref_id": "b17", "title": "Stratification and weighting via the propensity score in estimation of causal treatment effects: a comparative study", "journal": "Stat Med", "year": "2004", "authors": "J K Lunceford; M Davidian"}, {"ref_id": "b18", "title": "The covariate's dilemma", "journal": "PLoS Genet", "year": "2012", "authors": "J Mefford; J S Witte"}, {"ref_id": "b19", "title": "Confounding equivalence in causal equivalence", "journal": "AUAI Press", "year": "2010", "authors": "J Pearl; Paz ; A "}, {"ref_id": "b20", "title": "Causal inference in statistics: A Primer", "journal": "John Wiley & Sons", "year": "2016", "authors": "J Pearl; M Glymour; N P Jewell"}, {"ref_id": "b21", "title": "Aspects of graphical models connected with causality", "journal": "", "year": "1993-08", "authors": "J Pearl"}, {"ref_id": "b22", "title": "Causal diagrams for empirical research", "journal": "Biometrika", "year": "1995", "authors": "J Pearl"}, {"ref_id": "b23", "title": "Causality: models, reasoning, and inference", "journal": "Cambridge University Press", "year": "2000", "authors": "J Pearl"}, {"ref_id": "b24", "title": "Including known covariates can reduce power to detect genetic effects in case-control studies", "journal": "Nature Genetics", "year": "2012", "authors": "M Pirinen; P Donnelly; C C A Spencer"}, {"ref_id": "b25", "title": "Data, Design, and Background Knowledge in Etiologic Inference", "journal": "Epidemiology", "year": "2001", "authors": "J M Robins"}, {"ref_id": "b26", "title": "Some Surprising Results about Covariate Adjustment in Logistic Regression Models", "journal": "International Statistical Review / Revue Internationale de Statistique", "year": "1991", "authors": "L D Robinson; N P Jewell"}, {"ref_id": "b27", "title": "Identification of Joint Interventional Distributions in Recursive semi-Markovian Causal Models", "journal": "", "year": "2006", "authors": "I Shpitser; J Pearl"}, {"ref_id": "b28", "title": "On the validity of covariate adjustment for estimating causal effects", "journal": "", "year": "2010", "authors": "I Shpitser; T J Vanderweele; J M Robins"}, {"ref_id": "b29", "title": "Causation, Prediction, and Search", "journal": "MIT Press", "year": "2001", "authors": "P Spirtes; C N Glymour; R Scheines"}, {"ref_id": "b30", "title": "Space-optimal, backtracking algorithms to list the minimal vertex separators of a graph", "journal": "Discrete Applied Mathematics", "year": "2010", "authors": "K Takata"}, {"ref_id": "b31", "title": "Constructing separators and adjustment sets in ancestral graphs", "journal": "AAAI Press", "year": "2002", "authors": "J Tian; J Pearl; B Van Der Zander; M Liskiewicz; J Textor"}, {"ref_id": "b32", "title": "Collapsibility of multidimensional contingency tables", "journal": "Journal of the Royal Statistical Society. Series B", "year": "1978", "authors": "A Whittemore"}, {"ref_id": "b33", "title": "Learning and evaluating classifiers under sample selection bias", "journal": "", "year": "2004", "authors": "B Zadrozny"}], "figures": [{"figure_label": "2", "figure_type": "figure", "figure_id": "fig_0", "figure_caption": "Figure 2 :2Figure 2: Instance of adjustment with partial external data.", "figure_data": ""}, {"figure_label": "", "figure_type": "figure", "figure_id": "fig_1", "figure_caption": "(b) All non-causal paths in G from X to Y are blocked by Z and S. (c) Z T d-separates Y from S in the proper backdoor graph, i.e. Y ? ? S | Z T G pbd XY .", "figure_data": ""}, {"figure_label": "4", "figure_type": "figure", "figure_id": "fig_2", "figure_caption": "Figure 4 :4Figure 4: Simple diagram where the number of different separators is exponential in the size of the graph", "figure_data": ""}, {"figure_label": "6", "figure_type": "figure", "figure_id": "fig_3", "figure_caption": "Proposition 6 (6Complexity of LISTSEPAB). LISTSEPAB works with O(n(n + m)) delay. Theorem 4 (Complexity of LISTADJPAIRS). LISTADJ-PAIRS outputs all admissible pairs such that Z T \u2713 T with O(n(n + m)) polynomial delay.", "figure_data": ""}, {"figure_label": "1", "figure_type": "figure", "figure_id": "fig_4", "figure_caption": "Algorithm 11Routines used to list admissible pairs 1: function LISTADJPAIRS(G, X, Y, S, V, T) 2:", "figure_data": ""}, {"figure_label": "", "figure_type": "figure", "figure_id": "fig_5", "figure_caption": ", X, Y, I, R) 6 =?F INDSEP(G, {S}, Y, ;, R \\ T) 6 =? then 8: if I = R then 9: LISTSEPC(G, S, Y, ;, I \\ T, I \\ {S}) 10: else 11: V arbitrary variable from R \\ I 12: LISTSEPAB(G, X, Y, I [ {V }, R, T) 13: LISTSEPAB(G, X, Y, I, R \\ {V }, T) function 17: function LISTSEPC(G, S, Y, I, R, Z) 18: if FINDSEP(G, {S}, Y, I, R) 6 =? then , X, Y, I [ {V }, R, Z) 24: LISTSEPC(G, X, Y, I, R \\ {V }, Z)", "figure_data": ""}, {"figure_label": "3", "figure_type": "figure", "figure_id": "fig_6", "figure_caption": "Figure 3 :3Figure 3: Instance of adjustment with partial external data.", "figure_data": ""}, {"figure_label": "", "figure_type": "figure", "figure_id": "fig_7", "figure_caption": "by definition, then it belongs to a proper causal path and contradicts cond. (a) (b)", "figure_data": ""}, {"figure_label": "", "figure_type": "figure", "figure_id": "fig_8", "figure_caption": "PPPPintroduce the variables Z T d , Z S d in the first term, after summing over the same variables in the second term(y | do(x), l 1 , z T , z S )P (l 1 , z T , z S )(36)Applying the chain rule on the second term yields= X L1,Z T ,Z S P (y | do(x), l 1 , z T , z S )P (l 1 | z T , z S )P (z T | z S )P (z T )(37)By definition of Z S , (Z S ? ? S | Z T ), allowing us to introduce the S variable into the third factor (y | do(x), l 1 , z T , z S )P (l1 | z T , z S )P (z S | z T , S=1)P (z T ) (38)From lemma 1-(22), we use (L 1 ? ?X | Z T , Z S ) G X(Z T ,Z S )to introduce the do() operator into the second factor (y | do(x), l 1 , z T , z S )P (l1 | do(x), z T , z S )P (z S | z T , S=1)P (z T )(39)Using the chain rule to combine the first and second factors. Sum out L (y | do(x), z T , z S )P (z S | z T , S=1)P (z T )", "figure_data": ""}, {"figure_label": "5", "figure_type": "figure", "figure_id": "fig_9", "figure_caption": "Figure 5 :5Figure 5: Causal effect vs Adjustment expression for model M", "figure_data": ""}, {"figure_label": "", "figure_type": "figure", "figure_id": "fig_10", "figure_caption": "0 contradicts condition (b) in Type 2. Consequently, (b) must hold. (2) Starting from condition (c): (Y ? ? S | X, Z)^All non-causal paths blocked by Z, S (65) =)(Y ? ? S | X, Z) follows from (65) because the change in graph may only remove edges which keep all existent independences. Next, removing X from (66) to obtain (67) may open two kinds of S Y paths:", "figure_data": ""}, {"figure_label": "", "figure_type": "figure", "figure_id": "fig_11", "figure_caption": "Y ? ? S | Z, X) G X^A ll non-causal paths blocked by Z, S(71)=)(Y ? ? S | Z, X)", "figure_data": ""}, {"figure_label": "", "figure_type": "figure", "figure_id": "fig_12", "figure_caption": "PI(y | do(x)) = X Z P (y | x, z, S=1)P (z \\ z T | z T , S=1)P (z T ) x, z | S=1) P (x, z | S=1) P (z \\ z T | z T , S=1)P (z T ) x, z | S=1)P (z \\ z T | z T , S=1)P (z T ) P (x | z, S=1)P (z | S=1) x, z | S=1)P (z \\ z T | z T , S=1)P (z T ) P (x | z, S=1)P (z \\ z T | z T , S=1)P (z T | S=1) yw 0 (x, z)w S (z T )P (y, x, z | S=1) X=x yw 0 (x, z)w S (z T )P (y, x, z | S=1) (85) = E[w 0 w S I X=x Y | S=1].", "figure_data": ""}], "formulas": [{"formula_id": "formula_0", "formula_text": "X Y Z (a) X Y Z (b) X Y Z S (c) X Y Z 1 Z 2 S (d)", "formula_coordinates": [2.0, 343.44, 57.63, 196.8, 102.15]}, {"formula_id": "formula_1", "formula_text": "U i [ PA i to V i , U i \u2713 U , PA i \u2713 V \\V i ,", "formula_coordinates": [2.0, 331.21, 639.85, 167.44, 17.04]}, {"formula_id": "formula_2", "formula_text": "P (y | do(x)) = X Z P (y | x, z)P (z).(1)", "formula_coordinates": [3.0, 100.05, 319.7, 192.45, 17.13]}, {"formula_id": "formula_3", "formula_text": "(c) Y is d-separated from S given X under the intervention do(x), i.e., (Y ? ? S | X) G X . (d) Every X 2 X is either a non-ancestor of S or it is in- dependent of Y in G X , i.e., 8 X2X\\An(S) (X ? ? Y) G X", "formula_coordinates": [3.0, 321.72, 544.35, 236.4, 55.34]}, {"formula_id": "formula_4", "formula_text": "P (y | do(x)) = X Z P (y | x, z, S=1)P (z | S=1), (2)", "formula_coordinates": [4.0, 76.23, 82.65, 216.26, 17.13]}, {"formula_id": "formula_5", "formula_text": "P (y | do(x)) = X Z P (y | x, z, S=1)P (z).", "formula_coordinates": [4.0, 89.04, 118.16, 168.3, 17.13]}, {"formula_id": "formula_6", "formula_text": "P (y|do(x)) = X Z P (y|x, z, S=1)P (z1|z2, S=1)P (z2) (4)", "formula_coordinates": [4.0, 64.48, 445.74, 228.01, 20.57]}, {"formula_id": "formula_7", "formula_text": "P (y|do(x))= X Z P (y|x,z,S=1)P (z1,z3|z2,S=1)P (z2) (5)", "formula_coordinates": [4.0, 62.7, 547.12, 229.79, 20.57]}, {"formula_id": "formula_8", "formula_text": "X 1 X 2 Y Z 1 Z 2 Z 3 S", "formula_coordinates": [4.0, 382.01, 92.27, 107.29, 50.04]}, {"formula_id": "formula_9", "formula_text": "P (y|do(x)) = X Z P (y|x,z,S=1)P (z\\z T |z T ,S=1)P (z T )(6)", "formula_coordinates": [4.0, 328.22, 217.13, 229.9, 30.56]}, {"formula_id": "formula_10", "formula_text": "Proposition 1. If Z T = ;, then GACT1 () GACT3. Proposition 2. If Z T = Z, then GACT2 () GACT3.", "formula_coordinates": [5.0, 53.88, 204.66, 217.41, 37.28]}, {"formula_id": "formula_11", "formula_text": "Z T \u2713 Z; Z, Z T is an admissible pair relative to X, Y in G if: (a) Z \\ Dpcp(X, Y) = ; (b) (Y ? ? X | Z, S) G pbd XY (c) (Y ? ? S | Z T ) G pbd XY where Dpcp(X,Y) = De (De(X) G X \\ X) \\ An(Y) G X .", "formula_coordinates": [5.0, 53.88, 618.22, 238.61, 93.5]}, {"formula_id": "formula_12", "formula_text": "ZG (X,Y) hI,Ri := {Z | (X? ?Y|Z)G and I\u2713Z\u2713R} (7)", "formula_coordinates": [5.0, 333.01, 215.01, 225.11, 16.88]}, {"formula_id": "formula_13", "formula_text": "C = V \\ (X [ Y [ Dpcp(X,Y))(8)", "formula_coordinates": [5.0, 375.87, 287.76, 182.25, 15.23]}, {"formula_id": "formula_14", "formula_text": "Z a,b = n Z Z [ {S}2Z G pbd XY (X,Y) h{S},C [ {S}i o (9)", "formula_coordinates": [5.0, 333.16, 332.7, 224.96, 18.55]}, {"formula_id": "formula_15", "formula_text": "Zc = Z G pbd XY ({S},Y) h;,Ti .(10)", "formula_coordinates": [5.0, 383.09, 414.41, 175.02, 15.23]}, {"formula_id": "formula_16", "formula_text": "Z a,b,c = n\u21e3 Z, Z T \u2318 2 Z a,b \u21e5 Zc Z T \u2713 Z o (11)", "formula_coordinates": [5.0, 352.15, 453.12, 205.97, 18.55]}, {"formula_id": "formula_17", "formula_text": "T = V \\ (X [ Y))", "formula_coordinates": [5.0, 475.13, 540.96, 82.99, 16.43]}, {"formula_id": "formula_18", "formula_text": "Z T 2 Z G ({S},Y) hI,Ri. Criterion Input Adjustment Expression Biased Data Unbiased Data GACT1 {P (v | S=1)} P Z P (y | x, z, S=1) P (z | S=1) GACT2 {P (v | S=1), P (t)} P Z P (y | x, z, S=1) P (z) GACT3 {P (v | S=1), P (t)} P Z P (y | x, z, S=1) P z \\ z T | z T , S=1 P z T Figure 3: Comparison of the Adjustment Types X Y V 11 V 12 V 21 V 22 . . . . . . V`1 V`2 S", "formula_coordinates": [5.0, 421.21, 694.84, 106.21, 16.88]}, {"formula_id": "formula_19", "formula_text": "Z, Z T 2 ZG (X,Y) hI,Ri \u21e5 ZG ({S},Y) h;,Ti Z T \u2713Z .", "formula_coordinates": [6.0, 63.48, 348.27, 226.59, 16.88]}, {"formula_id": "formula_20", "formula_text": "3: R (V [ {S}) \\ (X [ Y [ Dpcp(X, Y)) 4:", "formula_coordinates": [6.0, 324.49, 208.21, 204.47, 22.5]}, {"formula_id": "formula_21", "formula_text": "Z T A =Z T \\An(X[Y[{S}) and Z A =Z\\An(X[Y[{S}), is also admissible.", "formula_coordinates": [6.0, 319.51, 611.05, 238.61, 22.86]}, {"formula_id": "formula_22", "formula_text": "Z = An(X [ Y [ {S}) G pbd XY \\ C (12) Z T = (An({S} [ Y) G pbd XY \\ T) \\ C (13)", "formula_coordinates": [7.0, 104.37, 74.23, 188.13, 33.55]}, {"formula_id": "formula_23", "formula_text": "\u00b5 = E[Y | do(x)]. Given observed i.i.d. data {(X i , Y i , Z i )} n i=1 , the IPW estimator for \u00b5 is given b\u0177 \u00b5 IPW = 1 n n X i=1 wiI X i =x Yi (14", "formula_coordinates": [7.0, 53.88, 406.69, 347.31, 54.8]}, {"formula_id": "formula_24", "formula_text": ")", "formula_coordinates": [7.0, 288.76, 443.54, 3.74, 8.59]}, {"formula_id": "formula_25", "formula_text": "i | Z i ), andP (X i | Z i )", "formula_coordinates": [7.0, 53.88, 471.68, 238.61, 29.36]}, {"formula_id": "formula_26", "formula_text": "P (y|do(x)) = X Z P (y|x, z, S=1)P (z \\ z T |z T , S=1)P (z T ) = X Z P (y, x, z | S=1) P (x | z, S=1) P (z T ) P (z T | S=1) (15) = X Z P (y, x, z | S=1) P (x | z, S=1) P (S=1) P (S=1 | z T ) (16)", "formula_coordinates": [7.0, 57.99, 588.35, 234.51, 80.51]}, {"formula_id": "formula_27", "formula_text": "w 0 i = 1/P (X i | Z i , S=1) and w S i = P (S=1)/P (S=1 | Z T i ).", "formula_coordinates": [7.0, 319.51, 148.07, 454.5, 31.07]}, {"formula_id": "formula_28", "formula_text": "IPWS = 1 n n X i=1 w 0 i w S i I X i =x Yi.(17)", "formula_coordinates": [7.0, 386.95, 208.44, 171.17, 27.08]}, {"formula_id": "formula_29", "formula_text": "\u00b5 IPW2 = 1 n n X i=1 w 0 i I X i =x Yi (18)", "formula_coordinates": [7.0, 387.8, 305.66, 170.32, 27.08]}, {"formula_id": "formula_30", "formula_text": "G X . (d) Every X 2 X is either a non-ancestor of S or it is independent of Y in G X , i.e., 8 X2X\\An(S) (X ? ? Y) G X", "formula_coordinates": [8.0, 56.21, 213.18, 444.93, 32.86]}, {"formula_id": "formula_31", "formula_text": "P (y|do(x)) = X Z P (y|x, z, S=1)P (z1|z2, S=1)P (z2).(1)", "formula_coordinates": [8.0, 198.52, 328.01, 359.48, 15.46]}, {"formula_id": "formula_32", "formula_text": "P (y|do(x)) (2) = X Z 1 P (y|do(x), z1)P (z1 | do(x)) (3) = X Z 1 P (y|do(x), z1, S=1)P (z1) (4) = X Z 1 P (y|do(x), z1, S=1) X Z 2 P (z1|z2)P (z2) (5) = X Z P (y|do(x), z, S=1)P (z1 | z2, S=1)P (z2) (6) = X Z P (y|x, z, S=1)P (z1 | z2, S=1)P (z2)(7)", "formula_coordinates": [8.0, 207.62, 365.83, 350.38, 109.82]}, {"formula_id": "formula_33", "formula_text": "X Y Z (a) X Y Z (b) X Y Z S (c) X Y Z 1 Z 2 S (d)", "formula_coordinates": [8.0, 142.56, 556.59, 336.51, 102.11]}, {"formula_id": "formula_34", "formula_text": "X 1 X 2 Y Z 1 Z 2 Z 3 S", "formula_coordinates": [9.0, 244.44, 95.76, 116.48, 54.63]}, {"formula_id": "formula_35", "formula_text": "P (y | do(x)) (8) = P (y | do(x)) X Z 3 P (z3) (9) = X Z 3 P (y | do(x), z3)P (z3) (10) = X Z 2 ,Z 3 P (y | do(x), z2, z3)P (z2|do(x), z3)P (z3) (11) = X Z 2 ,Z 3 P (y | do(x), z2, z3)P (z2 | z3)P (z3) (12) = X Z 2 ,Z 3 P (y | do(x), z2, z3, S=1)P (z2 | z3)P (z3) (13) = X Z P (y|x,z,S=1)P (z1|do(x),z2,z3, S=1)P (z2,z3) (14) = X Z P (y|x, z, S=1)P (z1|do(x), z2, z3, S=1)P (z3|z2, S=1)P (z2) (15) = X Z P (y | x, z, S = 1)P (z1, z3 | z2, S=1)P (z2)(16)", "formula_coordinates": [9.0, 174.1, 221.34, 383.9, 168.76]}, {"formula_id": "formula_36", "formula_text": "X | Z 2 , Z 3 ) G X(Z 2 ,Z 3 )", "formula_coordinates": [9.0, 105.32, 453.94, 85.16, 17.04]}, {"formula_id": "formula_37", "formula_text": "P (y|do(x)) = X Z P (y|x,z,S=1)P (z\\z T |z T ,S=1)P (z T )(17)", "formula_coordinates": [9.0, 195.46, 518.71, 362.54, 20.56]}, {"formula_id": "formula_38", "formula_text": "P z \\ z T , S=1 P z T = Y |Z| i=j+1 P (z i | z i 1 , z i 2 , . . . , z 1 , S=1) Y j i=1 P (z i | z i 1 , z i 2 , . . . , z 1 )(18)", "formula_coordinates": [9.0, 99.74, 591.44, 458.26, 22.41]}, {"formula_id": "formula_39", "formula_text": "k | z k 1 , z k 2 , .", "formula_coordinates": [9.0, 414.75, 616.86, 67.93, 17.04]}, {"formula_id": "formula_40", "formula_text": "P (z k , z k 1 , z k 2 , . . . , z 1 ) is required.", "formula_coordinates": [9.0, 54.0, 637.04, 154.23, 12.44]}, {"formula_id": "formula_41", "formula_text": "S | Z T G pbd XY .", "formula_coordinates": [10.0, 344.11, 80.88, 54.28, 18.77]}, {"formula_id": "formula_42", "formula_text": "A let A nd = {A 2 A | A / 2 De (X)}.", "formula_coordinates": [10.0, 83.75, 217.47, 155.17, 17.04]}, {"formula_id": "formula_43", "formula_text": "\u2022 Z S = {Z 2 Z M | (Z ? ? S | Z T )}.", "formula_coordinates": [10.0, 54.0, 271.54, 150.28, 17.04]}, {"formula_id": "formula_44", "formula_text": "(V [ C) \\ (Z [ X [ Y) that: 1. Are d-connected to Y given Z T , Z S in G \\ X 2. Are not descendants of X 3. Are ancestors of some Z 2 Z T [ Z S \u2022 L 2 be defined as all variables in (V [ C) \\ (Z [ X [ Y) that: 1. Are d-connected to Y given Z in G \\ X 2. Are independent of X given Z S , Z T and S on G X(Z S ,Z T ,S)", "formula_coordinates": [10.0, 54.0, 287.2, 259.79, 96.44]}, {"formula_id": "formula_45", "formula_text": "\u2022 Z X = n Z 2 Z \\ (Z T [ Z S ) | (Z ? ? X | Z S , Z T , S) G X(Z S ,Z T ,S) o \u2022 Z Y = Z \\ (Z T [ Z S [ Z X ).", "formula_coordinates": [10.0, 54.0, 399.13, 275.15, 40.61]}, {"formula_id": "formula_46", "formula_text": "X(Z T ,Z S ,S) (by assumption of p), then X 0 must have a descendant in Z T [ Z S [ {S}. Any descendant of X 0 in Z S is d-connected to S", "formula_coordinates": [11.0, 83.89, 344.75, 474.11, 26.29]}, {"formula_id": "formula_47", "formula_text": "\u21e4 Z \u21e4 \u2022 \u2022 \u2022 X 00 \u2022 \u2022 \u2022 S or Z \u21e4 \u2022 \u2022 \u2022 X 00 ! \u2022 \u2022 \u2022 S", "formula_coordinates": [11.0, 73.93, 528.94, 176.98, 18.77]}, {"formula_id": "formula_48", "formula_text": "G pbd XY . \u21e4 Z \u21e4 \u2022 \u2022 \u2022 ! X 00", "formula_coordinates": [11.0, 73.93, 609.21, 437.71, 31.25]}, {"formula_id": "formula_49", "formula_text": "(Y ? ? Z T d , Z S d | L 1 , Z T nd , Z S nd , X) G X (19) (Y ? ? S | Z T , X) G X (20) (Y ? ? S | Z T , Z S , X) G X (21) (L 1 ? ? X | Z T , Z S ) G X(Z T ,Z S ) (22) (Y ? ? Z Y | Z T , Z S , L 2 , Z X , X, S) G X (23) (L 2 ? ? X | Z, S) G X(Z,S)(24)", "formula_coordinates": [12.0, 227.89, 78.8, 330.11, 101.54]}, {"formula_id": "formula_50", "formula_text": "1. (Y ? ? Z T d , Z S d | L 1 , Z T nd , Z S nd , X)", "formula_coordinates": [12.0, 51.51, 224.38, 155.57, 17.04]}, {"formula_id": "formula_51", "formula_text": "(a) Z 0 ! \u2022 \u2022 \u2022 ! Y 0 : Since Z 0 is a descendant of X", "formula_coordinates": [12.0, 57.89, 263.88, 217.17, 18.03]}, {"formula_id": "formula_52", "formula_text": "Z 0 \u2022 \u2022 \u2022 Y 0 : Here Z 0 is a descendant of Y 0 , so Y 0 is not a descendant of X otherwise Z 0 contradicts cond. (a)", "formula_coordinates": [12.0, 73.93, 289.98, 450.21, 18.03]}, {"formula_id": "formula_53", "formula_text": "(c) Z 0 \u2022 \u2022 \u2022 ! W \u2022 \u2022 \u2022 Y 0 : There is a collider W in p that belongs or has a descendant W 0 2 L 1 [ Z T nd [ Z S", "formula_coordinates": [12.0, 57.89, 338.0, 430.54, 18.03]}, {"formula_id": "formula_54", "formula_text": "W 0 2 L 1 . (d) Z 0 \u2022 \u2022 \u2022 ! Y 0 :", "formula_coordinates": [12.0, 57.33, 452.19, 481.69, 33.17]}, {"formula_id": "formula_55", "formula_text": "Z T , Z S in G \\ X. Therefore, L 0 2 L 1 and p is closed. 2. (Y ? ? S | Z T , X)", "formula_coordinates": [12.0, 51.51, 523.39, 238.59, 35.35]}, {"formula_id": "formula_56", "formula_text": "(Y ? ? S | Z T ) G pbd XY (25) =)(Y ? ? S | Z T ) G pbd XY X (26) =)(Y ? ? S | Z T , X) G pbd XY X (27) =)(Y ? ? S | Z T , X) G X (28", "formula_coordinates": [12.0, 254.01, 566.67, 303.99, 75.41]}, {"formula_id": "formula_57", "formula_text": ")", "formula_coordinates": [12.0, 553.85, 625.77, 4.15, 9.54]}, {"formula_id": "formula_58", "formula_text": "(Y ? ? S | Z T , X) G X^( Z S ? ? S | Z T ) (29) =)(Y ? ? S | Z T , X) G X^( Z S ? ? S | X, Z T ) G X (30) =)(Y, Z S ? ? S | Z T , X) G X (31) =)(Y ? ? S | Z S , Z T , X) G X (32)", "formula_coordinates": [13.0, 210.26, 75.64, 347.74, 66.85]}, {"formula_id": "formula_59", "formula_text": "X | Z T , Z S ) G X(Z T ,Z S )", "formula_coordinates": [13.0, 94.18, 176.66, 91.32, 17.04]}, {"formula_id": "formula_60", "formula_text": "L 0 2 L 1 to some X 0 2 X given Z T , Z S in G X(Z T ,Z S ) (X 0 \u2022 \u2022 \u2022 \u2022 \u2022 \u2022 L 0", "formula_coordinates": [13.0, 63.96, 191.5, 286.46, 18.03]}, {"formula_id": "formula_61", "formula_text": "L 0 is d-connected to some Y 0 2 Y by some path p 2 in G \\ X given Z T , Z S (L 0 \u2022 \u2022 \u2022 \u2022 \u2022 \u2022 Y 0 ).", "formula_coordinates": [13.0, 63.96, 205.4, 494.04, 28.99]}, {"formula_id": "formula_62", "formula_text": "Z 0 2 Z T [ Z S by definition of L 1 (i.e. W 0 ! \u2022 \u2022 \u2022 ! L 0 ! \u2022 \u2022 \u2022 ! Z 0 )", "formula_coordinates": [13.0, 73.93, 251.93, 484.07, 28.98]}, {"formula_id": "formula_63", "formula_text": "descendant of W 0 (W 0 ! \u2022 \u2022 \u2022 ! Z 0 \u2022 \u2022 \u2022 L 0", "formula_coordinates": [13.0, 73.93, 273.85, 181.31, 18.03]}, {"formula_id": "formula_64", "formula_text": "-If W 0 = L 0 then L 0 2 De (X) contradicting the definition of L 1 .", "formula_coordinates": [13.0, 68.94, 322.8, 268.44, 18.03]}, {"formula_id": "formula_65", "formula_text": "? ?Z Y | Z T , Z S , L 2 , Z X , X, S) G X :", "formula_coordinates": [13.0, 77.55, 483.11, 142.51, 17.04]}, {"formula_id": "formula_66", "formula_text": "Y 0 2 Y to Z 0 2 Z Y given Z T , Z S , L 2 , Z X , X, S in G X .", "formula_coordinates": [13.0, 63.96, 482.12, 493.75, 31.14]}, {"formula_id": "formula_67", "formula_text": "Y 0 in p 1 . \u2022 p 1 is active given Z T , Z S , L 2 , Z X , S (without X) in G X .", "formula_coordinates": [13.0, 63.96, 506.2, 236.04, 31.69]}, {"formula_id": "formula_68", "formula_text": "\u2022 p 1 is active given Z T , Z S , Z X , S (without L 2 ) in G X .", "formula_coordinates": [13.0, 63.96, 544.2, 223.53, 18.77]}, {"formula_id": "formula_69", "formula_text": "X 0 2 X in G X(Z T ,Z S", "formula_coordinates": [14.0, 389.82, 193.26, 85.87, 18.03]}, {"formula_id": "formula_70", "formula_text": "Z T [ Z S [ {S}. If the descendant is specifically in Z T [ Z S \u2713 Z there is a violation to condition (a).", "formula_coordinates": [14.0, 78.91, 269.64, 479.09, 27.38]}, {"formula_id": "formula_71", "formula_text": "\u2022 p 2 does not contain any variable in Z X [ L 2 : Both sets require the independence (Z X , L 2 ? ? X | Z T , Z S , S) G X(Z T ,Z S ,S)", "formula_coordinates": [14.0, 63.96, 347.65, 490.55, 18.77]}, {"formula_id": "formula_72", "formula_text": "X(Z T ,Z S ,S) given Z T , Z S , S. If Q 2 L", "formula_coordinates": [14.0, 393.22, 491.96, 157.27, 17.04]}, {"formula_id": "formula_73", "formula_text": "-X 00 \u2022 \u2022 \u2022 Q Y 0 (if Y 0", "formula_coordinates": [14.0, 68.94, 565.27, 111.72, 18.03]}, {"formula_id": "formula_74", "formula_text": "X 00 \u2022 \u2022 \u2022 Q ! \u2022 \u2022 \u2022 ! Y 0 -Q Y 0 \u2022 \u2022 \u2022 X 00 (here Y 0 lies in p 0 1 ) -Q ! \u2022 \u2022 \u2022 ! Y 0 \u2022 \u2022 \u2022 X 00 (here Y 0 lies in p 0 1 ) In the four cases the path p 0 is active in G X(Z T ,Z S", "formula_coordinates": [14.0, 68.94, 577.44, 215.54, 51.62]}, {"formula_id": "formula_75", "formula_text": "W 0 ! \u2022 \u2022 \u2022 ! L 0 ! \u2022 \u2022 \u2022 ! Z 0 = Z \u21e4 ) or there is an active collider in Z [ {S} connecting W 0 and L 0 , such collider is descendant of W 0 (W 0 ! \u2022 \u2022 \u2022 ! Z 0 \u2022 \u2022 \u2022 L 0 ).", "formula_coordinates": [15.0, 73.93, 103.58, 484.07, 28.98]}, {"formula_id": "formula_76", "formula_text": "= X L1,Z T nd ,Z S nd P (y | do(x), l 1 , z T nd , z S nd )P (l 1 , z T nd , z S nd | do(x))(33)", "formula_coordinates": [15.0, 94.64, 462.73, 463.36, 41.1]}, {"formula_id": "formula_78", "formula_text": "= X L1,Z T nd ,Z S nd P (y | do(x), l 1 , z T nd , z S nd )P (l 1 , z T nd , z S nd )(35)", "formula_coordinates": [15.0, 94.64, 550.08, 463.36, 26.1]}, {"formula_id": "formula_79", "formula_text": "Z T d , Z S d | L 1 , Z T nd , Z S nd , X) G X to", "formula_coordinates": [15.0, 284.81, 588.08, 135.72, 17.04]}, {"formula_id": "formula_81", "formula_text": "= X Z T ,Z S P (y | do(x), z T , z S , S=1)P (z S | z T , S=1)P (z T ) (41) Conditioning on L 2 , Z X we get = X Z T ,Z S ,L2,Z X P (y | do(x), z T , z S , l 2 , z X , S=1)P (l 2 , z X | do(x), z T , z S , S=1)P (z S | z T , S=1)P (z T )(42)", "formula_coordinates": [16.0, 54.0, 251.14, 504.0, 80.18]}, {"formula_id": "formula_82", "formula_text": "X | Z T , Z S , S) G X(Z T ,Z S ,S)", "formula_coordinates": [16.0, 182.24, 343.1, 108.51, 17.04]}, {"formula_id": "formula_83", "formula_text": "X | Z T , Z S , S) G X(Z T ,Z S ,S)", "formula_coordinates": [16.0, 448.49, 343.1, 108.51, 17.04]}, {"formula_id": "formula_84", "formula_text": "= X Z T ,Z S ,L2,Z X P (y | do(x), z T , z S , l 2 , z X , S=1)P (l 2 , z X | z T , z S , S=1)P (z S | z T , S=1)P (z T ) (43) By independence (Y ? ? Z Y | Z T , Z S , L 2 , Z X , X, S) G X from lemma 1-(", "formula_coordinates": [16.0, 54.0, 380.1, 504.0, 52.59]}, {"formula_id": "formula_85", "formula_text": "= X Z,L2 P (y | do(x), z, l 2 , S=1)P (l 2 , z Y , z X | z S , z T , S=1)P (z S | z T , S=1)P (z T )(44)", "formula_coordinates": [16.0, 94.64, 446.97, 463.36, 23.15]}, {"formula_id": "formula_86", "formula_text": "= X Z,L2 P (y | do(x), z, l 2 , S=1)P (l 2 | z Y , z X , z T , z S , S=1)P (z Y , z X , z S | z T , S=1)P (z T )(45)", "formula_coordinates": [16.0, 94.64, 501.13, 463.36, 23.15]}, {"formula_id": "formula_87", "formula_text": "X | Z, S) G X(Z,S) from lemma 1-(24). Also consid- ering that Z = Z Y [ Z X [ Z T [ Z S , we can rewrite as = X Z,L2 P (y | do(x), z, l 2 , S=1)P (l 2 | do(x), z, S=1)P (z Y , z X , z S | z T , S=1)P (z T )(46)", "formula_coordinates": [16.0, 54.0, 535.14, 504.0, 58.68]}, {"formula_id": "formula_88", "formula_text": "= X Z P (y | do(x), z, S=1)P (z Y , z X , z S | z T , S=1)P (z T ) (47) Renaming the sets Z Y [ Z X [ Z S as Z \\ Z T = X Z P (y | do(x), z, S=1)P (z \\ z T | z T , S=1)P (z T ) (48) X W 0 Z 1 W 1 \u2022 \u2022 \u2022 W k S W k+1 \u2022 \u2022 \u2022 W n 1 Z n W n Y 0", "formula_coordinates": [16.0, 54.0, 624.84, 504.0, 77.91]}, {"formula_id": "formula_89", "formula_text": "= X Z P (y | x, z, S=1)P (z \\ z T | z T , S=1)P (z T )(49)", "formula_coordinates": [17.0, 94.64, 185.31, 463.36, 23.15]}, {"formula_id": "formula_90", "formula_text": "X Z P (y | x, z, S=1) P z \\ z T | z T , S=1 P z T = X Z P (y | x, z) P (z) 6 = P (y | do(x))(50)", "formula_coordinates": [17.0, 117.26, 342.45, 440.74, 23.15]}, {"formula_id": "formula_91", "formula_text": "P (Y =1 | do(X=1)) = P (Y =1) = 1 2 \u270f X Z P (Y =1 | X=1, z, S=1)P (z \\ z T | S=1)P (z T ) = 1 2 (\u270f 2 2\u270f + 2)", "formula_coordinates": [17.0, 162.02, 523.75, 287.95, 51.0]}, {"formula_id": "formula_92", "formula_text": "X Z P (y | x, z, S=1)P (z \\ z T | S=1)P (z T ) (51) = X Z P (y | z, S=1)P (z \\ z T | S=1)P (z T ) (52) = X Z T P (y | z T , S=1)P (z T )(53)", "formula_coordinates": [18.0, 210.06, 255.03, 347.94, 78.51]}, {"formula_id": "formula_93", "formula_text": "Y | Z, S) G pbd XY .", "formula_coordinates": [18.0, 283.85, 341.6, 60.2, 17.04]}, {"formula_id": "formula_94", "formula_text": "P (y | do(s)) 6 = X Z T P (y | s, z T )P (z T )(54)", "formula_coordinates": [18.0, 225.92, 435.77, 332.08, 23.78]}, {"formula_id": "formula_95", "formula_text": "Z T P (y | s, z T )P (z T )(55)", "formula_coordinates": [18.0, 344.35, 497.5, 213.65, 21.77]}, {"formula_id": "formula_97", "formula_text": "(Y ? ? S) G pbd XY (60) =)(Y ? ? S) G pbd XY X (61) =)(Y ? ? S | X) G pbd XY X (62) =)(Y ? ? S | X) G X (63) Statement (", "formula_coordinates": [19.0, 54.0, 282.94, 504.0, 83.27]}, {"formula_id": "formula_98", "formula_text": "G pbd XY (64", "formula_coordinates": [19.0, 458.37, 418.98, 95.48, 13.76]}, {"formula_id": "formula_99", "formula_text": ")", "formula_coordinates": [19.0, 553.85, 418.98, 4.15, 9.54]}], "doi": ""}