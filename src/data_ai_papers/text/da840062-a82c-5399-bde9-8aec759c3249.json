{"title": "Recursive Deep Models for Semantic Compositionality Over a Sentiment Treebank", "authors": "Richard Socher; Alex Perelygin; Jean Y Wu; Jason Chuang; Christopher D Manning; Andrew Y Ng; Christopher Potts", "pub_date": "", "abstract": "Semantic word spaces have been very useful but cannot express the meaning of longer phrases in a principled way. Further progress towards understanding compositionality in tasks such as sentiment detection requires richer supervised training and evaluation resources and more powerful models of composition. To remedy this, we introduce a Sentiment Treebank. It includes fine grained sentiment labels for 215,154 phrases in the parse trees of 11,855 sentences and presents new challenges for sentiment compositionality. To address them, we introduce the Recursive Neural Tensor Network. When trained on the new treebank, this model outperforms all previous methods on several metrics. It pushes the state of the art in single sentence positive/negative classification from 80% up to 85.4%. The accuracy of predicting fine-grained sentiment labels for all phrases reaches 80.7%, an improvement of 9.7% over bag of features baselines. Lastly, it is the only model that can accurately capture the effects of negation and its scope at various tree levels for both positive and negative phrases.", "sections": [{"heading": "Introduction", "text": "Semantic vector spaces for single words have been widely used as features (Turney and Pantel, 2010). Because they cannot capture the meaning of longer phrases properly, compositionality in semantic vector spaces has recently received a lot of attention (Mitchell and Lapata, 2010;Socher et al., 2010;Zanzotto et al., 2010;Yessenalina and Cardie, 2011;Grefenstette et al., 2013). However, progress is held back by the current lack of large and labeled compositionality resources and Figure 1: Example of the Recursive Neural Tensor Network accurately predicting 5 sentiment classes, very negative to very positive (--, -, 0, +, + +), at every node of a parse tree and capturing the negation and its scope in this sentence. models to accurately capture the underlying phenomena presented in such data. To address this need, we introduce the Stanford Sentiment Treebank and a powerful Recursive Neural Tensor Network that can accurately predict the compositional semantic effects present in this new corpus.\nThe Stanford Sentiment Treebank is the first corpus with fully labeled parse trees that allows for a complete analysis of the compositional effects of sentiment in language. The corpus is based on the dataset introduced by Pang and Lee (2005) and consists of 11,855 single sentences extracted from movie reviews. It was parsed with the Stanford parser (Klein and Manning, 2003) and includes a total of 215,154 unique phrases from those parse trees, each annotated by 3 human judges. This new dataset allows us to analyze the intricacies of sentiment and to capture complex linguistic phenomena. Fig. 1 shows one of the many examples with clear compositional structure. The granularity and size of this dataset will enable the community to train compositional models that are based on supervised and structured machine learning techniques. While there are several datasets with document and chunk labels available, there is a need to better capture sentiment from short comments, such as Twitter data, which provide less overall signal per document.\nIn order to capture the compositional effects with higher accuracy, we propose a new model called the Recursive Neural Tensor Network (RNTN). Recursive Neural Tensor Networks take as input phrases of any length. They represent a phrase through word vectors and a parse tree and then compute vectors for higher nodes in the tree using the same tensor-based composition function. We compare to several supervised, compositional models such as standard recursive neural networks (RNN) (Socher et al., 2011b), matrix-vector RNNs , and baselines such as neural networks that ignore word order, Naive Bayes (NB), bi-gram NB and SVM. All models get a significant boost when trained with the new dataset but the RNTN obtains the highest performance with 80.7% accuracy when predicting finegrained sentiment for all nodes. Lastly, we use a test set of positive and negative sentences and their respective negations to show that, unlike bag of words models, the RNTN accurately captures the sentiment change and scope of negation. RNTNs also learn that sentiment of phrases following the contrastive conjunction 'but' dominates.\nThe complete training and testing code, a live demo and the Stanford Sentiment Treebank dataset are available at http://nlp.stanford.edu/ sentiment.", "publication_ref": ["b38", "b20", "b33", "b43", "b41", "b10", "b24", "b16", "b35"], "figure_ref": [], "table_ref": []}, {"heading": "Related Work", "text": "This work is connected to five different areas of NLP research, each with their own large amount of related work to which we cannot do full justice given space constraints.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "Semantic Vector Spaces.", "text": "The dominant approach in semantic vector spaces uses distributional similarities of single words. Often, co-occurrence statistics of a word and its context are used to describe each word (Turney and Pantel, 2010;Baroni and Lenci, 2010), such as tf-idf. Variants of this idea use more complex frequencies such as how often a word appears in a certain syntactic context (Pado and Lapata, 2007;Erk and Pad\u00f3, 2008). However, distributional vectors often do not properly capture the differences in antonyms since those often have similar contexts. One possibility to remedy this is to use neural word vectors (Bengio et al., 2003). These vectors can be trained in an unsupervised fashion to capture distributional similarities (Collobert and Weston, 2008;Huang et al., 2012) but then also be fine-tuned and trained to specific tasks such as sentiment detection (Socher et al., 2011b). The models in this paper can use purely supervised word representations learned entirely on the new corpus.\nCompositionality in Vector Spaces.\nMost of the compositionality algorithms and related datasets capture two word compositions. Mitchell and Lapata ( 2010) use e.g. two-word phrases and analyze similarities computed by vector addition, multiplication and others. Some related models such as holographic reduced representations (Plate, 1995), quantum logic (Widdows, 2008), discrete-continuous models (Clark and Pulman, 2007) and the recent compositional matrix space model (Rudolph and Giesbrecht, 2010) have not been experimentally validated on larger corpora. Yessenalina and Cardie (2011) compute matrix representations for longer phrases and define composition as matrix multiplication, and also evaluate on sentiment. Grefenstette and Sadrzadeh (2011) analyze subject-verbobject triplets and find a matrix-based categorical model to correlate well with human judgments. We compare to the recent line of work on supervised compositional models. In particular we will describe and experimentally compare our new RNTN model to recursive neural networks (RNN) (Socher et al., 2011b) and matrix-vector RNNs  both of which have been applied to bag of words sentiment corpora.", "publication_ref": ["b38", "b0", "b23", "b7", "b1", "b5", "b13", "b35", "b26", "b40", "b4", "b31", "b41", "b35"], "figure_ref": [], "table_ref": []}, {"heading": "Logical Form.", "text": "A related field that tackles compositionality from a very different angle is that of trying to map sentences to logical form (Zettlemoyer and Collins, 2005). While these models are highly interesting and work well in closed domains and on discrete sets, they could only capture sentiment distributions using separate mechanisms beyond the currently used logical forms.\nDeep Learning. Apart from the above mentioned work on RNNs, several compositionality ideas related to neural networks have been discussed by Bottou (2011) and Hinton (1990) and first models such as Recursive Auto-associative memories been experimented with by Pollack (1990). The idea to relate inputs through three way interactions, parameterized by a tensor have been proposed for relation classification (Sutskever et al., 2009;Jenatton et al., 2012), extending Restricted Boltzmann machines (Ranzato and Hinton, 2010) and as a special layer for speech recognition (Yu et al., 2012).", "publication_ref": ["b44", "b3", "b11", "b28", "b37", "b15", "b29", "b42"], "figure_ref": [], "table_ref": []}, {"heading": "Sentiment Analysis.", "text": "Apart from the abovementioned work, most approaches in sentiment analysis use bag of words representations (Pang and Lee, 2008). Snyder and Barzilay (2007) analyzed larger reviews in more detail by analyzing the sentiment of multiple aspects of restaurants, such as food or atmosphere. Several works have explored sentiment compositionality through careful engineering of features or polarity shifting rules on syntactic structures (Polanyi and Zaenen, 2006;Moilanen and Pulman, 2007;Rentoumi et al., 2010;Nakagawa et al., 2010).", "publication_ref": ["b25", "b32", "b27", "b21", "b30", "b22"], "figure_ref": [], "table_ref": []}, {"heading": "Stanford Sentiment Treebank", "text": "Bag of words classifiers can work well in longer documents by relying on a few words with strong sentiment like 'awesome' or 'exhilarating.' However, sentiment accuracies even for binary positive/negative classification for single sentences has not exceeded 80% for several years. For the more difficult multiclass case including a neutral class, accuracy is often below 60% for short messages on Twitter (Wang et al., 2012). From a linguistic or cognitive standpoint, ignoring word order in the treatment of a semantic task is not plausible, and, as we will show, it cannot accurately classify hard examples of negation. Correctly predicting these hard cases is necessary to further improve performance.\nIn this section we will introduce and provide some analyses for the new Sentiment Treebank which includes labels for every syntactically plausible phrase in thousands of sentences, allowing us to train and evaluate compositional models.\nWe consider the corpus of movie review excerpts from the rottentomatoes.com website originally collected and published by Pang and Lee (2005). The original dataset includes 10,662 sen- tences, half of which were considered positive and the other half negative. Each label is extracted from a longer movie review and reflects the writer's overall intention for this review. The normalized, lowercased text is first used to recover, from the original website, the text with capitalization. Remaining HTML tags and sentences that are not in English are deleted. The Stanford Parser (Klein and Manning, 2003) is used to parses all 10,662 sentences. In approximately 1,100 cases it splits the snippet into multiple sentences. We then used Amazon Mechanical Turk to label the resulting 215,154 phrases. Fig. 3 shows the interface annotators saw. The slider has 25 different values and is initially set to neutral. The phrases in each hit are randomly sampled from the set of all phrases in order to prevent labels being influenced by what follows. For more details on the dataset collection, see supplementary material.\nFig. 2 shows the normalized label distributions at each n-gram length. Starting at length 20, the majority are full sentences. One of the findings from labeling sentences based on reader's perception is that many of them could be considered neutral. We also notice that stronger sentiment often builds up in longer phrases and the majority of the shorter phrases are neutral. Another observation is that most annotators moved the slider to one of the five positions: negative, somewhat negative, neutral, positive or somewhat positive. The extreme values were rarely used and the slider was not often left in between the ticks. Hence, even a 5-class classification into these categories captures the main variability of the labels. We will name this fine-grained sentiment classification and our main experiment will be to recover these five labels for phrases of all lengths.  ", "publication_ref": ["b39", "b24", "b16"], "figure_ref": ["fig_1", "fig_3"], "table_ref": []}, {"heading": "Recursive Neural Models", "text": "The models in this section compute compositional vector representations for phrases of variable length and syntactic type. These representations will then be used as features to classify each phrase. Fig. 4 displays this approach. When an n-gram is given to the compositional models, it is parsed into a binary tree and each leaf node, corresponding to a word, is represented as a vector. Recursive neural models will then compute parent vectors in a bottom up fashion using different types of compositionality functions g. The parent vectors are again given as features to a classifier. For ease of exposition, we will use the tri-gram in this figure to explain all models.\nWe first describe the operations that the below recursive neural models have in common: word vector representations and classification. This is followed by descriptions of two previous RNN models and our RNTN.\nEach word is represented as a d-dimensional vector. We initialize all word vectors by randomly sampling each value from a uniform distribution: U(\u2212r, r), where r = 0.0001. All the word vectors are stacked in the word embedding matrix L \u2208 R d\u00d7|V | , where |V | is the size of the vocabulary. Initially the word vectors will be random but the L matrix is seen as a parameter that is trained jointly with the compositionality models.\nWe can use the word vectors immediately as parameters to optimize and as feature inputs to a softmax classifier. For classification into five classes, we compute the posterior probability over labels given the word vector via:\ny a = softmax(W s a),(1)\nwhere W s \u2208 R 5\u00d7d is the sentiment classification matrix. For the given tri-gram, this is repeated for vectors b and c. The main task of and difference between the models will be to compute the hidden vectors p i \u2208 R d in a bottom up fashion.", "publication_ref": [], "figure_ref": ["fig_4"], "table_ref": []}, {"heading": "RNN: Recursive Neural Network", "text": "The simplest member of this family of neural network models is the standard recursive neural network (Goller and K\u00fcchler, 1996;Socher et al., 2011a). First, it is determined which parent already has all its children computed. In the above tree example, p 1 has its two children's vectors since both are words. RNNs use the following equations to compute the parent vectors:\np 1 = f W b c , p 2 = f W a p 1 ,\nwhere f = tanh is a standard element-wise nonlinearity, W \u2208 R d\u00d72d is the main parameter to learn and we omit the bias for simplicity. The bias can be added as an extra column to W if an additional 1 is added to the concatenation of the input vectors. The parent vectors must be of the same dimensionality to be recursively compatible and be used as input to the next composition. Each parent vector p i , is given to the same softmax classifier of Eq. 1 to compute its label probabilities. This model uses the same compositionality function as the recursive autoencoder (Socher et al., 2011b) and recursive auto-associate memories (Pollack, 1990). The only difference to the former model is that we fix the tree structures and ignore the reconstruction loss. In initial experiments, we found that with the additional amount of training data, the reconstruction loss at each node is not necessary to obtain high performance.", "publication_ref": ["b8", "b34", "b35", "b28"], "figure_ref": [], "table_ref": []}, {"heading": "MV-RNN: Matrix-Vector RNN", "text": "The MV-RNN is linguistically motivated in that most of the parameters are associated with words and each composition function that computes vectors for longer phrases depends on the actual words being combined. The main idea of the MV-RNN  is to represent every word and longer phrase in a parse tree as both a vector and a matrix. When two constituents are combined the matrix of one is multiplied with the vector of the other and vice versa. Hence, the compositional function is parameterized by the words that participate in it.\nEach word's matrix is initialized as a d\u00d7d identity matrix, plus a small amount of Gaussian noise. Similar to the random word vectors, the parameters of these matrices will be trained to minimize the classification error at each node. For this model, each ngram is represented as a list of (vector,matrix) pairs, together with the parse tree. For the tree with (vector,matrix) nodes:\n(p 2 ,P 2 ) (a,A) (p 1 ,P 1 ) (b,B) (c,C) the MV-RNN computes the first parent vector and its matrix via two equations:\np 1 = f W Cb Bc , P 1 = f W M B C ,\nwhere W M \u2208 R d\u00d72d and the result is again a d \u00d7 d matrix. Similarly, the second parent node is computed using the previously computed (vector,matrix) pair (p 1 , P 1 ) as well as (a, A). The vectors are used for classifying each phrase using the same softmax classifier as in Eq. 1.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "RNTN:Recursive Neural Tensor Network", "text": "One problem with the MV-RNN is that the number of parameters becomes very large and depends on the size of the vocabulary. It would be cognitively more plausible if there was a single powerful composition function with a fixed number of parameters. The standard RNN is a good candidate for such a function. However, in the standard RNN, the input vectors only implicitly interact through the nonlinearity (squashing) function. A more direct, possibly multiplicative, interaction would allow the model to have greater interactions between the input vectors.\nMotivated by these ideas we ask the question: Can a single, more powerful composition function perform better and compose aggregate meaning from smaller constituents more accurately than many input specific ones? In order to answer this question, we propose a new model called the Recursive Neural Tensor Network (RNTN). The main idea is to use the same, tensor-based composition function for all nodes.\nFig. 5 shows a single tensor layer. We define the output of a tensor product h \u2208 R d via the following vectorized notation and the equivalent but more detailed notation for each slice\nV [i] \u2208 R d\u00d7d : h = b c T V [1:d] b c ; h i = b c T V [i] b c .\nwhere V [1:d] \u2208 R 2d\u00d72d\u00d7d is the tensor that defines multiple bilinear forms. The RNTN uses this definition for computing p 1 :", "publication_ref": [], "figure_ref": ["fig_5"], "table_ref": []}, {"heading": "Slices of", "text": "", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "Standard", "text": "p 1 = f b c T V [1:d] b c + W b c ,\nwhere W is as defined in the previous models. The next parent vector p 2 in the tri-gram will be computed with the same weights:\np 2 = f a p 1 T V [1:d] a p 1 + W a p 1 .\nThe main advantage over the previous RNN model, which is a special case of the RNTN when V is set to 0, is that the tensor can directly relate input vectors. Intuitively, we can interpret each slice of the tensor as capturing a specific type of composition.\nAn alternative to RNTNs would be to make the compositional function more powerful by adding a second neural network layer. However, initial experiments showed that it is hard to optimize this model and vector interactions are still more implicit than in the RNTN.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "Tensor Backprop through Structure", "text": "We describe in this section how to train the RNTN model. As mentioned above, each node has a softmax classifier trained on its vector representation to predict a given ground truth or target vector t. We assume the target distribution vector at each node has a 0-1 encoding. If there are C classes, then it has length C and a 1 at the correct label. All other entries are 0.\nWe want to maximize the probability of the correct prediction, or minimize the cross-entropy error between the predicted distribution y i \u2208 R C\u00d71 at node i and the target distribution t i \u2208 R C\u00d71 at that node. This is equivalent (up to a constant) to minimizing the KL-divergence between the two distributions. The error as a function of the RNTN parameters \u03b8 = (V, W, W s , L) for a sentence is:\nE(\u03b8) = i j t i j log y i j + \u03bb \u03b8 2 (2)\nThe derivative for the weights of the softmax classifier are standard and simply sum up from each node's error. We define x i to be the vector at node i (in the example trigram, the x i \u2208 R d\u00d71 's are (a, b, c, p 1 , p 2 )). We skip the standard derivative for W s . Each node backpropagates its error through to the recursively used weights V, W . Let \u03b4 i,s \u2208 R d\u00d71 be the softmax error vector at node i:\n\u03b4 i,s = W T s (y i \u2212 t i ) \u2297 f (x i ),\nwhere \u2297 is the Hadamard product between the two vectors and f is the element-wise derivative of f which in the standard case of using f = tanh can be computed using only f (x i ).\nThe remaining derivatives can only be computed in a top-down fashion from the top node through the tree and into the leaf nodes. The full derivative for V and W is the sum of the derivatives at each of the nodes. We define the complete incoming error messages for a node i as \u03b4 i,com . The top node, in our case p 2 , only received errors from the top node's softmax. Hence, \u03b4 p 2 ,com = \u03b4 p 2 ,s which we can use to obtain the standard backprop derivative for W (Goller and K\u00fcchler, 1996;Socher et al., 2010). For the derivative of each slice k = 1, . . . , d, we get:\n\u2202E p 2 \u2202V [k] = \u03b4 p 2 ,com k a p 1 a p 1 T ,\nwhere \u03b4 p 2 ,com k is just the k'th element of this vector. Now, we can compute the error message for the two children of p 2 :\n\u03b4 p 2 ,down = W T \u03b4 p 2 ,com + S \u2297 f a p 1 ,\nwhere we define\nS = d k=1 \u03b4 p 2 ,com k V [k] + V [k] T a p 1\nThe children of p 2 , will then each take half of this vector and add their own softmax error message for the complete \u03b4. In particular, we have\n\u03b4 p 1 ,com = \u03b4 p 1 ,s + \u03b4 p 2 ,down [d + 1 : 2d],\nwhere \u03b4 p 2 ,down [d + 1 : 2d] indicates that p 1 is the right child of p 2 and hence takes the 2nd half of the error, for the final word vector derivative for a, it will be \u03b4 p 2 ,down [1 : d].\nThe full derivative for slice V [k] for this trigram tree then is the sum at each node:\n\u2202E \u2202V [k] = E p 2 \u2202V [k] + \u03b4 p 1 ,com k b c b c T ,\nand similarly for W . For this nonconvex optimization we use AdaGrad (Duchi et al., 2011) which converges in less than 3 hours to a local optimum.", "publication_ref": ["b8", "b33", "b6"], "figure_ref": [], "table_ref": []}, {"heading": "Experiments", "text": "We include two types of analyses. The first type includes several large quantitative evaluations on the test set. The second type focuses on two linguistic phenomena that are important in sentiment.\nFor all models, we use the dev set and crossvalidate over regularization of the weights, word vector size as well as learning rate and minibatch size for AdaGrad. Optimal performance for all models was achieved at word vector sizes between 25 and 35 dimensions and batch sizes between 20 and 30. Performance decreased at larger or smaller vector and batch sizes. This indicates that the RNTN does not outperform the standard RNN due to simply having more parameters. The MV-RNN has orders of magnitudes more parameters than any other model due to the word matrices. The RNTN would usually achieve its best performance on the dev set after training for 3 -5 hours. Initial experiments showed that the recursive models worked significantly worse (over 5% drop in accuracy) when no nonlinearity was used. We use f = tanh in all experiments.\nWe compare to commonly used methods that use bag of words features with Naive Bayes and SVMs, as well as Naive Bayes with bag of bigram features. We abbreviate these with NB, SVM and biNB. We also compare to a model that averages neural word vectors and ignores word order (VecAvg).\nThe sentences in the treebank were split into a train (8544), dev (1101) and test splits ( 2210) and these splits are made available with the data release.\nWe also analyze performance on only positive and negative sentences, ignoring the neutral class. This filters about 20% of the data with the three sets having 6920/872/1821 sentences.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "Fine-grained Sentiment For All Phrases", "text": "The main novel experiment and evaluation metric analyze the accuracy of fine-grained sentiment classification for all phrases. Fig. 2 showed that a fine grained classification into 5 classes is a reasonable approximation to capture most of the data variation.\nFig. 6 shows the result on this new corpus. The RNTN gets the highest performance, followed by the MV-RNN and RNN. The recursive models work very well on shorter phrases, where negation and composition are important, while bag of features baselines perform well only with longer sentences. The RNTN accuracy upper bounds other models at most n-gram lengths.\nTable 1 (left) shows the overall accuracy numbers for fine grained prediction at all phrase lengths and full sentences. ", "publication_ref": [], "figure_ref": ["fig_3", "fig_6"], "table_ref": []}, {"heading": "Full Sentence Binary Sentiment", "text": "This setup is comparable to previous work on the original rotten tomatoes dataset which only used full sentence labels and binary classification of positive/negative. Hence, these experiments show the improvement even baseline methods can achieve with the sentiment treebank. Table 1 shows results of this binary classification for both all phrases and for only full sentences. The previous state of the art was below 80% . With the coarse bag of words annotation for training, many of the more complex phenomena could not be captured, even by more powerful models. The combination of the new sentiment treebank and the RNTN pushes the state of the art on short phrases up to 85.4%.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "Model Analysis: Contrastive Conjunction", "text": "In this section, we use a subset of the test set which includes only sentences with an 'X but Y ' structure: A phrase X being followed by but which is followed by a phrase Y . The conjunction is interpreted as an argument for the second conjunct, with the first functioning concessively (Lakoff, 1971;Blakemore, 1989;Merin, 1999). Fig. 7 contains an example. We analyze a strict setting, where X and Y are phrases of different sentiment (including neutral). The example is counted as correct, if the classifications for both phrases X and Y are correct. Furthermore, the lowest node that dominates both of the word but and the node that spans Y also have to have the same correct sentiment. For the resulting 131 cases, the RNTN obtains an accuracy of 41% compared to MV-RNN (37), RNN (36) and biNB (27).", "publication_ref": ["b17", "b2", "b19"], "figure_ref": ["fig_8"], "table_ref": []}, {"heading": "Model Analysis: High Level Negation", "text": "We investigate two types of negation. For each type, we use a separate dataset for evaluation.  Set 1: Negating Positive Sentences. The first set contains positive sentences and their negation. In this set, the negation changes the overall sentiment of a sentence from positive to negative. Hence, we compute accuracy in terms of correct sentiment reversal from positive to negative. Fig. 9 shows two examples of positive negation the RNTN correctly classified, even if negation is less obvious in the case of 'least'. Table 2 (left) gives the accuracies over 21 positive sentences and their negation for all models. The RNTN has the highest reversal accuracy, showing its ability to structurally learn negation of positive sentences. But what if the model simply makes phrases very negative when negation is in the sentence? The next experiments show that the model captures more than such a simplistic negation rule.\nSet 2: Negating Negative Sentences.\nThe second set contains negative sentences and their negation. When negative sentences are negated, the sentiment treebank shows that overall sentiment should become less negative, but not necessarily positive. For instance, 'The movie was terrible' is negative but the 'The movie was not terrible' says only that it was less bad than a terrible one, not that it was good (Horn, 1989;Israel, 2001). Hence, we evaluate ac-   age positive activation (for set 1) and positive values mean an increase in average positive activation (set 2). The RNTN has the largest shifts in the correct directions. Therefore we can conclude that the RNTN is best able to identify the effect of negations upon both positive and negative sentiment sentences.\nn Most positive n-grams Most negative n-grams 1 engaging; best; powerful; love; beautiful bad; dull; boring; fails; worst; stupid; painfully 2 excellent performances; A masterpiece; masterful film; wonderful movie; marvelous performances worst movie; very bad; shapeless mess; worst thing; instantly forgettable; complete failure 3 an amazing performance; wonderful all-ages triumph; a wonderful movie; most visually stunning for worst movie; A lousy movie; a complete failure; most painfully marginal; very bad sign 5 nicely acted and beautifully shot; gorgeous imagery, effective performances; the best of the year; a terrific American sports movie; refreshingly honest and ultimately touching silliest and most incoherent movie; completely crass and forgettable movie; just another bad movie. A cumbersome and cliche-ridden movie; a humorless, disjointed mess 8 one of the best films of the year; A love for films shines through each frame; created a masterful piece of artistry right here; A masterful film from a master filmmaker, A trashy, exploitative, thoroughly unpleasant experience ; this sloppy drama is an empty vessel.; quickly drags on becoming boring and predictable.; be the worst special-effects creation of the year  ", "publication_ref": ["b12", "b14"], "figure_ref": [], "table_ref": ["tab_2"]}, {"heading": "Model Analysis: Most Positive and Negative Phrases", "text": "We queried the model for its predictions on what the most positive or negative n-grams are, measured as the highest activation of the most negative and most positive classes. Table 3 shows some phrases from the dev set which the RNTN selected for their strongest sentiment.\nDue to lack of space we cannot compare top phrases of the other models but Fig. 10 shows that the RNTN selects more strongly positive phrases at most n-gram lengths compared to other models.\nFor this and the previous experiment, please find additional examples and descriptions in the supplementary material.", "publication_ref": [], "figure_ref": ["fig_10"], "table_ref": ["tab_3"]}, {"heading": "Conclusion", "text": "We introduced Recursive Neural Tensor Networks and the Stanford Sentiment Treebank. The combination of new model and data results in a system for single sentence sentiment detection that pushes state of the art by 5.4% for positive/negative sentence classification. Apart from this standard setting, the dataset also poses important new challenges and allows for new evaluation metrics. For instance, the RNTN obtains 80.7% accuracy on fine-grained sentiment prediction across all phrases and captures negation of different sentiments and scope more accurately than previous models.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "Acknowledgments", "text": "We thank Rukmani Ravisundaram and Tayyab Tariq for the first version of the online demo. ", "publication_ref": [], "figure_ref": [], "table_ref": []}], "references": [{"ref_id": "b0", "title": "Distributional memory: A general framework for corpus-based semantics", "journal": "Computational Linguistics", "year": "2010", "authors": "M Baroni; A Lenci"}, {"ref_id": "b1", "title": "A neural probabilistic language model", "journal": "J. Mach. Learn. Res", "year": "2003-03", "authors": "Y Bengio; R Ducharme; P Vincent; C Janvin"}, {"ref_id": "b2", "title": "Denial and contrast: A relevance theoretic analysis of 'but'. Linguistics and Philosophy", "journal": "", "year": "1989", "authors": "D Blakemore"}, {"ref_id": "b3", "title": "From machine learning to machine reasoning", "journal": "", "year": "2011", "authors": "L Bottou"}, {"ref_id": "b4", "title": "Combining symbolic and distributional models of meaning", "journal": "", "year": "2007", "authors": "S Clark; S Pulman"}, {"ref_id": "b5", "title": "A unified architecture for natural language processing: deep neural networks with multitask learning", "journal": "", "year": "2008", "authors": "R Collobert; J Weston"}, {"ref_id": "b6", "title": "Adaptive subgradient methods for online learning and stochastic optimization", "journal": "JMLR", "year": "2011-07", "authors": "J Duchi; E Hazan; Y Singer"}, {"ref_id": "b7", "title": "A structured vector space model for word meaning in context", "journal": "", "year": "2008", "authors": "K Erk; S Pad\u00f3"}, {"ref_id": "b8", "title": "Learning taskdependent distributed representations by backpropagation through structure", "journal": "", "year": "1996", "authors": "C Goller; A K\u00fcchler"}, {"ref_id": "b9", "title": "Experimental support for a categorical compositional distributional model of meaning", "journal": "", "year": "2011", "authors": "E Grefenstette; M Sadrzadeh"}, {"ref_id": "b10", "title": "Multi-step regression learning for compositional distributional semantics", "journal": "", "year": "2013", "authors": "G Grefenstette; Y.-Z Dinu; M Zhang; M Sadrzadeh;  Baroni"}, {"ref_id": "b11", "title": "Mapping part-whole hierarchies into connectionist networks", "journal": "Artificial Intelligence", "year": "1990", "authors": "G E Hinton"}, {"ref_id": "b12", "title": "A natural history of negation", "journal": "University of Chicago Press Chicago", "year": "1989", "authors": "L R Horn"}, {"ref_id": "b13", "title": "Improving Word Representations via Global Context and Multiple Word Prototypes", "journal": "", "year": "2012", "authors": "E H Huang; R Socher; C D Manning; A Y Ng"}, {"ref_id": "b14", "title": "Minimizers, maximizers, and the rhetoric of scalar reasoning", "journal": "Journal of Semantics", "year": "2001", "authors": "M Israel"}, {"ref_id": "b15", "title": "A latent factor model for highly multi-relational data", "journal": "", "year": "2012", "authors": "R Jenatton; N Le Roux; A Bordes; G Obozinski"}, {"ref_id": "b16", "title": "Accurate unlexicalized parsing", "journal": "", "year": "2003", "authors": "D Klein; C D Manning"}, {"ref_id": "b17", "title": "If's, and's, and but's about conjunction", "journal": "", "year": "1971", "authors": "R Lakoff"}, {"ref_id": "b18", "title": "", "journal": "", "year": "", "authors": "Rinehart Holt; Winston "}, {"ref_id": "b19", "title": "Information, relevance, and social decisionmaking: Some principles and results of decisiontheoretic semantics", "journal": "", "year": "1999", "authors": "A Merin"}, {"ref_id": "b20", "title": "Composition in distributional models of semantics", "journal": "Cognitive Science", "year": "2010", "authors": "J Mitchell; M Lapata"}, {"ref_id": "b21", "title": "Sentiment composition", "journal": "", "year": "2007", "authors": "K Moilanen; S Pulman"}, {"ref_id": "b22", "title": "Dependency tree-based sentiment classification using CRFs with hidden variables", "journal": "", "year": "2010", "authors": "T Nakagawa; K Inui; S Kurohashi"}, {"ref_id": "b23", "title": "Dependency-based construction of semantic space models", "journal": "Computational Linguistics", "year": "2007", "authors": "S Pado; M Lapata"}, {"ref_id": "b24", "title": "Seeing stars: Exploiting class relationships for sentiment categorization with respect to rating scales", "journal": "", "year": "2005", "authors": "B Pang; L Lee"}, {"ref_id": "b25", "title": "Opinion mining and sentiment analysis. Foundations and Trends in Information Retrieval", "journal": "", "year": "2008", "authors": "B Pang; L Lee"}, {"ref_id": "b26", "title": "Holographic reduced representations", "journal": "IEEE Transactions on Neural Networks", "year": "1995", "authors": "T A Plate"}, {"ref_id": "b27", "title": "Contextual valence shifters", "journal": "", "year": "2006", "authors": "L Polanyi; A Zaenen"}, {"ref_id": "b28", "title": "Recursive distributed representations", "journal": "Artificial Intelligence", "year": "1990-11", "authors": "J B Pollack"}, {"ref_id": "b29", "title": "Factored 3-Way Restricted Boltzmann Machines For Modeling Natural Images", "journal": "AISTATS", "year": "2010", "authors": "M Ranzato; A Krizhevsky; G E Hinton"}, {"ref_id": "b30", "title": "United we stand: Improving sentiment analysis by joining machine learning and rule based methods", "journal": "", "year": "2010", "authors": "V Rentoumi; S Petrakis; M Klenner; G A Vouros; V Karkaletsis"}, {"ref_id": "b31", "title": "Compositional matrix-space models of language", "journal": "", "year": "2010", "authors": "S Rudolph; E Giesbrecht"}, {"ref_id": "b32", "title": "Multiple aspect ranking using the Good Grief algorithm", "journal": "", "year": "2007", "authors": "B Snyder; R Barzilay"}, {"ref_id": "b33", "title": "Learning continuous phrase representations and syntactic parsing with recursive neural networks", "journal": "", "year": "2010", "authors": "R Socher; C D Manning; A Y Ng"}, {"ref_id": "b34", "title": "Parsing Natural Scenes and Natural Language with Recursive Neural Networks", "journal": "", "year": "2011", "authors": "R Socher; C Lin; A Y Ng; C D Manning"}, {"ref_id": "b35", "title": "Semi-Supervised Recursive Autoencoders for Predicting Sentiment Distributions", "journal": "", "year": "2011", "authors": "R Socher; J Pennington; E H Huang; A Y Ng; C D Manning"}, {"ref_id": "b36", "title": "Semantic compositionality through recursive matrixvector spaces", "journal": "", "year": "2012", "authors": "R Socher; B Huval; C D Manning; A Y Ng"}, {"ref_id": "b37", "title": "Modelling relational data using Bayesian clustered tensor factorization", "journal": "", "year": "2009", "authors": "I Sutskever; R Salakhutdinov; J B Tenenbaum"}, {"ref_id": "b38", "title": "From frequency to meaning: Vector space models of semantics", "journal": "Journal of Artificial Intelligence Research", "year": "2010", "authors": "P D Turney; P Pantel"}, {"ref_id": "b39", "title": "A system for real-time twitter sentiment analysis of 2012 u.s. presidential election cycle", "journal": "", "year": "2012", "authors": "H Wang; D Can; A Kazemzadeh; F Bar; S Narayanan"}, {"ref_id": "b40", "title": "Semantic vector products: Some initial investigations", "journal": "", "year": "2008", "authors": "D Widdows"}, {"ref_id": "b41", "title": "Compositional matrix-space models for sentiment analysis", "journal": "", "year": "2011", "authors": "A Yessenalina; C Cardie"}, {"ref_id": "b42", "title": "Large vocabulary speech recognition using deep tensor neural networks", "journal": "", "year": "2012", "authors": "D Yu; L Deng; F Seide"}, {"ref_id": "b43", "title": "Estimating linear models for compositional distributional semantics", "journal": "", "year": "2010", "authors": "M Zanzotto; I Korkontzelos; F Fallucchi; S Manandhar"}, {"ref_id": "b44", "title": "Learning to map sentences to logical form: Structured classification with probabilistic categorial grammars", "journal": "", "year": "2005", "authors": "L Zettlemoyer; M Collins"}], "figures": [{"figure_label": "3", "figure_type": "figure", "figure_id": "fig_1", "figure_caption": "Figure 3 :3Figure3: The labeling interface. Random phrases were shown and annotators had a slider for selecting the sentiment and its degree.", "figure_data": ""}, {"figure_label": "", "figure_type": "figure", "figure_id": "fig_2", "figure_caption": "values for (a) unigrams, (b) 10-grams, (c) 20-grams, and (d) full sentences.", "figure_data": ""}, {"figure_label": "2", "figure_type": "figure", "figure_id": "fig_3", "figure_caption": "Figure 2 :2Figure 2: Normalized histogram of sentiment annotations at each n-gram length. Many shorter n-grams are neutral; longer phrases are well distributed. Few annotators used slider positions between ticks or the extreme values. Hence the two strongest labels and intermediate tick positions are merged into 5 classes.", "figure_data": ""}, {"figure_label": "4", "figure_type": "figure", "figure_id": "fig_4", "figure_caption": "Figure 4 :4Figure4: Approach of Recursive Neural Network models for sentiment: Compute parent vectors in a bottom up fashion using a compositionality function g and use node vectors as features for a classifier at that node. This function varies for the different models.", "figure_data": ""}, {"figure_label": "5", "figure_type": "figure", "figure_id": "fig_5", "figure_caption": "Figure 5 :5Figure 5: A single layer of the Recursive Neural Tensor Network. Each dashed box represents one of d-many slices and can capture a type of influence a child can have on its parent.", "figure_data": ""}, {"figure_label": "6", "figure_type": "figure", "figure_id": "fig_6", "figure_caption": "Figure 6 :6Figure 6: Accuracy curves for fine grained sentiment classification at each n-gram lengths. Left: Accuracy separately for each set of n-grams. Right: Cumulative accuracy of all \u2264 n-grams.", "figure_data": ""}, {"figure_label": "7", "figure_type": "figure", "figure_id": "fig_8", "figure_caption": "Figure 7 :7Figure 7: Example of correct prediction for contrastive conjunction X but Y .", "figure_data": ""}, {"figure_label": "10", "figure_type": "figure", "figure_id": "fig_10", "figure_caption": "Figure 10 :10Figure 10: Average ground truth sentiment of top 10 most positive n-grams at various n. The RNTN correctly picks the more negative and positive examples.", "figure_data": ""}, {"figure_label": "", "figure_type": "table", "figure_id": "tab_1", "figure_caption": "Figure 9: RNTN prediction of positive and negative (bottom right) sentences and their negation.", "figure_data": "ModelAccuracyNegated Positive Negated NegativebiNB19.027.3RNN33.345.5MV-RNN52.454.6RNTN71.481.8"}, {"figure_label": "2", "figure_type": "table", "figure_id": "tab_2", "figure_caption": "Accuracy of negation detection. Negated positive is measured as correct sentiment inversions. Negated negative is measured as increases in positive activations. curacy in terms of how often each model was able to increase non-negative activation in the sentiment of the sentence. Table2(right) shows the accuracy. In over 81% of cases, the RNTN correctly increases the positive activations. Fig.9(bottom right) shows a typical case in which sentiment was made more positive by switching the main class from negative to neutral even though both not and dull were negative. Fig.8shows the changes in activation for both sets. Negative values indicate a decrease in aver-Figure 8: Change in activations for negations. Only the RNTN correctly captures both types. It decreases positive sentiment more when it is negated and learns that negating negative phrases (such as not terrible) should increase neutral and positive activations.", "figure_data": ""}, {"figure_label": "3", "figure_type": "table", "figure_id": "tab_3", "figure_caption": "Examples of n-grams for which the RNTN predicted the most positive and most negative responses.", "figure_data": ""}], "formulas": [{"formula_id": "formula_0", "formula_text": "y a = softmax(W s a),(1)", "formula_coordinates": [4.0, 379.14, 486.14, 160.86, 13.13]}, {"formula_id": "formula_1", "formula_text": "p 1 = f W b c , p 2 = f W a p 1 ,", "formula_coordinates": [5.0, 87.9, 91.09, 195.01, 24.18]}, {"formula_id": "formula_2", "formula_text": "p 1 = f W Cb Bc , P 1 = f W M B C ,", "formula_coordinates": [5.0, 320.65, 164.87, 211.91, 23.12]}, {"formula_id": "formula_3", "formula_text": "V [i] \u2208 R d\u00d7d : h = b c T V [1:d] b c ; h i = b c T V [i] b c .", "formula_coordinates": [5.0, 314.78, 620.48, 223.64, 48.59]}, {"formula_id": "formula_4", "formula_text": "p 1 = f b c T V [1:d] b c + W b c ,", "formula_coordinates": [6.0, 92.4, 352.92, 186.0, 27.44]}, {"formula_id": "formula_5", "formula_text": "p 2 = f a p 1 T V [1:d] a p 1 + W a p 1 .", "formula_coordinates": [6.0, 84.15, 448.41, 202.5, 28.5]}, {"formula_id": "formula_6", "formula_text": "E(\u03b8) = i j t i j log y i j + \u03bb \u03b8 2 (2)", "formula_coordinates": [6.0, 352.19, 259.11, 187.82, 24.58]}, {"formula_id": "formula_7", "formula_text": "\u03b4 i,s = W T s (y i \u2212 t i ) \u2297 f (x i ),", "formula_coordinates": [6.0, 356.64, 409.73, 139.91, 14.19]}, {"formula_id": "formula_8", "formula_text": "\u2202E p 2 \u2202V [k] = \u03b4 p 2 ,com k a p 1 a p 1 T ,", "formula_coordinates": [6.0, 351.69, 644.19, 151.02, 28.63]}, {"formula_id": "formula_9", "formula_text": "\u03b4 p 2 ,down = W T \u03b4 p 2 ,com + S \u2297 f a p 1 ,", "formula_coordinates": [7.0, 77.93, 85.22, 214.93, 24.18]}, {"formula_id": "formula_10", "formula_text": "S = d k=1 \u03b4 p 2 ,com k V [k] + V [k] T a p 1", "formula_coordinates": [7.0, 89.0, 143.61, 181.57, 33.98]}, {"formula_id": "formula_11", "formula_text": "\u03b4 p 1 ,com = \u03b4 p 1 ,s + \u03b4 p 2 ,down [d + 1 : 2d],", "formula_coordinates": [7.0, 100.26, 238.82, 170.28, 12.07]}, {"formula_id": "formula_12", "formula_text": "\u2202E \u2202V [k] = E p 2 \u2202V [k] + \u03b4 p 1 ,com k b c b c T ,", "formula_coordinates": [7.0, 95.62, 353.85, 180.75, 28.63]}], "doi": ""}