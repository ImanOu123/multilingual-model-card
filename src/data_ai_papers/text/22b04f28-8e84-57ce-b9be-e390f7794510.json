{"title": "Analysis of Empirical Bayesian Methods for Neuroelectromagnetic Source Localization", "authors": "David Wipf; Rey Ram\u00edrez; Jason Palmer; Scott Makeig; Bhaskar Rao", "pub_date": "", "abstract": "The ill-posed nature of the MEG/EEG source localization problem requires the incorporation of prior assumptions when choosing an appropriate solution out of an infinite set of candidates. Bayesian methods are useful in this capacity because they allow these assumptions to be explicitly quantified. Recently, a number of empirical Bayesian approaches have been proposed that attempt a form of model selection by using the data to guide the search for an appropriate prior. While seemingly quite different in many respects, we apply a unifying framework based on automatic relevance determination (ARD) that elucidates various attributes of these methods and suggests directions for improvement. We also derive theoretical properties of this methodology related to convergence, local minima, and localization bias and explore connections with established algorithms.", "sections": [{"heading": "Introduction", "text": "Magnetoencephalography (MEG) and electroencephalography (EEG) use an array of sensors to take EM field measurements from on or near the scalp surface with excellent temporal resolution. In both cases, the observed field is generated by the same synchronous, compact current sources located within the brain. Because the mapping from source activity configuration to sensor measurement is many to one, accurately determining the spatial locations of these unknown sources is extremely difficult. The relevant localization problem can be posed as follows: The measured EM signal is B \u2208 d b \u00d7n , where d b equals the number of sensors and n is the number of time points at which measurements are made. The unknown sources S \u2208 ds\u00d7n are the (discretized) current values at d s candidate locations distributed throughout the cortical surface. These candidate locations are obtained by segmenting a structural MR scan of a human subject and tesselating the gray matter surface with a set of vertices. B and S are related by the generative model\nB = LS + E, (1\n)\nwhere L is the so-called lead-field matrix, the i-th column of which represents the signal vector that would be observed at the scalp given a unit current source at the i-th vertex with a fixed orientation (flexible orientations can be incorporated by including three columns per location, one for each directional component). Multiple methods based on the physical properties of the brain and Maxwell's equations are available for this computation. Finally, E is a noise term with columns drawn independently from N (0, \u03a3 ).\nTo obtain reasonable spatial resolution, the number of candidate source locations will necessarily be much larger than the number of sensors (d s d b ). The salient inverse problem then becomes the ill-posed estimation of these activity or source regions, which are reflected by the nonzero rows of the source estimate matrix\u015c. Because the inverse model is underdetermined, all efforts at source reconstruction are heavily dependent on prior assumptions, which in a Bayesian framework are embedded in the distribution p(S). Such a prior is often considered to be fixed and known, as in the case of minimum 2 -norm approaches, minimum current estimation (MCE) [6,18], FOCUSS [2,5], and sLORETA [10]. Alternatively, a number of empirical Bayesian approaches have been proposed that attempt a form of model selection by using the data to guide the search for an appropriate prior. Examples include variational Bayesian methods [14,15], hierarchial covariance component models [4,8,11], and automatic relevance determination (ARD) [7,9,12,13,17]. While seemingly quite different in some respects, we present a generalized framework that encompasses many of these methods and points to connections between algorithms. We also analyze several theoretical properties of this framework related to computational/convergence issues, local minima, and localization bias. Overall, we envision that by providing a unifying perspective on these approaches, neuroelectromagnetic imaging practitioners will be better able to assess the relative strengths with respect to a particular application. This process also points to several promising directions for future research.", "publication_ref": ["b5", "b17", "b1", "b4", "b9", "b13", "b14", "b3", "b7", "b10", "b6", "b8", "b11", "b12", "b16"], "figure_ref": [], "table_ref": []}, {"heading": "A Generalized Bayesian Framework for Source Localization", "text": "In this section, we present a general-purpose Bayesian framework for source localization. In doing so, we focus on the common ground between many of the methods discussed above. While derived using different assumptions and methodology, they can be related via the notion of automatic relevance determination [9] and evidence maximization [7].\nTo begin we involve the noise model from (1), which fully defines the assumed likelihood p(B|S). While the unknown noise covariance can also be parameterized and estimated from the data, for simplicity we assume that \u03a3 is known and fixed. Next we adopt the following source prior for S:\np (S; \u03a3 s ) = N (0, \u03a3 s ) , \u03a3 s = d \u03b3 i=1 \u03b3 i C i , (2\n)\nwhere the distribution is understood to apply independently to each column of S.\nHere \u03b3 = [\u03b3 1 , . . . , \u03b3 d \u03b3 ]\nT is a vector of d \u03b3 nonnegative hyperparameters that control the relative contribution of each covariance basis matrix C i , all of which we assume are fixed and known. The unknown hyperparameters can be estimated from the data by first integrating out the unknown sources S giving\np(B; \u03a3 b ) = p (B|S) p (S; \u03a3 s ) dS = N (0, \u03a3 b ),(3)\nwhere \u03a3 b = \u03a3 + L\u03a3 s L T . A hyperprior p(\u03b3) can also be included if desired. This expression is then maximized with respect to the unknown hyperparameters, a process referred to as type-II maximum likelihood or evidence maximization [7,9] or restricted maximum likelihood [4]. Thus the optimization problem shifts from finding the maximum a posteriori sources given a fixed prior to finding the optimal hyperparameters of a parameterized prior. Once these estimates are obtained (computational issues will be discussed in Section 2.1), a tractable posterior distribution p(S|B;\u03a3 s ) exists in closed form, where\u03a3 s = i\u03b3 i C i . To the extent that the 'learned' prior p(S;\u03a3 s ) is realistic, this posterior quantifies regions of significant current density and point estimates for the unknown sources can be obtained by evaluating the posterior mean\nS E S|B;\u03a3 s =\u03a3 s L T \u03a3 + L\u03a3 s L T \u22121 B. (4\n)\nThe specific choice of the C i 's is crucial and can be used to reflect any assumptions about the possible distribution of current sources. It is this selection, rather than the adoption of a covariance component model per se, that primarily differentiates the many different empirical Bayesian approaches and points to novel algorithms for future study. The optimization strategy adopted for computing\u03b3, as well as the particular choice of hyperprior p(\u03b3), if any, can also be distinguishing factors.\nIn the simplest case, use of the single component \u03a3 s = \u03b3 1 C 1 = \u03b3 1 I leads to a regularized minimum-2 -norm solution. More interesting covariance component terms have been used to effect spatial smoothness, depth bias compensation, and candidate locations of likely activity [8,11]. With regard to the latter, it has been suggested that prior information about a source location can be codified by including a C i term with all zeros except a patch of 1's along the diagonal signifying a location of probable source activity, perhaps based on fMRI data [11]. An associated hyperparameter \u03b3 i is then estimated to determine the appropriate contribution of this component to the overall prior covariance. The limitation of this approach is that we generally do not know, a priori, the regions where activity is occurring with both high spatial and temporal resolution. Therefore, we cannot reliably known how to choose an appropriate location-prior term in many situations.\nThe empirical Bayesian solution to this dilemma, which amounts to a form of model selection, is to try out many different (or even all possible) combinations of location priors, and determine which one has the highest Bayesian evidence, i.e., maximizes p(B; \u03a3 b ) [7]. For example, if we assume the underlying currents are formed from a collection of dipolar point sources located at each vertex of the lead-field grid, then we may choose \u03a3 s =\nd s i=1 \u03b3 i e i e T i ,\nwhere each e i is a standard indexing vector of zeros with a '1' for the i-th element (and so C i = e i e T i encodes a prior preference for a single dipolar source at location i). 1 This specification for the prior involves the counterintuitive addition of an unknown hyperparameter for every candidate source location which, on casual analysis may seem prone to severe overfitting (in contrast to [11], which uses only one or two fixed location priors). However, the process of marginalization, or the integrating out of the unknown sources S, provides an extremely powerful regularizing effect, driving most of the unknown \u03b3 i to zero during the evidence maximization stage (more on this in Section 3). This ameliorates the overfitting problem and effectively reduces the space of possible active source locations by choosing a small relevant subset of location priors that optimizes the Bayesian evidence (hence ARD). With this 'learned' prior in place, a once ill-posed inverse problem is no longer untenable, with the posterior mean providing a good estimate of source activity. Such a procedure has been empirically successful in the context of neural networks [9], kernel machines [17], and multiple dipole fitting for MEG [12], a significant benefit to the latter being that the optimal number of dipoles need not be known a priori.\nIn contrast, to model sources with some spatial extent, we can choose C i = \u03c8 i \u03c8 T i , where each \u03c8 i represents, for example, an d s \u00d7 1 geodesic neural basis vector that specifies an a priori weight location and activity extent. In this scenario, the number of hyperparameters satisfies d \u03b3 = vd s , where v is the number of scales we wish to examine in a multi-resolution decomposition, and can be quite large (d \u03b3 \u2248 10 6 ). As mentioned above, the ARD framework tests many priors corresponding to many hypotheses or beliefs regarding the locations and scales of the nonzero current activity within the brain, ultimately choosing the one with the highest evidence. The net result of this formulation is a source prior composed of a mixture of Gaussian kernels of varying scales. The number of mixture components, or the number of nonzero \u03b3 i 's, is learned from the data and is naturally forced to be small (sparse). In general, the methodology is quite flexible and other prior specifications can be included as well, such as temporal and spectral constraints. But the essential ingredient of ARD, that marginalization and subsequent evidence maximization leads to a pruning of unsupported hypotheses, remains unchanged.\nWe turn now to empirical Bayesian procedures that incorporate variational methods. In [15], a plausible hierarchical prior is adopted that, unfortunately, leads to intractable integrations when computing the desired source posterior. This motivates the inclusion of a variational approximation that models the true posterior as a factored distribution over parameters at two levels of the prior hierarchy. While seemingly quite different, drawing on results from [1], we can show that the resulting cost function is exactly equivalent to standard ARD assuming \u03a3 s is parameterized as\n\u03a3 s = d s i=1 \u03b3 i e i e i + d s j=1 \u03b3 (d s +j) \u03c8 j \u03c8 T j ,(5)\nand so d \u03b3 = 2d s . When fMRI data is available, it is incorporated into a particular inverse Gamma hyperprior on \u03b3, as is also commonly done with ARD methods [1]. Optimization is then performed using simple EM update rules.\nIn summary then, the general methods of [4,8,11] and [12,13,17] as well as the variational method of [15] are all identical with respect to their ARD-based cost functions; they differ only in which covariance components (and possibly hyperpriors) are used and in how optimization is performed as will be discussed below. In contrast, the variational model from [14] introduces an additional hierarchy to the ARD framework to explicitly model correlations between sources which may be spatially separated. 2 Here it is assumed that S can be decomposed with respect to d z pre-sources via S = W Z, p(W ; \u03a3 w ) = N (0, \u03a3 w ), p(Z) = N (0, I), (\nwhere Z \u2208 d z \u00d7n represents the pre-source matrix and \u03a3 w is analogous to \u03a3 s . As stated in [14], direct application of ARD would involve integration over W and Z to find the hyperparameters \u03b3 that maximize p(B; \u03a3 b ). While such a procedure is not analytically tractable, it remains insightful to explore the characteristics of this method were we able to perform the necessary computation. This allows us to relate the full model of [14] to standard ARD.\nInterestingly, it can be shown that the first and second order statistics of the full prior ( 6) and the standard ARD prior (2) are equivalent (up to a constant factor), although higher-order moments will be different. However, as the number of pre-sources d z becomes large, multivariate centrallimit-theorem arguments can be used to explicitly show that the distribution of S converges to an identical Gaussian prior as ARD. So exact evaluation of the full model, which is espoused as the ideal objective were it feasible, approaches regular ARD when the number of pre-sources grows large. In practice, because the full model is intractable, a variational approximation is adopted similar to that proposed in [15]. In fact, if we assume the appropriate hyperprior on \u03b3, then this correlated source method is essentially the same as the procedure from [15] but with an additional level in the approximate posterior factorization for handling the decomposition (6). This produces approximate posteriors on W and Z but the result cannot be integrated to form the posterior on S. However, the posterior mean of W ,\u0174 , is used as an estimate of the source correlation matrix (using\u0174\u0174 T ) to substantially improve beamforming results that were errantly based on uncorrelated source models. Note however that this procedure implicitly uses the somewhat peculiar criteria of combining the posterior mean of W with the prior on Z to form an estimate of the distribution of S.", "publication_ref": ["b8", "b6", "b0", "b6", "b8", "b3", "b7", "b10", "b10", "b6", "b0", "b10", "b8", "b16", "b11", "b14", "b0", "b0", "b3", "b7", "b10", "b11", "b12", "b16", "b14", "b13", "b1", "b13", "b13", "b14", "b14", "b5"], "figure_ref": [], "table_ref": []}, {"heading": "Computational Issues", "text": "The primary objective of ARD is to maximize the evidence p(B; \u03a3 b ) with respect to \u03b3 or equivalently, to minimize\nL(\u03b3) \u2212 log p(B; \u03a3 b ) \u2261 log |\u03a3 b | + trace B T \u03a3 \u22121 b B . (7\n)\nIn [4], a restricted maximum likelihood (ReML) approach is proposed for this optimization, which utilizes what amounts to EM-based updates. This method typically requires a nonlinear search for each M-step and does not guarantee that the estimated covariance is positive definite. While shown to be successful in estimating a handful of hyperparameters in [8,11], this could potentially be problematic when very large numbers of hyperparameters are present. For example, in several toy problems (with d \u03b3 large) we have found that a fraction of the hyperparameters obtained can be negative-valued, inconsistent with our initial premise.\nAs such, we present three alternative optimization procedures that extend the methods from [7,12,15,17] to the arbitrary covariance model discussed above and guarantee that \u03b3 i \u2265 0 for all i.\nBecause of the flexibility this allows in constructing \u03a3 s , and therefore \u03a3 b , some additional notation is required to proceed. A new decomposition of \u03a3 b is defined as\n\u03a3 b = \u03a3 + L \uf8eb \uf8ed d\u03b3 i=1 \u03b3 i C i \uf8f6 \uf8f8 L T = \u03a3 + d\u03b3 i=1 \u03b3 i L i L T i , (8\n)\nwhere L i L T i LC i L T with r i rank( L i L T i ) \u2264 d b .\nAlso, using commutative properties of the trace operator, L(\u03b3) only depends on the data B through the d b \u00d7d b sample correlation matrix BB T . Therefore, to reduce the computational burden, we replace B with a matrix B \u2208 d b \u00d7rank(B) such that B B T = BB T . This removes any per-iteration dependency on n, which can potentially be large, without altering that actual cost function.\nBy treating the unknown sources as hidden data, an update can be derived for the (k + 1)-th iteration\n\u03b3 (k+1) i = 1 nr i \u03b3 (k) i L T i \u03a3 (k) b \u22121 B 2 F + 1 r i trace \u03b3 (k) i I \u2212 \u03b3 (k) i L T i \u03a3 (k) b \u22121 L i \u03b3 (k) i , (9\n)\nwhich reduces to the algorithm from [15] given the appropriate simplifying assumptions on the form of \u03a3 s and some additional algebraic manipulations. It is also equivalent to ReML with a different effective computation for the M-step. By casting the update rules in this way and noting that off-diagonal elements of the second term need not be computed, the per-iteration cost is at\nmost O d 2 b d \u03b3 i=1 r i \u2264 O d 3 b d \u03b3 .\nThis expense can be significantly reduced still further in cases where different pseudo lead-field components, e.g., some L i and L j , contain one or more columns in common. This situation occurs if we desire to use the geodesic basis functions with flexible orientation constraints, as opposed to the fixed orientations assumed above. In general, the linear dependence on d \u03b3 is one of the attractive aspects of this method, effectively allowing for extremely large numbers of hyperparameters and covariance components.\nThe problem then with ( 9) is not the per-iteration complexity but the convergence rate, which we have observed to be prohibitively slow in practical situations with high-resolution lead-field matrices and large numbers of hyperparameters. The only reported localization results using this type of EM algorithm are from [15], where a relatively low resolution lead-field matrix is used in conjunction with a simplifying heuristic that constrains some of the hyperparameter values. However, to avoid these types of constraints, which can potentially degrade the quality of source estimates, a faster update rule is needed. To this end, we modified the procedure of [7], which involves taking the gradient of L(\u03b3) with respect to \u03b3, rearranging terms, and forming the fixed-point update\n\u03b3 (k+1) i = \u03b3 (k) i n L T i \u03a3 (k) b \u22121 B 2 F trace L T i \u03a3 (k) b \u22121 L i \u22121 . (10\n)\nThe complexity of each iteration is the same as before, only now the convergence rate can be orders of magnitude faster. For example, given d b = 275 sensors, n = 1000 observation vectors, and using a pseudo lead-field with 120,000 unique columns and an equal number of hyperparameters, requires approximately 5-10 mins. runtime using Matlab code on a PC to completely converge. The EM update does not converge after 24 hours. Example localization results using (10) demonstrate the ability to recover very complex source configurations with variable spatial extent [13].\nUnlike the EM method, one criticism of ( 10) is that there currently exists no proof that it represents a descent function, although we have never observed it to increase (7) in practice. While we can show that ( 10) is equivalent to iteratively solving a particular min-max problem in search of a saddle point, provable convergence is still suspect. However, a similar update rule can be derived that is both significantly faster than EM and is proven to produce \u03b3 vectors such that L \u03b3 (k+1) \u2264 L \u03b3 (k) for every iteration k. Using a dual-form representation of L(\u03b3) that leads to a more tractable auxiliary cost function, this update is given by\n\u03b3 (k+1) i = \u03b3 (k) i \u221a n L T i \u03a3 (k) b \u22121B F trace L T i \u03a3 (k) b \u22121 L i \u22121/2 . (11\n)\nDetails of the derivation can be found in [20].\nFinally, the correlated source method from [14] can be incorporated into the general ARD framework as well using update rules related to the above; however, because all off-diagonal terms are required by this method, the iterations now scale as ( i r i ) 2 in the general case. This quadratic dependence can be prohibitive in applications with large numbers of covariance components.", "publication_ref": ["b3", "b7", "b10", "b6", "b11", "b14", "b16", "b14", "b14", "b6", "b12", "b6", "b19", "b13"], "figure_ref": [], "table_ref": []}, {"heading": "Relationship with Other Bayesian Methods", "text": "As a point of comparison, we now describe how ARD can be related to alternative Bayesian-inspired approaches such as the sLORETA paradigm [10] and the iterative FOCUSS source localization algorithm [5]. The connection is most transparent when we substitute the prior covariance \u03a3 s = ds i=1 \u03b3 i e i e T i = \u0393 into (10), giving the modified update\n\u03b3 (k+1) i = \u03b3 (k) i T i \u03a3 + L\u0393 (k) L T \u22121 B 2 2 nR (k) ii \u22121 , R (k) \u0393 (k) L T \u03a3 + L\u0393 (k) L T \u22121 L,(12)\nwhere \u0393 diag[\u03b3], i is the i-th column of L, and R (k) is the effective resolution matrix given the hyperparameters at the current iteration. The j-th column of R (called a point-spread function) equals the source estimate obtained using (4) when the true source is a unit dipole at location j [16].\nContinuing, if we assume that initialization of ARD occurs with \u03b3 (0) = 1 (as is customary), then the hyperparameters produced after a single iteration of ARD are equivalent to computing the sLORETA estimate for standardized current density power [10] (this assumes fixed orientation constraints). In this context, the inclusion of R as a normalization factor helps to compensate for depth bias, which is the propensity for deep current sources within the brain to be underrepresented at the scalp surface [10,12]. So ARD can be interpreted as a recursive refinement of what amounts to the non-adaptive, linear sLORETA estimate.\nAs a further avenue for comparison, if we assume that R = I for all iterations, then the update ( 12) is nearly the same as the FOCUSS iterations modified to simultaneously handle multiple observation vectors [2]. The only difference is the factor of n in the denominator in the case of ARD, but this can be offset by an appropriate rescaling of the FOCUSS \u03bb trade-off parameter. Therefore, ARD can be viewed in some sense as taking the recursive FOCUSS update rules and including the sLORETA normalization that, among other things, allows for depth bias compensation.\nThus far, we have focused on similarities in update rules between the ARD formulation (restricted to the case where \u03a3 s = \u0393) and sLORETA and FOCUSS. We now switch gears and examine how the general ARD cost function relates to that of FOCUSS and MCE and suggests a useful generalization of both approaches. Recall that the evidence maximization procedure upon which ARD is based involves integrating out the unknown sources before optimizing the hyperparameters \u03b3. However, if some p(\u03b3) is assumed for \u03b3, then we could just as easily do the opposite: namely, we can integrate out the hyperparameters and then maximize S directly, thus solving the MAP estimation problem\nmax S p (B|S) p (S; \u03a3 s ) p(\u03b3)d\u03b3 \u2261 min {S:S= P i Ai e Si} B \u2212 LS 2 \u03a3 \u22121 + d \u03b3 i=1 g S i F , (13\n)\nwhere each A i is derived from the i-th covariance component such that C i = A i A T i , and g(\u2022) is a function dependent on p(\u03b3). For example, when p(\u03b3) is a noninformative Jeffreys prior, then g(x) = log x and (13) becomes a generalized form of the FOCUSS cost function (and reduces to the exact FOCUSS cost when A i = e i e T i for all i). Likewise, when an exponential prior chosen, then g(x) = x and we obtain a generalized version of MCE. In both cases, multiple simultaneous constraints (e.g., flexible dipole orientations, spatial smoothing, etc.) can be naturally handled and, if desired, the noise covariance \u03a3 can be seamlessly estimated as well (see [3] for a special case of the latter in the context of kernel regression). This addresses many of the concerns raised in [8] pertaining to existing MAP methods. Additionally, as with ARD, source components that are not sufficiently important in representing the observed data are pruned; however, the undesirable discontinuities in standard FOCUSS or MCE source estimates across time, which previously have required smoothing using heuristic measures [6], do not occur when using (13). This is because sparsity is only encouraged between components due to the concavity of g(\u2022), but not within components where the Frobenius norm operator promotes smooth solutions [2]. All of these issues, as well as efficient ARD-like update rules for optimizing (13), are discussed in [20].", "publication_ref": ["b9", "b4", "b15", "b9", "b9", "b11", "b1", "b2", "b7", "b5", "b12", "b1", "b12", "b19"], "figure_ref": [], "table_ref": []}, {"heading": "General Properties of ARD Methods", "text": "ARD methods maintain several attributes that make them desirable candidates for source localization. For example, unlike most MAP procedures, the ARD cost function is often invariant to leadfield column normalizations, which only affect the implicit initialization that is used or potentially the selection of the C i 's. In contrast, MCE produces a different globally minimizing solution for every normalization scheme. As such, ARD is considerably more robust to the particular heuristic used for this task and can readily handle deep current sources.\nPreviously, we have claimed that the ARD process naturally forces excessive/irrelevant hyperparameters to converge to zero, thereby reducing model complexity. While this observation has been verified empirically by ourselves and others in various application settings, there has been relatively little corroborating theoretical evidence, largely because of the difficulty in analyzing the potentially multimodal, non-convex ARD cost function. As such, we provide the following result: Result 1. Every local minimum of the generalized ARD cost function ( 7) is achieved at a solution with at most rank(B)d b \u2264 d 2 b nonzero hyperparameters. The proof follows from a result in [19] and the fact that the ARD cost only depends on the rank(B) matrix BB T . Result 1 comprises a worst-case bound that is only tight in very nuanced situations; in practice, for any reasonable value of \u03a3 , the number of nonzero hyperparameters is typically much smaller than d b . The bound holds for all \u03a3 , including \u03a3 = 0, indicating that some measure of hyperparameter pruning, and therefore covariance component pruning, is built into the ARD framework irrespective of the noise-based regularization. Moreover, the number of nonzero hyperparameters decreases monotonically to zero as \u03a3 is increased. And so there is always some \u03a3 = \u03a3 sufficiently large such that all hyperparameters converge to exactly zero. Therefore, we can be reasonable confident that the pruning mechanism of ARD is not merely an empirical phenomena. Nor is it dependent on a particular sparse hyperprior, since the ARD cost from (7) implicitly assumes a flat (uniform) hyperprior.\nThe number of observation vectors n also plays an important role in shaping ARD solutions. Increasing n has two primary benefits: (i) it facilitates convergence to the global minimum (as opposed to getting stuck in a suboptimal extrema) and (ii), it improves the quality of this minimum by mitigating the effects of noise [20]. With perfectly correlated (spatially separated) sources, primarily only the later benefit is in effect. For example, with low noise and perfectly correlated sources, the estimation problem reduces to an equivalent problem with n = 1, so the local minima profile of the cost function does not improve with increasing n. Of course standard ARD can still be very effective in this scenario [13]. In contrast, geometric arguments can be made to show that uncorrelated sources with large n offer the best opportunity for local minima avoidance. However, when strong correlations are present as well as high noise levels, the method of [14] (which explicitly attempts to model correlations) could offer a worthwhile alternative, albeit at a high computational cost.\nFurther theoretical support for ARD is possible in the context of localization bias assuming simple source configurations. For example, substantial import has been devoted to quantifying localization bias when estimating a single dipolar source. Recently it has been shown, both empirically [10] and theoretically [16], that sLORETA has zero location bias under this condition at high SNR. Viewed then as an iterative enhancement of sLORETA as described in Section 2.2, the question naturally arises whether ARD methods retain this desirable property. In fact, it can be shown that this is indeed the case in two general situations. We assume that the lead-field matrix L represents a sufficiently high sampling of the source space such that any active dipole aligns with some lead-field column. Unbiasedness can also be shown in the continuous case for both sLORETA and ARD, but the discrete scenario is more straightforward and of course more relevant to any practical task.", "publication_ref": ["b18", "b19", "b12", "b13", "b9", "b15"], "figure_ref": [], "table_ref": []}, {"heading": "Result 2. Assume that \u03a3 s includes (among others) d s covariance components of the form", "text": "C i = e i e T i .\nThen in the absence of noise (high SNR), ARD has provably zero localization bias when estimating a single dipolar source, regardless of the value of n.\nIf we are willing to tolerate some additional assumptions, then this result can be significantly expanded. For example, multiple dipolar sources can be localized with zero bias if they are perfectly uncorrelated (orthogonal) across time and assuming some mild technical conditions [20]. This result also formalizes the notion, mentioned above, that ARD performs best with uncorrelated sources. Turning to the more realistic scenario where noise is present gives the following. Result 3. Let \u03a3 s be constructed as above and assume the noise covariance matrix \u03a3 is known up to a scale factor. Then given a single dipolar source, in the limit as n becomes large the ARD cost function is unimodal, and a source estimate with zero localization bias achieves the global minimum.\nFor most reasonable lead-fields and covariance components, this global minimum will be unique, and so the unbiased solution will be found as in the noiseless case. As for proofs, all the theoretical results pertaining to localization bias in this section follow from local minima properties of ML covariance component estimates. While details have been deferred to [20], the basic idea is that if the outerproduct BB T can be expressed as some non-negative linear combination of the available covariance components, then the ARD cost function is unimodal and \u03a3 b = n \u22121 BB T at any minimizing solution. This \u03a3 b in turn produces unbiased source estimates in a variety of situations.\nWhile theoretical results of this kind are admittedly limited, other iterative Bayesian schemes in fact fail to exhibit similar performance. For example, all of the MAP-based focal algorithms we are aware of, including FOCUSS and MCE methods, provably maintain a localization bias in the general setting, although in particular cases they may not exhibit one. (Also, because of the additional complexity involved, it is still unclear whether the correlated source method of [14] satisfies a similar result.) When we move to more complex source configurations with possible correlations and noise, theoretical results are not available; however, empirical tests provide a useful means of comparison. For example, given a 275 \u00d7 40, 000 lead-field matrix constructed from an MR scan and assuming fixed orientation constraints and a spherical head model, ARD using \u03a3 s = diag(\u03b3) and n = 1 (equivalent to having perfectly correlated sources) consistently maintains zero empirical localization bias when estimating up to 15-20 dipoles, while sLORETA starts to show a bias with only a few.", "publication_ref": ["b19", "b19", "b13"], "figure_ref": [], "table_ref": []}, {"heading": "Discussion", "text": "The efficacy of modern empirical Bayesian techniques and variational approximations make them attractive candidates for source localization. However, it is not always transparent how these methods relate nor which should be expected to perform best in various situations. By developing a general framework around the notion of ARD, deriving several theoretical properties, and showing connections between algorithms, we hope to bring an insightful perspective to these techniques.", "publication_ref": [], "figure_ref": [], "table_ref": []}], "references": [{"ref_id": "b0", "title": "Variational relevance vector machines", "journal": "", "year": "2000", "authors": "C M Bishop; M E Tipping"}, {"ref_id": "b1", "title": "Sparse solutions to linear inverse problems with multiple measurement vectors", "journal": "IEEE Trans. Sig. Proc", "year": "2005", "authors": "S F Cotter; B D Rao; K Engan; K Kreutz-Delgado"}, {"ref_id": "b2", "title": "Adaptive sparseness using Jeffreys prior", "journal": "Advances in Neural Information Processing Systems", "year": "2002", "authors": "M A T Figueiredo"}, {"ref_id": "b3", "title": "Classical and Bayesian inference in neuroimaging: Theory", "journal": "NeuroImage", "year": "2002", "authors": "K Friston; W Penny; C Phillips; S Kiebel; G Hinton; J Ashburner"}, {"ref_id": "b4", "title": "Neuromagnetic source imaging with FOCUSS: A recursive weighted minimum norm algorithm", "journal": "J. Electroencephalography and Clinical Neurophysiology", "year": "1995", "authors": "I F Gorodnitsky; J S George; B D Rao"}, {"ref_id": "b5", "title": "Vector-based spatial-temporal minimum 1 -norm solution for MEG", "journal": "NeuroImage", "year": "2006", "authors": "M Huang; A Dale; T Song; E Halgren; D Harrington; I Podgorny; J Canive; S Lewis; R Lee"}, {"ref_id": "b6", "title": "Bayesian interpolation", "journal": "Neural Computation", "year": "1992", "authors": "D J C Mackay"}, {"ref_id": "b7", "title": "MEG source localization under multiple constraints: An extended Bayesian framework", "journal": "NeuroImage", "year": "2006", "authors": "J Mattout; C Phillips; W D Penny; M D Rugg; K J Friston"}, {"ref_id": "b8", "title": "Bayesian Learning for Neural Networks", "journal": "Springer-Verlag", "year": "1996", "authors": "R M Neal"}, {"ref_id": "b9", "title": "Standardized low resolution brain electromagnetic tomography (sLORETA): Technical details", "journal": "Methods and Findings in Experimental and Clinical Pharmacology", "year": "2002", "authors": "R D Pascual-Marqui"}, {"ref_id": "b10", "title": "An empirical Bayesian solution to the source reconstruction problem in EEG", "journal": "NeuroImage", "year": "2005", "authors": "C Phillips; J Mattout; M D Rugg; P Maquet; K J Friston"}, {"ref_id": "b11", "title": "Neuromagnetic Source Imaging of Spontaneous and Evoked Human Brain Dynamics", "journal": "", "year": "2005", "authors": "R R Ram\u00edrez"}, {"ref_id": "b12", "title": "Neuroelectromagnetic source imaging using multiscale geodesic neural bases and sparse Bayesian learning", "journal": "", "year": "2006", "authors": "R R Ram\u00edrez; S Makeig"}, {"ref_id": "b13", "title": "Reconstructing MEG sources with unknown correlations", "journal": "MIT Press", "year": "2004", "authors": "M Sahani; S S Nagarajan"}, {"ref_id": "b14", "title": "Hierarchical Bayesian estimation for MEG inverse problem", "journal": "NeuroImage", "year": "2004", "authors": "M Sato; T Yoshioka; S Kajihara; K Toyama; N Goda; K Doya; M Kawato"}, {"ref_id": "b15", "title": "Localization bias and spatial resolution of adaptive and non-adaptive spatial filters for MEG source reconstruction", "journal": "NeuroImage", "year": "2005", "authors": "K Sekihara; M Sahani; S S Nagarajan"}, {"ref_id": "b16", "title": "Sparse Bayesian learning and the relevance vector machine", "journal": "J. Machine Learning Research", "year": "2001", "authors": "M E Tipping"}, {"ref_id": "b17", "title": "Visualization of magnetoencephalographic data using minimum current estimates", "journal": "NeuroImage", "year": "1999", "authors": "K Uutela; M H\u00e4m\u00e4l\u00e4inen; E Somersalo"}, {"ref_id": "b18", "title": "Sparse Bayesian learning for basis selection", "journal": "IEEE Trans. Sig. Proc", "year": "2004", "authors": "D P Wipf; B D Rao"}, {"ref_id": "b19", "title": "Automatic Relevance Determination for Source Localization with MEG and EEG Data", "journal": "", "year": "2006", "authors": "D P Wipf; R R Ram\u00edrez; J A Palmer; S Makeig; B D Rao"}], "figures": [], "formulas": [{"formula_id": "formula_0", "formula_text": "B = LS + E, (1", "formula_coordinates": [1.0, 278.05, 544.83, 222.08, 10.63]}, {"formula_id": "formula_1", "formula_text": ")", "formula_coordinates": [1.0, 500.13, 546.49, 3.87, 8.97]}, {"formula_id": "formula_2", "formula_text": "p (S; \u03a3 s ) = N (0, \u03a3 s ) , \u03a3 s = d \u03b3 i=1 \u03b3 i C i , (2", "formula_coordinates": [2.0, 219.54, 306.66, 280.59, 32.61]}, {"formula_id": "formula_3", "formula_text": ")", "formula_coordinates": [2.0, 500.13, 319.32, 3.87, 8.97]}, {"formula_id": "formula_4", "formula_text": "Here \u03b3 = [\u03b3 1 , . . . , \u03b3 d \u03b3 ]", "formula_coordinates": [2.0, 108.0, 344.02, 396.0, 22.92]}, {"formula_id": "formula_5", "formula_text": "p(B; \u03a3 b ) = p (B|S) p (S; \u03a3 s ) dS = N (0, \u03a3 b ),(3)", "formula_coordinates": [2.0, 206.25, 404.58, 297.76, 11.35]}, {"formula_id": "formula_6", "formula_text": "S E S|B;\u03a3 s =\u03a3 s L T \u03a3 + L\u03a3 s L T \u22121 B. (4", "formula_coordinates": [2.0, 205.89, 533.08, 294.24, 17.81]}, {"formula_id": "formula_7", "formula_text": ")", "formula_coordinates": [2.0, 500.13, 541.2, 3.87, 8.97]}, {"formula_id": "formula_8", "formula_text": "d s i=1 \u03b3 i e i e T i ,", "formula_coordinates": [3.0, 285.3, 141.34, 46.65, 15.32]}, {"formula_id": "formula_9", "formula_text": "\u03a3 s = d s i=1 \u03b3 i e i e i + d s j=1 \u03b3 (d s +j) \u03c8 j \u03c8 T j ,(5)", "formula_coordinates": [3.0, 229.22, 526.63, 274.78, 31.64]}, {"formula_id": "formula_11", "formula_text": "L(\u03b3) \u2212 log p(B; \u03a3 b ) \u2261 log |\u03a3 b | + trace B T \u03a3 \u22121 b B . (7", "formula_coordinates": [4.0, 192.09, 380.39, 308.04, 14.58]}, {"formula_id": "formula_12", "formula_text": ")", "formula_coordinates": [4.0, 500.13, 383.77, 3.87, 8.97]}, {"formula_id": "formula_13", "formula_text": "\u03a3 b = \u03a3 + L \uf8eb \uf8ed d\u03b3 i=1 \u03b3 i C i \uf8f6 \uf8f8 L T = \u03a3 + d\u03b3 i=1 \u03b3 i L i L T i , (8", "formula_coordinates": [4.0, 200.93, 526.22, 299.21, 41.65]}, {"formula_id": "formula_14", "formula_text": ")", "formula_coordinates": [4.0, 500.13, 547.91, 3.87, 8.97]}, {"formula_id": "formula_15", "formula_text": "where L i L T i LC i L T with r i rank( L i L T i ) \u2264 d b .", "formula_coordinates": [4.0, 108.0, 578.35, 220.91, 13.53]}, {"formula_id": "formula_16", "formula_text": "\u03b3 (k+1) i = 1 nr i \u03b3 (k) i L T i \u03a3 (k) b \u22121 B 2 F + 1 r i trace \u03b3 (k) i I \u2212 \u03b3 (k) i L T i \u03a3 (k) b \u22121 L i \u03b3 (k) i , (9", "formula_coordinates": [4.0, 123.15, 662.9, 376.98, 29.27]}, {"formula_id": "formula_17", "formula_text": ")", "formula_coordinates": [4.0, 500.13, 674.01, 3.87, 8.97]}, {"formula_id": "formula_18", "formula_text": "most O d 2 b d \u03b3 i=1 r i \u2264 O d 3 b d \u03b3 .", "formula_coordinates": [5.0, 108.0, 92.75, 143.23, 15.54]}, {"formula_id": "formula_19", "formula_text": "\u03b3 (k+1) i = \u03b3 (k) i n L T i \u03a3 (k) b \u22121 B 2 F trace L T i \u03a3 (k) b \u22121 L i \u22121 . (10", "formula_coordinates": [5.0, 167.47, 264.46, 332.39, 29.27]}, {"formula_id": "formula_20", "formula_text": ")", "formula_coordinates": [5.0, 499.85, 275.56, 4.15, 8.97]}, {"formula_id": "formula_21", "formula_text": "\u03b3 (k+1) i = \u03b3 (k) i \u221a n L T i \u03a3 (k) b \u22121B F trace L T i \u03a3 (k) b \u22121 L i \u22121/2 . (11", "formula_coordinates": [5.0, 163.44, 448.66, 336.42, 29.27]}, {"formula_id": "formula_22", "formula_text": ")", "formula_coordinates": [5.0, 499.85, 459.77, 4.15, 8.97]}, {"formula_id": "formula_23", "formula_text": "\u03b3 (k+1) i = \u03b3 (k) i T i \u03a3 + L\u0393 (k) L T \u22121 B 2 2 nR (k) ii \u22121 , R (k) \u0393 (k) L T \u03a3 + L\u0393 (k) L T \u22121 L,(12)", "formula_coordinates": [5.0, 108.0, 619.07, 396.45, 37.83]}, {"formula_id": "formula_24", "formula_text": "max S p (B|S) p (S; \u03a3 s ) p(\u03b3)d\u03b3 \u2261 min {S:S= P i Ai e Si} B \u2212 LS 2 \u03a3 \u22121 + d \u03b3 i=1 g S i F , (13", "formula_coordinates": [6.0, 118.42, 287.27, 381.43, 32.61]}, {"formula_id": "formula_25", "formula_text": ")", "formula_coordinates": [6.0, 499.85, 299.92, 4.15, 8.97]}, {"formula_id": "formula_26", "formula_text": "C i = e i e T i .", "formula_coordinates": [7.0, 108.0, 394.81, 396.0, 23.42]}], "doi": ""}