{"title": "A Hit-Miss Model for Duplicate Detection in the WHO Drug Safety Database", "authors": "G Niklas Nor\u00e9n; Roland Orre; Andrew Bate", "pub_date": "", "abstract": "The WHO Collaborating Centre for International Drug Monitoring in Uppsala, Sweden, maintains and analyses the world's largest database of reports on suspected adverse drug reaction incidents that occur after drugs are introduced on the market. As in other post-marketing drug safety data sets, the presence of duplicate records is an important data quality problem and the detection of duplicates in the WHO drug safety database remains a formidable challenge, especially since the reports are anonymised before submitted to the database. However, to our knowledge no work has been published on methods for duplicate detection in postmarketing drug safety data. In this paper, we propose a method for probabilistic duplicate detection based on the hit-miss model for statistical record linkage described by Copas & Hilton. We present two new generalisations of the standard hit-miss model: a hit-miss mixture model for errors in numerical record fields and a new method to handle correlated record fields. We demonstrate the effectiveness of the hit-miss model for duplicate detection in the WHO drug safety database both at identifying the most likely duplicate for a given record (94.7% accuracy) and at discriminating duplicates from random matches (63% recall with 71% precision). The proposed method allows for more efficient data cleaning in post-marketing drug safety data sets, and perhaps other applications throughout the KDD community.", "sections": [{"heading": "INTRODUCTION", "text": "The WHO Collaborating Centre for International Drug Monitoring in Uppsala, Sweden (also known as the Uppsala Monitoring Centre) holds the world's largest database of spontaneous reports on suspected adverse drug reaction (ADR) incidents. Spontaneous reports are provided to pharmaceutical companies and regulatory bodies by health professionals upon the observation of suspected ADR incidents in clinical practice. The 75 member countries of the WHO Programme for International Drug Monitoring routinely forward ADR case reports submitted to their medical products agencies to the Uppsala Monitoring Centre. The first case reports in the WHO drug safety database date back to 1967 and as of January 2005 there are over 3 million reports in total in the data set; currently around 200,000 new reports are added to the database each year.\nWhile the analysis of spontaneous reporting data is one of the most important methods for discovering previously unknown safety problems after drugs are introduced on the market [16], it is sometimes impaired by poor data quality [11], and in particular the presence of duplicate case reports. Quantitative methods are important in screening spontaneous reporting data for new drug safety problems [1], and may highlight potential problems based on as few as 3 case reports on a particular event, so the presence of just 1 or 2 duplicates may severely affect their efficacy. While there is a general consensus that the presence of duplicates is a major problem in spontaneous reporting data, there is a lack of published research with respect to the extent of the problem. A study on vaccine ADR data quoted proportions of around 5% confirmed duplicates [14]. However, at times the frequency may be much higher: in a recent review of suspected quinine induced thrombocytopenia, FDA researchers identified 28 of the 141 US case reports (20%) as duplicates [6].\nThere are at least two common causes for duplication in post-marketing drug safety data: different sources (health professionals, national authorities, different companies) may provide separate case reports related to the same event and there may be mistakes in linking follow-up case reports to earlier records. (Follow-up reports are submitted for example when the outcome of an event is discovered.) The risk of duplication is likely to have increased in recent years due to the advent of information technology that allows case reports to be sent back and forth more easily between different organisations [8], and the transfer of case reports from national centres to the WHO might introduce extra sources of error, including the risk that more than one national centre provide case reports related to the same event.\nDuplicate records are typically much more similar than random pairs of records. There are however important exceptions. For example, separate case reports are sometimes provided for the same patient recorded at the same doctor's appointment when the patient has suffered from unrelated ADRs. Such record pairs may match perfectly on date, age, gender, country and drug substances, but should not be considered as duplicates. The opposite problem is illustrated by so called mother-child reports that relate to ADR incidents in small children from medication taken by the mother during pregnancy. Such record pairs differ greatly depending on whether the patient information relates to the mother or the child.\nThe need for algorithms to systematically screen for duplicate records in drug safety data sets is clear [5]. There are no published papers in this area, but general duplicate detection methods are available [3,10,12,17]. In addition, the fundamentally similar problem of record linkage (matching records across data sets) has been studied since the 1960s [9,13]. We have chosen to develop a duplicate detection method based on the hit-miss model for statistical record linkage described by Copas & Hilton [7]. The hitmiss model has several important beneficial properties. It imposes no strict criteria that a pair of records must fulfil in order to be highlighted as suspected duplicates, which is useful for spontaneous reporting data where errors occur in all record fields. Rather than just classifying record pairs as likely duplicates or not, the hit-miss model provides a prioritisation (scoring) with respect to the chance that a given pair of records are duplicates. This allows the number of record pairs highlighted to be adjusted depending on the resources available for manual review. While the hit-miss model punishes discrepancies it rewards matching information, which ensures that identical record pairs with very little data listed are unlikely to be highlighted for follow-up at the expense of more detailed record pairs with slight differences. Furthermore, the reward for matching information varies depending on how common the matching event is, so that for example a match on a rare adverse event is considered stronger evidence than a match on gender. The fact that most of the hit-miss model parameters are determined by the properties of the entire data set reduces the risk of over-fitting the algorithms to training data, which is very important for the WHO database, where the amount of labelled training data is limited.\nThe aim of this paper is to propose two new improvements to the standard hit-miss model (a model for errors in numerical record fields and a computationally efficient approach to handling correlated record fields) and to show  that the adapted hit-miss model is very useful in real world duplicate detection. We fit the hit-miss model to the WHO drug safety database, and evaluate its performance on a test set of real world database records that includes a certain proportion of known duplicates.", "publication_ref": ["b15", "b10", "b0", "b13", "b5", "b7", "b4", "b2", "b9", "b11", "b16", "b8", "b12", "b6"], "figure_ref": [], "table_ref": []}, {"heading": "METHODS", "text": "", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "The hit-miss model", "text": "", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "The standard hit-miss model", "text": "The hit-miss model is a probability model for how discrepancies between database records that relate to the same underlying event occur. Let X = j and Y = k denote the observed values on two database records for a certain record field and let pj and p k denote the corresponding probabilities. The joint probability for this pair of values under the independence assumption is pj \u2022 p k . The hit-miss model provides an estimate p jk for the same probability under the assumption that the two records are duplicates. The contribution from each record field (its weight) to the total match score is equal to the log-likelihood ratio for the two hypotheses (high values correspond to likely duplicates):\nW jk = log 2 p jk pj p k (1)\nand the total match score is found by adding together the weights for all different record fields.\nUnder the hit-miss model, each observed record field value X is based on a true but unobserved event T . Observed values are assumed to be either misses, blanks or hits. Misses occur with probability a, blanks with probability b and hits with probability 1\u2212a\u2212b. For a miss X is a random variable following the overall incidence of T , for a blank the value of X is missing and for a hit X = T .\nLet P (T = i) = \u03b2i and let P (X = j | T = i) = \u03b1ji. The following holds generally under the assumption that X and Y are independent conditional on T : Under the hit-miss model:\np jk = X i \u03b1ji\u03b1 ki \u03b2i (2) Outcomes Probability Distribution H,H (1 \u2212 a1 \u2212 a2 \u2212 b) 2 \u03b4(d) H,D 2a1(1 \u2212 a1 \u2212 a2 \u2212 b) \u03c6(d; 0, \u03c3 2 1 ) D,D a 2 1 \u03c6(d; 0, 2\u03c3 2 1 ) H,M 2a2(1 \u2212 a1 \u2212 a2 \u2212 b) f (d) M,M a 2 2 f (d) D,M 2a1a2 approx f (d)\n\u03b1ji = 8 < : a\u03b2j j = i 1 \u2212 b \u2212 a(1 \u2212 \u03b2j ) j = i b j blank (3\n)\nand it can be shown that if c = a(2 \u2212 a \u2212 2b):\np jk = 8 > > < > > : c\u03b2j \u03b2 k j = k \u03b2j {(1 \u2212 b) 2 \u2212 c(1 \u2212 \u03b2j )} j = k b(1 \u2212 b)\u03b2 k j blank b 2 j, k blank (4)\nBased on (4):\nP (X = j) = (1 \u2212 b) \u2022 \u03b2j (5) P (X blank) = b (6) P (discordant pair) = c \u2022 (1 \u2212 X i \u03b2 2 i )(7)\nThus, for a given record field, we estimate b by its relative frequency of blanks in the entire database and \u03b2i by its relative frequency of value i among non-blanks in the entire database. c is estimated by the relative frequency of discordant pairs for this record field among non-blanks in the set of identified duplicate pairs, divided by 1 \u2212 P i \u03b2 2 i . (3), (4) and (5) give:\nW jk = 8 < : log 2 c \u2212 2 log 2 (1 \u2212 b) j = k log 2 {1 \u2212 c(1 \u2212 \u03b2j )(1 \u2212 b) \u22122 } \u2212 log 2 \u03b2j j = k 0 j or k blank (8)\nThus, all mismatches for a given record field receive the same weight and blanks receive weight 0. It can be shown that matches on rare events receive greater weights than matches on more common events (Wjj decreases when \u03b2j increases) as would intuitively be expected. The detailed behaviour of Wjj as a function of \u03b2j is illustrated in Figure 1 for different values of a and b.", "publication_ref": ["b4"], "figure_ref": ["fig_1"], "table_ref": []}, {"heading": "A hit-miss mixture model for errors in numerical record fields", "text": "For numerical record fields such as date and age, many types of error are more likely to yield small differences between true and observed values. If, for example, two different sources send separate case reports related to the same incident, the dates may perhaps disagree, but it is more likely that they should differ by a few days than by several years. Similarly, the registered age for patient sometimes differs from the true value, but then a small difference is more likely than a large one. At the same time, there may 1. Make initial guesses for the parameters\u00e21,\u00e22 and \u03c3 2 1 2. Expectation step: Calculate\u03b11, . . . ,\u03b14:\n\u03b11 = (1 \u2212\u00e21 \u2212\u00e22 \u2212b) 2 \u03b12 =\u00e22(2 \u2212 2b \u2212\u00e22) \u03b13 = 2\u00e21(1 \u2212\u00e21 \u2212\u00e22 \u2212b) \u03b14 =\u00e2 2 1\nFor each observed di in training data, compute the probability that it belongs to each mixture component\n\u03b31(di) =\u03b1 1 \u03b4(d i ) \u03b1 1 \u03b4(d i )+\u03b1 2 f (d i )+\u03b1 3 \u03c6(d i ;0,\u03c3 2 1 )+\u03b1 4 \u03c6(d i ;0,2\u03c3 2 1 ) \u03b32(di) =\u03b1 2 f (d i ) \u03b1 1 \u03b4(d i )+\u03b1 2 f (d i )+\u03b1 3 \u03c6(d i ;0,\u03c3 2 1 )+\u03b1 4 \u03c6(d i ;0,2\u03c3 2 1 ) \u03b33(di) =\u03b1 3 \u03c6(d i ;0,\u03c3 2 1 ) \u03b1 1 \u03b4(d i )+\u03b1 2 f (d i )+\u03b1 3 \u03c6(d i ;0,\u03c3 2 1 )+\u03b1 4 \u03c6(d i ;0,2\u03c3 2 1 ) \u03b34(di) =\u03b1 4 \u03c6(d i ;0,2\u03c3 2 1 ) \u03b1 1 \u03b4(d i )+\u03b1 2 f (d i )+\u03b1 3 \u03c6(d i ;0,\u03c3 2 1 )+\u03b1 4 \u03c6(d i ;0,2\u03c3 2 1 )\n3. Maximisation step: Calculate the weighted variance\u03c3 2 1 :\n\u03c3 2 1 = P n i=1\u03b33 (d i )\u2022d 2 i +\u03b3 4 (d i )\u2022d 2 i /2 P n i=1\u03b3 3 (d i )+\u03b3 4 (d i )\nUpdate\u00e21 and\u00e22 by numerical maximisation of the total likelihood for the observed data over eligible value pairs (such that\u00e21 +\u00e22 +b < 1).", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "Iterate 2-3 until convergence", "text": "Table 2: EM algorithm for the hit-miss mixture model.\nbe other types of errors (e.g. typing errors) where a large numerical difference is as likely as a small one. In order to handle both possibilities, we propose a hit-miss mixture model which includes a new type of miss for which small deviations from the true value are more likely than large ones. To distinguish between the two types of misses in this model, we refer to the first type as 'misses' and the second type as 'deviations'. If T is the true, but unobserved value, then X is a random variable assumed to have been generated through a process that results in a deviation with probability a1, a miss with probability a2, a blank with probability b and a hit with probability 1 \u2212 a1 \u2212 a2 \u2212 b. For a deviation, X follows a N (T, \u03c3 2 1 ) distribution and for a miss, X is a random variable independent of T but with the same distribution. For a blank, the value of X is missing and for a hit, X = T .\nFor two observed numerical values X = i and Y = j, we focus on the difference d = j \u2212 i. For duplicates we must distinguish between 6 possible outcomes for the hitmiss mixture model as listed in Table 1 where \u03c6(d; \u00b5, \u03c3 2 ) denotes a normal distribution with mean \u00b5 and variance \u03c3 2 and \u03b4(d) denotes Dirac's delta function, which has all its probability mass centred at 0. f (d) denotes the probability density function for the difference between two independent random events that follow the same distribution as T , such as for example a hit and a miss. Under the assumption that var(T ) \u03c3 2 1 , the difference between a miss and a deviation approximately follows this distribution.\nThus, the hit-miss mixture model for the difference d between the numerical values for two duplicates can be reduced to four components:\np d (d) = (1 \u2212 a1 \u2212 a2 \u2212 b) 2 \u2022 \u03b4(d) + a2(2 \u2212 a2 \u2212 2b) \u2022 f (d)+ + 2a1(1 \u2212 a1 \u2212 a2 \u2212 b) \u2022 \u03c6(d; 0, \u03c3 2 1 ) + a 2 1 \u2022 \u03c6(d; 0, 2\u03c3 2 1 )(9)\nFor unrelated records, d follows the more simple distribution:\npu(d) = (1 \u2212 b) 2 \u2022 f (d)(10)\nand we can calculate log-likelihood ratio based weights W (d) by integrating ( 9) and ( 10) over an interval corresponding to the precision of d (for two observed ages, for example, over d\u00b11 years) and taking the logarithm of the ratio of integrals.\nAs in the standard hit-miss model, single or double blanks receive weight 0.\nIn practice, f (d) must be estimated from training data (often a normal approximation is acceptable) and the probability for a blank b is estimated by the relative frequency of blanks in the entire database. To estimate the other parameters, an EM mixture identifier can be used. The restriction that the four mixture proportions be determined by a1 and a2 complicates the maximisation step of the EM algorithm, but can be accounted for in numerical maximisation. For a detailed outline of EM hit-miss mixture identification, see Table 2.", "publication_ref": [], "figure_ref": [], "table_ref": ["tab_0"]}, {"heading": "A method to handle correlated record fields", "text": "The standard hit-miss model assumes independence between record fields and this allows the total match score for a record pair to be calculated by simple summation of the weights for individual record fields. The independence assumption may, however, lead to over-estimated evidence that two records that match on a set of strongly correlated fields are duplicates, and this may hinder effective duplicate detection.\nTo reduce the risk for high total match scores driven solely by a group of correlated record fields, we propose a model that accounts for pairwise associations between correlated events. Let j1, . . . , jm denote a set of events related to different fields on the same database record. In the independence model, the probability that these events should co-occur on a record is:\nP (j1, . . . , jm) = m Y t=1 P (Xt = jt) = = m Y t=1 (1 \u2212 bt) \u22121 \u03b2j t (11)\nThe corresponding total contribution to the match score is:\nm X t=1 Wj t jt = m X t=1 log 2 {1 \u2212 ct(1 \u2212 \u03b2j t )(1 \u2212 bt) \u22122 } \u2212 m X t=1 log 2 \u03b2j t (12\n)\nbut this is based on the assumption that the information in the different record fields can be considered independently.\nIf no assumption of independence can be made, the joint probability for the set of events j1, . . . , jm can only be expressed as:\nP (j1, . . . , jm) = P (j1) \u2022 P (j2 | j1) \u2022 P (j3 | j1, j2)\u2022 \u2022 . . . \u2022 P (jm | j1, . . . , jm\u22121)(13)\nHowever, the amount of data required to reliably estimate P (jm | j1, . . . , jm\u22121) increases rapidly with m. As a compromise we propose the following approximation that accounts for pairwise associations only:\nP (j1, . . . , jm) = P (j1) \u2022 m Y t=2 max s<t P (jt | js)(14)\nFor correlated record fields, ( 14) may be used instead of (11) to model the joint distribution. Let:\nj * t = argmax js :s<t P (jt | js)(15)\n\u03b2 * jt = (1 \u2212 bt) \u22121 \u2022 P (jt | j * t )(16)\nThen:\nW * jj = log 2 {1 \u2212 c(1 \u2212 \u03b2 * j )(1 \u2212 b) \u22122 } \u2212 log 2 \u03b2 * j (17\n)\nand:\nm X t=1 W * jtjt = m X t=1 log 2 {1 \u2212 ct(1 \u2212 \u03b2 * jt )(1 \u2212 bt) \u22122 } \u2212 m X t=1 log 2 \u03b2 * jt \u2248 m X t=1 log 2 {1 \u2212 ct(1 \u2212 \u03b2j t )(1 \u2212 bt) \u22122 } \u2212 m X t=1 log 2 \u03b2 * jt = m X t=1 Wj tjt \u2212 m X t=1 log 2 \u03b2 * jt \u03b2j t(18)\nThus, the adjusted match score can be calculated by subtracting a sum of compensating terms from the original match score. Each compensating term can be written on the following form:\nlog 2 \u03b2 * jt \u03b2j t = log 2 P (jt | j * t ) P (jt)(19)\nand a shrinkage estimate for this log-ratio has earlier proven useful, as robust strength of association measures to find interesting associations in the WHO drug safety database [1,15]. This strength of association measure is referred to as the IC and is defined as [1,15]:\nICij = log 2 P (j | i) P (j)(20)\nShrinkage is achieved through Bayesian inference with a prior distribution designed to moderate the estimated IC values toward the baseline assumption of independence (IC = 0) [1,15]. The advantage of using IC values rather than raw observed-to-expected ratios is that they provide less volatile estimates when little data is available. In order to provide more robust scoring of correlated record fields, we propose IC shrinkage estimates be used to estimate log 2\n\u03b2 * j t \u03b2 j t\nin (18). The ordering of events j1, . . . , jm may affect the magnitude of the compensating term in (18) since conditioning is only allowed on preceding events in the sequence. As a less arbitrary choice of ordering, we propose the set be re-arranged in decreasing order of maximal IC value with another event in the set of matched events.    ", "publication_ref": ["b10", "b0", "b14", "b0", "b14", "b0", "b14"], "figure_ref": [], "table_ref": []}, {"heading": "Fitting a generalised hit-miss model to WHO drug safety data", "text": "", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "Implementation", "text": "Although the WHO database allows for the transmission and storage of a large amount of data for each individual case report, there are few records that have even the majority of the fields filled in [1]. However, all records in the data set have at least one drug substance, one ADR term and the reporting country listed. For the identification of possible duplicate records, the following record fields were considered the most relevant: date of onset, patient age, patient gender, reporting country, patient outcome, drug substances used and ADR terms observed (drug substances and ADR terms are in fact sets of binary events related to the presence or absence of each). Table 3 lists basic properties for these record fields. Some data pre-processing was required. Onset dates are related to individual ADR terms, and although there tends to be only one distinct onset date per record, there are 1184 records (0.04% of the database) that have different onset dates for different ADR terms; for those records, the earliest listed onset date was used. For the gender and outcome fields \"-\" had sometimes been used to denote missing values, and was thus re-encoded as such. Similarly, gender was sometimes listed as N/A which was also considered a missing value. For the age field, a variety of non-standard values were interpreted as missing values and re-encoded as such. Sometimes different age units had been used so in order to harmonise the ages, they were all re-calculated and expressed in years. Observed drug substances are listed as either suspected, interactive or concomitant, but since this subjective judgement is likely to vary between reporters, this information was disregarded.\nFor large data sets, it is computationally intractable to score all possible record pairs. A common strategy is to group the records into different blocks based on their values for a subset of important record fields and to only score records that are within the same block [9]. For the WHO  database, we block records based on drug substances crossed with ADR types so that only record pairs that have at least one drug substance in common and share at least one ADR type (as defined by the System Organ Class, which is a higher level grouping of ADR terms) are scored. In addition to the improvement in computational efficiency, this also reduces the risk for false leads generated by almost identical non-duplicate database records that refer to different reactions in the same patient (see Section 1). While blocking may in theory yield extra false negatives, duplicate records that don't match on at least one drug substance and an ADR type are very unlikely to receive high enough match scores to exceed the threshold for manual review.", "publication_ref": ["b0", "b8"], "figure_ref": [], "table_ref": ["tab_2"]}, {"heading": "Model fitting", "text": "The majority of the hit-miss model parameters are estimated based on the entire data set, but c, a1 and a2 rely on the characteristics of identified duplicate records. For the WHO drug safety database there were 38 groups of 2-4 suspected duplicate records available for this purpose. These had been identified earlier by manual review.   4: Some parameters for the hit-miss model fitted to the WHO database. The W jk value is the weight for a mismatch in that particular record field. The listed Wjj values are the maximum and minimum weights for matches on events in that particular record field.\nStandard hit-miss models were fitted to the gender, country and outcome record fields. Separate hit-miss models were fitted for individual drug substances and ADR terms, but b and c was estimated for drug substances as a group and for ADR terms as a group (c was estimated based on (7) where P \u03b2 2 i was replaced by the average P \u03b2 2 i for the group). Some of the fitted hit-miss model parameters are displayed in Table 4. As expected, matches on common events such as female gender receive much lower weights than matches on more rare events such as originating in Iceland. The penalty for mismatching ADR terms is significantly lower than that for mismatching drug substances, because discrepancies are more common for ADR terms. This is natural since the categorisation of adverse reactions requires clinical judgement and is more prone to variation.\nFor the numerical record fields age and date, hit-miss mixture models as described in Section 2.1.2 were fitted. Figure 2 shows empirical distributions in the WHO database for age and date together with the corresponding f (d) functions (note as an aside the digit preference on 0 and 5 for age). Since the empirical f (d) functions for both age and date are approximately normal and since they must be symmetrical by definition (d = j \u2212 i and i and j follow the same distribution), we assume normal f (d) functions with mean 0 for both age and date. The variances were estimated by:\n\u03c3 2 2 = P n i=1 d 2 i n (21\n)\nwhere n is the number of record pairs on which the estimate is based. EM mixture identification as outlined in Table 2 with the estimated values for b and \u03c3 2 2 and with starting val-ues\u00e21 = 0.1 and\u00e22 = 0.1 yielded the following parameters for the hit-miss mixture model for age:\na1 = 0.036\u00e22 = 0.010b = 0.186 \u03c31 = 2.1\u03c32 = 32.9 (22)\nand for date:\na1 = 0.051\u00e22 = 0.010b = 0.229 \u03c31 = 50.2\u03c32 = 3655 (23)\nBecause of the limited amount of training data available, we enforced a lower limit of 0.01 for both\u00e21 and\u00e22. Thus, even though no large deviations in age and date were observed in our training data, the possibility of large errors in these record fields is not ruled out.\nA problem with onset date is that quite a large proportion of the records in the data set (> 15%) have incomplete but not altogether missing information (such as 2002-10-? or 1999-?-?). This is straightforwardly taken care of in the hit-miss mixture model by integrating over a wider interval, when calculating the weight. For example, to compare dates 2002-10-? and 2002-10-12, we integrate ( 9) and ( 10) from -12 to 20. In practice, this leads to weights around 4.5 for matches on year when information on day and month are missing on one of the records and to weights around 8.0 for matches on year and month when information on day is missing on one of the records.\nThere tend to be strong correlations between drug substances and ADR terms (groups of drug substances are often co-prescribed and certain drug substances cause certain reactions) so IC based compensation according to Section 2.1.3 was introduced for drug substances and ADR terms as one group.", "publication_ref": ["b6"], "figure_ref": ["fig_3"], "table_ref": []}, {"heading": "A match score threshold", "text": "Under the hit-miss model, the match score correlates with the probability that two records are duplicates. In order to convert match scores to probabilities, we use a simple form of the mixture model discussed by Belin  The only relevant data available to estimate the overall proportion of duplicates in the data set was the study of duplicate records in vaccine spontaneous reporting data [14], which found duplication rates around 0.05. Based onP (dup) = 0.05 and the estimated match score distributions, we used Bayes formula to compute the probability that a given match score s corresponds to a pair of duplicates:\nP (dup | s) = 0.05 \u2022 \u03c6(s,\u03bcs 2 ,\u03c3s 2 ) 0.05 \u2022 \u03c6(s,\u03bcs 2 ,\u03c3s 2 ) + 0.95 \u2022 \u03c6(s,\u03bcs 1 ,\u03c3s 1 ) (26)\nIn order to obtain an estimated false discovery rate of below 0.05, the match score threshold for likely duplicates was set at 37.5 since P (dup | 37.5) = 0.95 according to (26).", "publication_ref": ["b13"], "figure_ref": [], "table_ref": []}, {"heading": "Experimental setup", "text": "One experiment was carried out to evaluate the performance of the adapted hit-miss model in identifying the most  likely duplicates for a given database record. The test data set consisted of the 38 groups of identified duplicates described in Section 2.2.2 and to avoid dependence between training cases, we only used the two most recent records in each group. The most recent record was designated the template record and the second most recent record was designated the test record. In the experiment, each template record was scored against all other records within its block (see Section 2.2.1) in the entire WHO database to see if any other record received a higher match score with the template record than the test record. While the same data set had been used in fitting the hit-miss model, its only impact had been on the proportion of misses in different record fields, so the risk for bias in the performance estimates is slight.\nAnother experiment was carried out to evaluate the performance of the hit-miss model in discriminating duplicates from random record pairs based on the threshold of 37.5 derived in Section 2.2.1. The test set used in the first experiment could not be used to evaluate the threshold since this data had been used to determine the threshold. However, Norway who is one of the few countries that label duplicate records on submission, had in their last batch in 2004 indicated 19 confirmed duplicates. This allowed for an independent evaluation of the duplicate detection method. Match scores were calculated for all record pairs within the same block (see Section 2.2.1) and those with scores that exceeded the 37.5 threshold were highlighted as likely duplicates.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "RESULTS", "text": "", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "Duplicate detection for a given database record", "text": "The performance at duplicate detection for a given database record was evaluated based on whether or not it was the test record that received the highest match score together with the template record. This was the case for 36 out of the 38 record pairs (94.7%). The two template records for which the test record was not top ranked are listed in Table 5 and Table 6 together with the most likely duplicates as indicated by the hit-miss model. For the first difficult template record, there are no strong matches, and based on a superficial examination, the two top ranked records which are not known duplicates seem as plausible as the test record which is a confirmed duplicate. Thus, while its performance was imperfect for this template record, the hit-miss model's predictions are at least in line with intuition. For the second difficult template record, there are strong matches (match scores ranging from 37.78 to 47.28) with 3 records that are not confirmed duplicates. While these may well be false positive, they could also be undetected duplicates: the records match on most of the fields and although some of the ADR terms differ, a more careful analysis shows that the listed ADR terms relate to liver and gastric problems. Thus, while the hit-miss model failed to identify the known duplicate for this template record, it may have identified 3 that are currently unknown.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "Discriminant duplicate detection", "text": "There was a total of 1559 case reports in the last batch from Norway in 2004. The median match score for the 19 known pairs of duplicates was 41.8 and the median match score for all other record pairs (after blocking) was -4.8. Figure 4 displays the match score distributions for the two groups. All in all, 17 record pairs had match scores above 37.5 and out of these, 12 correspond to known duplicates and 5 to other record pairs. Thus, the recall of the algorithm in this experiment was 63% (12 of the 19 confirmed duplicates were highlighted) and the precision was 71% (12 of the 17 highlighted record pairs are confirmed duplicates). However, the threshold of 37.5 was set based on the assumed 5% rate of duplicates in the data set, and following the discussion of precision-recall graphs by Bilenko & Mooney [4] Figure 5 indicates how the precision and the recall varies with different thresholds (an estimated 20% rate of duplicates would give a 35.2 threshold, an estimated 10% rate of duplicates would give a 36.5 threshold and an estimated 1% rate of duplicates would give a 39.6 threshold). To achieve   the minimum total number of errors, 11 (2 false positives and 9 false negatives), a threshold between 40.7 and 41.7 must be used. Precision normally tends to 1 as the threshold is increased, but this is not the case in Figure 5, because the highest match score actually corresponds to a pair of records that were not known duplicates. Table 7 lists the three record pairs with highest match scores among record pairs that were not confirmed duplicates and Table 8 lists the three record pairs with lowest match scores among confirmed duplicate record pairs.", "publication_ref": ["b3"], "figure_ref": ["fig_6", "fig_8", "fig_8"], "table_ref": ["tab_9", "tab_10"]}, {"heading": "Computational requirements", "text": "The experiments were run on a workstation equipped with a 2.2 GHz P4 processor and 1 GB of RAM. Efficient use of the available hardware and optimised data structures reduced computing time and memory requirements so that the initial data extraction and model fitting required a total of 50 minutes. To score a single pair of database records took 6 \u00b5s, and to score a database record against the rest of the data set took about 1 second (average block size in the order of 100,000 records). The scoring for all record pairs in the Norwegian data subset (1559 database records), after blocking, took 27 seconds.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "DISCUSSION", "text": "The hit-miss model as implemented on WHO data produced very promising results. For records that are known to have a duplicate, the hit-miss model reliably highlighted the corresponding record (94.7% accuracy). However, only a small proportion of database records have duplicates, so high ranked records are not necessarily duplicates, and in order for the method to be truly effective at duplicate detection, it needed to provide an absolute estimate for the probability that two records are duplicates. The 63% recall and 71% precision in Section 3.2 indicate that the hit-miss model identified the majority of known duplicates, while generating few false leads, which demonstrates its practical usefulness.\nThe hit-miss model did fail to highlight 7 known duplicates in the Norwegian batch, but from Table 8 it is clear that the amount of information on these records is very scarce: ages, outcomes and onset dates are missing on at least one of the records in each pair and while there are a few matching drug substances and ADR terms, there are at least as many unmatched ones. The lowering of the threshold required to highlight all these duplicates would yield an unmanageable proportion of false leads. We anticipate that any method would require non-anonymised data to be able to identify such duplicates, since lack of data cannot be compensated for with advanced algorithms. This emphasises the need for improved quality of case reports.\nFive of the record pairs highlighted in the Norwegian batch were not confirmed duplicates. One of these received the highest match score in the experiment (the top one in Table 7), but did not seem like an obvious pair of duplicates: outcomes are missing, onset dates and ages are close but don't match and none of the registered ADR terms match. On the other hand, 6 out of the 7 drug substances on these two records are the same and this is what generated the unusually high match score. These drug substances are not particularly commonly co-reported (the pairwise associations between them are weak) which further strengthens the evidence. In order to determine the true status of this record pair, we subsequently contacted the Norwegian national centre who confirmed that it was indeed a pair of duplicates: two different physicians at the same hospital had provided separate case reports for the same incident. This demonstrates that the hit-miss model may account for probabilistic aspects of data that are not immediately clear from manual review and that the hit-miss mixture model's treatment of small deviations in numerical record fields may be very useful in practice. The Norwegian centre also provided information on the 4 other record pairs of unknown status that had been highlighted in the study: the record pair with the second highest match score was reported to be a likely but yet unconfirmed duplicate whereas the other three highlighted record pairs were confirmed non-duplicates. However, these case reports had all been provided by the same dentist and all referred to the same drug-ADR combination. Such case reports submitted by the same individual will tend to be similar and difficult to distinguish from true duplicates. With respect to duplicate detection, these record pairs are certainly false leads, but in a different context the detection of such clusters of case reports may be very valuable (since they would generally be considered less strong evidence of a true problem than case reports from independent sources). The Norwegian feedback indicates that the reported 71% precision in Section 3.2 is an under-estimate.   The actual precision of the experiment was at least 76% (13/17) and possibly even higher. The reported recall rate may be either under-or over-estimated depending on how many unidentified duplicates remain.\nThe hit-miss mixture model is a new approach to handling discrepancies in numerical record fields. Like the standard hit-miss model, it is based on a rigorous probability model and provides intuitive weights. For matches, the weights depend on the precision of the matching values: matches on full dates receive weights around 12.0, matches on year and month when day is missing receive weights around 8.0 and matches on year when month and day are missing receive weights around 3.5. Both matches and near-matches are rewarded, and the definition of a near-match is data driven: for the WHO database, age differences within \u00b11 year and date differences within \u00b1107 days receive positive weights and are thus favoured over missing information. There is a limit to how strongly negative the weight for a mismatch will get (see Figure 3), so any large enough deviation is considered equally unlikely. An alternative model for dates which would be useful if typing errors were very common is to model year, month and day of the date as separate discrete variables. The disadvantage of this approach is that absolute differences of just a few days could lead to very negative weights whereas differences of several years may yield positive weights if the two records match on month and day. In the hit-miss model, on the other hand, a pair of dates such as 1999-12-30 and 2000-01-02 contributes +3.18 to the match score, despite the superficial dissimilarity.\nThe experiments in this article were retrospective in the sense that they evaluated the performance of the algorithms based on what duplicates had already been identified. In the future, we aim to do a prospective study where the hitmiss model is used to highlight suspected duplicates in an unlabelled data subset and follow up the results by manual review. Such a study should allow for more accurate precision estimates and more insight into how the algorithms may be best applied in practice.\nThe hit-miss model will be used routinely for duplicate detection in in the WHO database. Database wide screens will be carried out regularly and, in addition, duplicate detection can be carried out at data entry and automatically when a case series is selected for clinical review. The rate limiting step in duplicate detection for post-marketing drug safety data is the manual review required to confirm or refute findings, so further testing will be necessary to determine whether the selected threshold is practically useful.\nThe hit-miss model fitted to the WHO drug safety database in Section 2.2 can be used for duplicate detection in other post-marketing drug safety data sets as well, provided they contain similar information. An alternative approach would be to use the methods described in this paper to fit adapted hit-miss models directly for the data sets of interest, since the properties of different data sets may vary and additional record fields may be available.", "publication_ref": [], "figure_ref": ["fig_5"], "table_ref": ["tab_10", "tab_9"]}, {"heading": "CONCLUSIONS", "text": "In this paper we have introduced two generalisations of the standard hit-miss model and demonstrated the usefulness of the adapted hit-miss model for automated duplicate detection in WHO drug safety data. Our results indicate that the hit-miss model can detect a significant proportion of the duplicates without generating many false leads. Its strong theoretical basis together with the excellent results presented here, should make it a strong candidate for other duplicate detection and record linkage applications.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "ACKNOWLEDGEMENTS", "text": "The authors are indebted to all the national centres who make up the WHO Programme for International Drug Monitoring and contribute case reports to the WHO drug safety database, and in particular to the Norwegian national centre for allowing the evaluation of their data to be used in this paper and for providing rapid assessment of the suspected duplicates. The opinions and conclusions, however, are not necessarily those of the various centres nor of the WHO.", "publication_ref": [], "figure_ref": [], "table_ref": []}], "references": [{"ref_id": "b0", "title": "A Bayesian neural network method for adverse drug reaction signal generation", "journal": "European Journal of Clinical Pharmacology", "year": "1998", "authors": "A Bate; M Lindquist; I R Edwards; S Olsson; R Orre; A Lansner; R M De Freitas"}, {"ref_id": "b1", "title": "A method for calibrating false-match rates in record linkage", "journal": "Journal of the American Statistical Association", "year": "1995", "authors": "T Belin; D Rubin"}, {"ref_id": "b2", "title": "Adaptive duplicate detection using learnable string similarity measures", "journal": "", "year": "2003", "authors": "M Bilenko; R J Mooney"}, {"ref_id": "b3", "title": "On evaluation and training-set construction for duplicate detection", "journal": "", "year": "2003", "authors": "M Bilenko; R J Mooney"}, {"ref_id": "b4", "title": "Proactive safety surveillance", "journal": "Pharmacoepidemiology and Drug Safety", "year": "2001", "authors": "E A Bortnichak; R P Wise; M E Salive; H H Tilson"}, {"ref_id": "b5", "title": "Spontaneous reports of thrombocytopenia in association with quinine: clinical attributes and timing related to regulatory action", "journal": "American Journal of Hematology", "year": "2002", "authors": "A D Brinker; J Beitz"}, {"ref_id": "b6", "title": "Record linkage: statistical models for matching computer records", "journal": "Journal of the Royal Statistical Society: Series A", "year": "1990", "authors": "J Copas; F Hilton"}, {"ref_id": "b7", "title": "Adverse drug reactions: finding the needle in the haystack", "journal": "British Medical Journal", "year": "1997", "authors": "I R Edwards"}, {"ref_id": "b8", "title": "A theory for record linkage", "journal": "Journal of the American Statistical Association", "year": "1969", "authors": "I P Fellegi; A B Sunter"}, {"ref_id": "b9", "title": "The merge/purge problem for large databases", "journal": "ACM Press", "year": "1995", "authors": "M A Hernandez; S J Stolfo"}, {"ref_id": "b10", "title": "Data quality management in pharmacovigilance", "journal": "Drug Safety", "year": "2004", "authors": "M Lindquist"}, {"ref_id": "b11", "title": "An efficient domain-independent algorithm for detecting approximately duplicate database records", "journal": "In Research Issues on Data Mining and Knowledge Discovery", "year": "1997", "authors": "A E Monge; C Elkan"}, {"ref_id": "b12", "title": "Record linkage: the design of efficient systems for linking records into individual family histories", "journal": "American Journal of Human Genetics", "year": "1967", "authors": "H B Newcombe"}, {"ref_id": "b13", "title": "Vaccine associated adverse event surveillance (VAEES) and quality assurance", "journal": "Drug Safety", "year": "2004", "authors": "J N Nkanza; W Walop"}, {"ref_id": "b14", "title": "Bayesian neural networks with confidence estimations applied to data mining", "journal": "Computational Statistics & Data Analysis", "year": "2000", "authors": "R Orre; A Lansner; A Bate; M Lindquist"}, {"ref_id": "b15", "title": "Spontaneous reporting of adverse drug reactions", "journal": "II: Uses. British Journal of Clinical Pharmacology", "year": "1988", "authors": "M D Rawlins"}, {"ref_id": "b16", "title": "Interactive deduplication using active learning", "journal": "ACM Press", "year": "2002", "authors": "S Sarawagi; A Bhamidipaty"}], "figures": [{"figure_label": "1", "figure_type": "figure", "figure_id": "fig_1", "figure_caption": "Figure 1 :1Figure 1: Wjj(\u03b2j ) based on (8), for several values of a and b", "figure_data": ""}, {"figure_label": "2", "figure_type": "figure", "figure_id": "fig_3", "figure_caption": "Figure 2 :2Figure 2: Empirical distributions for ages and dates on records in the WHO database, as well as empirical f (d) functions together with fitted normal distributions.", "figure_data": ""}, {"figure_label": "3", "figure_type": "figure", "figure_id": "fig_5", "figure_caption": "Figure 3 :3Figure 3: Fitted hit-miss mixture model weight functions for age and date, respectively. Note the discrete jump in the weight functions at d = 0.", "figure_data": ""}, {"figure_label": "4", "figure_type": "figure", "figure_id": "fig_6", "figure_caption": "Figure 4 :4Figure 4: Match score distributions for known duplicates and other record pairs in the Norwegian batch, normalised in order to integrate to 1.", "figure_data": ""}, {"figure_label": "5", "figure_type": "figure", "figure_id": "fig_8", "figure_caption": "Figure 5 :5Figure 5: Precision and recall as functions of the threshold, for the discriminant analysis experiment on Norwegian data. The dotted line indicates the selected threshold.", "figure_data": ""}, {"figure_label": "1", "figure_type": "table", "figure_id": "tab_0", "figure_caption": "", "figure_data": ": Outcomes of interest (H=hit, D=deviation,M=miss) in the hit-miss mixture model, togetherwith associated probabilities and distributions for d."}, {"figure_label": "", "figure_type": "table", "figure_id": "tab_1", "figure_caption": "An adapted hit-miss model was fitted to the WHO drug safety database based on the data available at the end of 2003, including a set of 38 manually identified groups of duplicate records.", "figure_data": "Record fieldInterpretationTypeMissing dataDATEDate of onsetString23%OUTCOMEPatient outcomeDiscrete (7 values)22%AGEPatient ageNumerical (years old)19%GENDERPatient genderDiscrete (2 values)8%DRUGSDrugs used14,280 binary events0.08%ADRSADRs observed1953 binary events0.001%COUNTRY Reporting countryDiscrete (75 values)0%"}, {"figure_label": "3", "figure_type": "table", "figure_id": "tab_2", "figure_caption": "Record fields used for duplicate detection in the WHO database.", "figure_data": ""}, {"figure_label": "", "figure_type": "table", "figure_id": "tab_4", "figure_caption": "", "figure_data": ""}, {"figure_label": "", "figure_type": "table", "figure_id": "tab_5", "figure_caption": "& Rubin[2]. The assumption is that the match scores for duplicate records follow one normal distribution and the match scores for nonduplicate records follow a different normal distribution. For the WHO database, the empirical match score distributions are approximately normal. We estimated the match score mean and variance for duplicates based on the scores for the 38 duplicates in training data (see Section 2.2.2):", "figure_data": "\u00b5s 2 = 42.96\u03c3s 2 = 15.73(24)and for non-duplicates based on a random sample of 10,000record pairs:\u03bcs 1 = \u221218.50\u03c3s 1 = 8.55(25)"}, {"figure_label": "56", "figure_type": "table", "figure_id": "tab_7", "figure_caption": "The first difficult template record together with the top 5 records in its list of potential duplicates according to the hit-miss model. The test record is marked with an asterisk.", "figure_data": "Onset date Age Gender Country Outcome Drug substances ADR terms Score1997-08-2340FUSADied5 in total4 in total-1997-08-2340FUSADied5 of 51 of 4 + 447.281997-08-2340?USADied4 of 52 of 4 + 345.751997-08-2340?USAUnknown5 of 50 of 4 + 437.781997-08-???MUSADied3 of 53 of 4 + 128.52?40FUSADied3 of 53 of 4 + 327.09 *"}, {"figure_label": "7", "figure_type": "table", "figure_id": "tab_9", "figure_caption": "The three record pairs with highest match scores among record pairs that are not confirmed duplicates in the Norwegian data.", "figure_data": "Onset date Age Gender Country OutcomeDrug substancesADR termsScore? ?79 ?F FNOR NOR? ?1 matched, 0 unmatched 1 matched, 2 unmatched 24.362003-01-07 ?76 ?F FNOR NOR? ?1 matched, 1 unmatched 1 matched, 3 unmatched 17.82? ?43 ?F FNOR NOR? ?2 matched, 2 unmatched 0 matched, 8 unmatched 14.05"}, {"figure_label": "8", "figure_type": "table", "figure_id": "tab_10", "figure_caption": "The three record pairs with lowest match scores among non-highlighted confirmed duplicates in the Norwegian data.", "figure_data": ""}], "formulas": [{"formula_id": "formula_0", "formula_text": "W jk = log 2 p jk pj p k (1)", "formula_coordinates": [2.0, 403.08, 530.5, 152.87, 20.84]}, {"formula_id": "formula_1", "formula_text": "p jk = X i \u03b1ji\u03b1 ki \u03b2i (2) Outcomes Probability Distribution H,H (1 \u2212 a1 \u2212 a2 \u2212 b) 2 \u03b4(d) H,D 2a1(1 \u2212 a1 \u2212 a2 \u2212 b) \u03c6(d; 0, \u03c3 2 1 ) D,D a 2 1 \u03c6(d; 0, 2\u03c3 2 1 ) H,M 2a2(1 \u2212 a1 \u2212 a2 \u2212 b) f (d) M,M a 2 2 f (d) D,M 2a1a2 approx f (d)", "formula_coordinates": [2.0, 399.48, 697.31, 156.47, 20.47]}, {"formula_id": "formula_2", "formula_text": "\u03b1ji = 8 < : a\u03b2j j = i 1 \u2212 b \u2212 a(1 \u2212 \u03b2j ) j = i b j blank (3", "formula_coordinates": [3.0, 98.4, 214.43, 190.59, 40.63]}, {"formula_id": "formula_3", "formula_text": ")", "formula_coordinates": [3.0, 288.99, 226.2, 3.92, 8.97]}, {"formula_id": "formula_4", "formula_text": "p jk = 8 > > < > > : c\u03b2j \u03b2 k j = k \u03b2j {(1 \u2212 b) 2 \u2212 c(1 \u2212 \u03b2j )} j = k b(1 \u2212 b)\u03b2 k j blank b 2 j, k blank (4)", "formula_coordinates": [3.0, 79.68, 270.35, 213.23, 51.31]}, {"formula_id": "formula_5", "formula_text": "P (X = j) = (1 \u2212 b) \u2022 \u03b2j (5) P (X blank) = b (6) P (discordant pair) = c \u2022 (1 \u2212 X i \u03b2 2 i )(7)", "formula_coordinates": [3.0, 100.44, 337.56, 192.47, 48.54]}, {"formula_id": "formula_6", "formula_text": "W jk = 8 < : log 2 c \u2212 2 log 2 (1 \u2212 b) j = k log 2 {1 \u2212 c(1 \u2212 \u03b2j )(1 \u2212 b) \u22122 } \u2212 log 2 \u03b2j j = k 0 j or k blank (8)", "formula_coordinates": [3.0, 53.76, 471.35, 251.83, 42.94]}, {"formula_id": "formula_7", "formula_text": "\u03b11 = (1 \u2212\u00e21 \u2212\u00e22 \u2212b) 2 \u03b12 =\u00e22(2 \u2212 2b \u2212\u00e22) \u03b13 = 2\u00e21(1 \u2212\u00e21 \u2212\u00e22 \u2212b) \u03b14 =\u00e2 2 1", "formula_coordinates": [3.0, 350.04, 95.48, 174.49, 45.58]}, {"formula_id": "formula_8", "formula_text": "\u03b31(di) =\u03b1 1 \u03b4(d i ) \u03b1 1 \u03b4(d i )+\u03b1 2 f (d i )+\u03b1 3 \u03c6(d i ;0,\u03c3 2 1 )+\u03b1 4 \u03c6(d i ;0,2\u03c3 2 1 ) \u03b32(di) =\u03b1 2 f (d i ) \u03b1 1 \u03b4(d i )+\u03b1 2 f (d i )+\u03b1 3 \u03c6(d i ;0,\u03c3 2 1 )+\u03b1 4 \u03c6(d i ;0,2\u03c3 2 1 ) \u03b33(di) =\u03b1 3 \u03c6(d i ;0,\u03c3 2 1 ) \u03b1 1 \u03b4(d i )+\u03b1 2 f (d i )+\u03b1 3 \u03c6(d i ;0,\u03c3 2 1 )+\u03b1 4 \u03c6(d i ;0,2\u03c3 2 1 ) \u03b34(di) =\u03b1 4 \u03c6(d i ;0,2\u03c3 2 1 ) \u03b1 1 \u03b4(d i )+\u03b1 2 f (d i )+\u03b1 3 \u03c6(d i ;0,\u03c3 2 1 )+\u03b1 4 \u03c6(d i ;0,2\u03c3 2 1 )", "formula_coordinates": [3.0, 350.03, 172.52, 375.97, 62.31]}, {"formula_id": "formula_9", "formula_text": "\u03c3 2 1 = P n i=1\u03b33 (d i )\u2022d 2 i +\u03b3 4 (d i )\u2022d 2 i /2 P n i=1\u03b3 3 (d i )+\u03b3 4 (d i )", "formula_coordinates": [3.0, 350.03, 273.23, 117.48, 17.11]}, {"formula_id": "formula_10", "formula_text": "p d (d) = (1 \u2212 a1 \u2212 a2 \u2212 b) 2 \u2022 \u03b4(d) + a2(2 \u2212 a2 \u2212 2b) \u2022 f (d)+ + 2a1(1 \u2212 a1 \u2212 a2 \u2212 b) \u2022 \u03c6(d; 0, \u03c3 2 1 ) + a 2 1 \u2022 \u03c6(d; 0, 2\u03c3 2 1 )(9)", "formula_coordinates": [4.0, 57.6, 72.08, 235.31, 36.72]}, {"formula_id": "formula_11", "formula_text": "pu(d) = (1 \u2212 b) 2 \u2022 f (d)(10)", "formula_coordinates": [4.0, 128.88, 142.28, 163.89, 11.05]}, {"formula_id": "formula_12", "formula_text": "P (j1, . . . , jm) = m Y t=1 P (Xt = jt) = = m Y t=1 (1 \u2212 bt) \u22121 \u03b2j t (11)", "formula_coordinates": [4.0, 106.44, 510.08, 186.34, 57.7]}, {"formula_id": "formula_13", "formula_text": "m X t=1 Wj t jt = m X t=1 log 2 {1 \u2212 ct(1 \u2212 \u03b2j t )(1 \u2212 bt) \u22122 } \u2212 m X t=1 log 2 \u03b2j t (12", "formula_coordinates": [4.0, 53.76, 589.52, 242.4, 37.57]}, {"formula_id": "formula_14", "formula_text": ")", "formula_coordinates": [4.0, 288.71, 618.12, 4.08, 8.97]}, {"formula_id": "formula_15", "formula_text": "P (j1, . . . , jm) = P (j1) \u2022 P (j2 | j1) \u2022 P (j3 | j1, j2)\u2022 \u2022 . . . \u2022 P (jm | j1, . . . , jm\u22121)(13)", "formula_coordinates": [4.0, 77.52, 693.96, 215.26, 22.41]}, {"formula_id": "formula_16", "formula_text": "P (j1, . . . , jm) = P (j1) \u2022 m Y t=2 max s<t P (jt | js)(14)", "formula_coordinates": [4.0, 354.36, 102.44, 201.46, 27.58]}, {"formula_id": "formula_17", "formula_text": "j * t = argmax js :s<t P (jt | js)(15)", "formula_coordinates": [4.0, 385.32, 161.98, 170.5, 15.79]}, {"formula_id": "formula_18", "formula_text": "\u03b2 * jt = (1 \u2212 bt) \u22121 \u2022 P (jt | j * t )(16)", "formula_coordinates": [4.0, 381.84, 183.58, 173.98, 10.15]}, {"formula_id": "formula_19", "formula_text": "W * jj = log 2 {1 \u2212 c(1 \u2212 \u03b2 * j )(1 \u2212 b) \u22122 } \u2212 log 2 \u03b2 * j (17", "formula_coordinates": [4.0, 337.08, 215.38, 214.67, 10.87]}, {"formula_id": "formula_20", "formula_text": ")", "formula_coordinates": [4.0, 551.75, 215.75, 4.08, 8.97]}, {"formula_id": "formula_21", "formula_text": "m X t=1 W * jtjt = m X t=1 log 2 {1 \u2212 ct(1 \u2212 \u03b2 * jt )(1 \u2212 bt) \u22122 } \u2212 m X t=1 log 2 \u03b2 * jt \u2248 m X t=1 log 2 {1 \u2212 ct(1 \u2212 \u03b2j t )(1 \u2212 bt) \u22122 } \u2212 m X t=1 log 2 \u03b2 * jt = m X t=1 Wj tjt \u2212 m X t=1 log 2 \u03b2 * jt \u03b2j t(18)", "formula_coordinates": [4.0, 316.8, 244.04, 242.4, 87.82]}, {"formula_id": "formula_22", "formula_text": "log 2 \u03b2 * jt \u03b2j t = log 2 P (jt | j * t ) P (jt)(19)", "formula_coordinates": [4.0, 385.32, 383.62, 170.5, 22.04]}, {"formula_id": "formula_23", "formula_text": "ICij = log 2 P (j | i) P (j)(20)", "formula_coordinates": [4.0, 396.6, 468.24, 159.22, 20.85]}, {"formula_id": "formula_24", "formula_text": "\u03b2 * j t \u03b2 j t", "formula_coordinates": [4.0, 511.68, 567.32, 9.84, 17.62]}, {"formula_id": "formula_25", "formula_text": "\u03c3 2 2 = P n i=1 d 2 i n (21", "formula_coordinates": [6.0, 144.83, 454.64, 143.87, 22.98]}, {"formula_id": "formula_26", "formula_text": ")", "formula_coordinates": [6.0, 288.71, 462.96, 4.08, 8.97]}, {"formula_id": "formula_27", "formula_text": "a1 = 0.036\u00e22 = 0.010b = 0.186 \u03c31 = 2.1\u03c32 = 32.9 (22)", "formula_coordinates": [6.0, 82.91, 540.36, 314.62, 22.41]}, {"formula_id": "formula_28", "formula_text": "a1 = 0.051\u00e22 = 0.010b = 0.229 \u03c31 = 50.2\u03c32 = 3655 (23)", "formula_coordinates": [6.0, 82.91, 586.56, 314.62, 22.41]}, {"formula_id": "formula_29", "formula_text": "P (dup | s) = 0.05 \u2022 \u03c6(s,\u03bcs 2 ,\u03c3s 2 ) 0.05 \u2022 \u03c6(s,\u03bcs 2 ,\u03c3s 2 ) + 0.95 \u2022 \u03c6(s,\u03bcs 1 ,\u03c3s 1 ) (26)", "formula_coordinates": [6.0, 327.84, 608.4, 227.98, 31.41]}], "doi": "10.1145/1081870.1081923"}