{"title": "BRDF Acquisition with Basis Illumination", "authors": "Abhijeet Ghosh; Shruthi Achutha; Wolfgang Heidrich; Matthew O'toole", "pub_date": "", "abstract": "Realistic descriptions of surface reflectance have long been a topic of interest in both computer vision and computer graphics research. In this paper, we describe a novel and fast approach for the acquisition of bidirectional reflectance distribution functions (BRDFs). We develop a novel theory for directly measuring BRDFs in a basis representation by projecting incident light as a sequence of basis functions from a spherical zone of directions. We derive an orthonormal basis over spherical zones that is ideally suited for this task. BRDF values outside the zonal directions are extrapolated by re-projecting the zonal measurements into a spherical harmonics basis, or by fitting analytical reflection models to the data. We verify this approach with a compact optical setup that requires no moving parts and only a small number of image measurements. Using this approach, a BRDF can be measured in just a few minutes.", "sections": [{"heading": "Introduction", "text": "Accurate descriptions of how light reflects off a surface have long been a topic of research in both computer vision and computer graphics. Real world materials exhibit characteristic surface reflectance, such as glossy or specular highlights, anisotropy, or retro-reflection. Descriptions of such effects find their applications for example in shape from shading algorithms and realistic rendering. The surface reflectance of a material is formalized by the notion of the Bidirectional Reflectance Distribution Function (BRDF) [25], which is a 4 dimensional function describing the response of a surface in a certain exitant direction to illumination from a certain incident direction over a hemisphere of directions.\nNumerous analytical models of BRDFs exist in the literature [5,14,13,2,3] that observe the laws of energy conservation and reciprocity, and hence are physically plausible. However, these models generally do not capture the reflectance properties of all kinds of materials. Furthermore, selecting appropriate model parameters for representing different kinds of real-world materials can be a non-intuitive and time-consuming process. Therefore, acquisition of real * email:{ghosh, heidrich}@cs.ubc.ca world BRDF data has been a very active area of research over the last few years.\nThe data acquired in such a process is generally not used directly due to its large size, the noise present in the measurement process, and missing data for certain incident and exitant directions. Instead, the data is usually either fitted to an analytical model [33,17,24] or projected into a suitable basis [35,31,4,23]. This fitting process results in the loss of some of the captured high frequency details in the original data, possibly making the high sampling density of acquisition an overkill. At the same time, reducing the sampling density during acquisition would result in aliasing artifacts for sharp features that would then fall below the Nyquist limit.\nIn this paper, we propose an alternative approach to the acquisition of reflectance data where we optically project the data into a suitable basis function directly during the capture process. This approach results in optical low-pass filtering of the data at capture time, and thus addresses aliasing issues and minimizes high-frequency noise. An added benefit is that this prevents any redundancy in data capture as we can use all of the data we acquire. We focus on a very fast capture of object appearance for vision and graphics purposes, and do not seek to replace high-precision measurement devices such as gonio-reflectometers. Our approach speeds up acquisition time to one or two minutes compared to a few hours required by previous acquisition approaches. The main contributions of this paper are:\n\u2022 The theory behind, and a practical implementation of the concept of measuring the response of a surface to a basis function as a way of optically filtering and encoding the BRDF data.\n\u2022 Development of a set of orthogonal basis functions defined over the measurement space, as well as basis transformation as a way of data extrapolation.\n\u2022 A novel design for a curved reflector catadioptric imaging setup resulting in an efficient image based BRDF acquisition without involving any moving parts.", "publication_ref": ["b24", "b4", "b13", "b12", "b1", "b2", "b32", "b16", "b23", "b34", "b30", "b3", "b22"], "figure_ref": [], "table_ref": []}, {"heading": "Related Work", "text": "As an alternative to analytical BRDF models, one can use measurements of BRDFs in a rendering system. Such data is available from many sources, including the Cornell [6], STARR [26], and CUReT [7] databases. For example, the BRDF data in the CUReT database represents 256 reflectance measurements uniformly distributed over the hemisphere of 60 different materials. However, comprehensive data is still not readily available for a large number of day-to-day materials, and thus the development of rapid new measurement methods has been a focus of research activities. Measurement Setup. The wide availability and decreasing cost of digital cameras has led researchers to explore various image based BRDF acquisition approaches. One way of reducing the number of images that need to be taken is by using curved surfaces for recovering homogeneous [21,22], or spatially varying BRDFs [19]. Generally, these methods require knowledge of the geometric shape, and are not wellsuited for capturing fabric or sheet materials. Such materials can be measured by wrapping them around a cylinder at various orientations [24].\nIn many cases, planar samples are, however, more convenient. Other researchers have therefore focused on special optics to cover a large range of incident or exitant light directions for a planar sample in a single photograph. Ward's reflective dome design [33] was the first to use this approach. Malzbender et al. [20] use a dome with attached, individually controlled light sources to photograph a surface under varying lighting conditions. Han and Perlin [12] developed a device to capture bidirectional texture functions (BTFs) based on a kaleidoscope. Dana [8] designed an acquisition device using a parabolic mirror that densely covers a relatively small solid angle. The system also involves planer translations of the light source to cover various incident directions and translations of the sample in order to scan the surface for spatial variations in reflectance. Finally, Kuthirummal and Nayar [16] have developed a class of radial imaging systems for image-based acquisition of geometry, texture, and BRDFs. Their BRDF measurement setup can image 4 radial lines of reflectance of a given material for a fixed light source direction.\nOur work is most closely related to the last two papers. Like Kuthirummal and Nayar [16], we use a rotationally symmetric optical design, although ours is not a cylinder or cone, but a freeform surface. Our design lets us measure BRDFs over a continuous region of directions, much like the work of Dana [8]. However, unlike any other previous work, we use basis function illumination, rather than individual point or directional lights, which allows us to very rapidly acquire BRDFs, including anisotropic ones. Measurements with Basis Functions. Basis function approaches have been used in the past for measuring other visual effects, including light fields [11], reflectance fields [34] and environment mattes [27]. While similar is spirit, these approaches measure different physical properties, and are therefore both mathematically and optically very different from ours. Our proposed zonal basis illumination is very similar in principle to harmonic lights as proposed by Sato et al. [32] for encoding the appearance function of a scene. Hence our optical setup can be seen as a step towards the realization of such harmonic lights. BRDF Representations. After the BRDF has been measured, one can use it directly in tabular form in a rendering system [21]. However, the data often contains holes and is noisy, so that some form of post-processing and interpolation is almost always required. Furthermore, the inherent dimensionality of the BRDF data, and the need to sample it at a high resolution leads to unwieldy storage problems. Most researchers therefore represent their BRDFs as either analytical reflectance models [33,19,10], or generic function bases such as polynomials [15,20], spherical harmonics [35,31,4], or wavelets [18,23].\nThe key difference of our work from these approaches is that we directly acquire the BRDF in a basis representation, rather than measuring a tabulated representation that is later fit with the basis functions. The concept of basis function acquisition, in combination with the optical setup that we devised, allows for extremely rapid and easy measurement of BRDFs.", "publication_ref": ["b5", "b25", "b6", "b20", "b21", "b18", "b23", "b32", "b19", "b11", "b7", "b15", "b15", "b7", "b10", "b33", "b26", "b31", "b20", "b32", "b18", "b9", "b14", "b19", "b34", "b30", "b3", "b17", "b22"], "figure_ref": [], "table_ref": []}, {"heading": "Overview", "text": "The distinguishing characteristic of our BRDF measurement system is that it captures the response of the surface to illumination in the form of smooth basis functions, while existing methods measure impulse response using thin pencils of light that approximate Dirac peaks. For this concept to be practical, we require an optical setup that allows us to simultaneously project light onto the sample from a large range of directions, and likewise to measure the reflected light distribution over a similarly large range of directions. Developing such optics also has the advantage that no moving parts are required, which is one reason for the speed of our acquisition.\nIn this paper, we choose a spherical zone of directions as the acquisition region for both incident and exitant light directions. Spherical zones have several advantages over regions of other shape. First, they allow us to develop basis functions that align nicely with the symmetries present in many BRDFs, thus minimizing the number of basis functions required to represent a given BRDF. Alignment also simplifies extrapolation of data into missing regions. Second, a zonal setup allows us to design optics that could, in principle, cover over 98% of the hemisphere, with only a small hole near the zenith, where BRDF values are usually smoother compared to more tangential directions. The man- A camera focused on the mirrored components views a zone of reflected directions. A projector illuminates the corresponding zone of incident directions using a beam splitter. Right: A prototype demonstrating the concept in 2-D. Here, we focus illumination on the mirrored components using a laser pointer and observe that the beam bounces back to its origin.\nufacturing process that we used for our prototype system allowed us to produce a section of that range corresponding to 51% of the hemisphere.\nFigure 1 shows a diagram and a 2D mockup of such an optical setup. A camera focused on the mirrored components can capture the full zone of reflected directions in our setup. Simultaneously, a projector focused on the the mirrored components can cover the corresponding zone of incident directions.\nIn the following, we will first discuss the theoretical underpinnings for basis function BRDF acquisition (Section 4), and then describe the physical setup (Section 5). Finally, we present results in Section 6 and conclude with a discussion in Section 7.", "publication_ref": [], "figure_ref": ["fig_0"], "table_ref": []}, {"heading": "Measurement with Basis Functions", "text": "In this section, we discuss the mathematical concepts behind a basis function approach for BRDF measurement, and derive the specific basis that we use in our work. Section 5 then deals with the physical realization of these concepts.\nAssume that we want to measure a BRDF f r (\u03c9 i , \u03c9 o ) for combinations of incident light direction \u03c9 i and exitant light direction \u03c9 o restricted to a spherical zone Z centered around the surface normal. Z corresponds to longitudinal angles \u03c6 \u2208 [0 . . . 2\u03c0] and latitudinal angles \u03b8 \u2208 [\u03b8 min . . . \u03b8 max ], as shown in Figure 2.\nWe would like to approximate the BRDF over this zone with a linear combination of basis functions {Z k (\u03c9 i )} over the incident light directions. We will include the cos \u03b8 i term in this basis representation for convenience and numerical stability, i.e. so that we can write the reflected radiance for any outgoing direction \u03c9 o as\nf r (\u03c9 i , \u03c9 o ) = f r (\u03c9 i , \u03c9 o ) cos \u03b8 i \u2248 \u2211 k Z k (\u03c9 i )z k (\u03c9 o ), (1)\nL o (\u03c9 o ) = Z f r (\u03c9 i , \u03c9 o )L i (\u03c9 i ) cos \u03b8 i d\u03c9 i (2) \u2248 \u2211 k z k (\u03c9 o ) Z Z k (\u03c9 i )L i (\u03c9 i ) d\u03c9 i .(3)\nIn this framework, BRDF measurement can be seen as the process of determining the coefficients z k (\u03c9 o ) for each basis Z k and each exitant light direction \u03c9 o . If we have chosen the Z k such that they form an orthonormal basis over the zone Z, then the coefficients are given as\nz k (\u03c9 o ) = Z Z k (\u03c9 i ) f r (\u03c9 i , \u03c9 o ) cos \u03b8 i d\u03c9 i .(4)\nIn other words, we can measure z k (\u03c9 o ) by recording the reflected light along each direction \u03c9 o \u2208 Z for different incident illumination patterns Z k (\u03c9 i ). In practice, we separately project the positive Z + k and the negative Z \u2212 k parts of the basis function Z k , and subtract the resulting coefficients in software, similar to the work by Goesele et al. [11].\nThere are several ways in which one can define a suitable orthonormal basis over Z. In Appendix A we derive the set of orthonormal Zonal Basis (ZB) functions Z m l (\u03c6 , \u03b8 ) \u2208 [0, 2\u03c0] \u00d7 [\u03b8 min , \u03b8 max ] that we use for our purposes:\nZ m l (\u03b8 , \u03c6 ) = \uf8f1 \uf8f4 \uf8f4 \uf8f4 \uf8f4 \uf8f2 \uf8f4 \uf8f4 \uf8f4 \uf8f4 \uf8f3 \u221a 2K m l cos(m\u03c6 )P m l (cos \u03b8 ) if m > 0 \u221a 2K m l sin(\u2212m\u03c6 )P \u2212m l (cos \u03b8 ) if m < 0 K 0 lP 0 l (cos \u03b8 ) if m = 0 ,(5)\nwhere the zonal normalization constantK m l i\u015d\nK m l = (2l + 1)(l \u2212 |m|)! 2\u03c0 \u2022 (cos \u03b8 min \u2212 cos \u03b8 max ) \u2022 (l + |m|)! .(6)\nFor practical applications, we of course need to extrapolate from the data measured over the zone to incident and exitant directions that have not been measured. This task is simplified by the global support of our basis functions, and would be much more difficult for a basis with local support, such as a Wavelet basis. In general, we would also like to transform the data into a different representation that is more convenient for rendering purposes, such as a tensorproduct Spherical Harmonics (SH) basis, or coefficients of an analytical reflection model. Interestingly, format conversion and extrapolation can be achieved in a single, inexpensive step, as described in the following.", "publication_ref": ["b10"], "figure_ref": ["fig_1"], "table_ref": []}, {"heading": "Basis Conversion to Spherical Harmonics", "text": "One way of extrapolating the acquired zonal data in the zone of missing measurements is by transformation into an alternative basis such as spherical harmonics. The SH basis has been used extensively in the past for representing BRDF data. Unlike the ZB basis functions, however, the restrictions of the SH basis functions Y m l to our measurement zone Z are not orthonormal, and therefore, the equivalent of Equation 4 does not hold for spherical harmonics. Instead, we have\ny m l (\u03c9 o ) = Z\u0176 m l (\u03c9 i )f r (\u03c9 i , \u03c9 o ) d\u03c9 i ,(7)\nwhere {\u0176 m l (\u03c9 i )} is the dual basis to the spherical harmonics over the zone Z, i.e. the basis that fulfills the conditions\nZ Y m l (\u03c9)\u0176 q p (\u03c9)d\u03c9 = \uf8f1 \uf8f2 \uf8f3 1 if l = p and m = q 0 otherwise .(8)\nSince {\u0176 m l (\u03c9 i )} is a basis for the same function space as the SH basis, we also hav\u00ea\nY q p = \u2211 l,m c m,q l,p Y m l .(9)\nEquations 8 and 9 together describe a sparse linear system that can be solved to obtain the linear weights that define the duals\u0176 . Conversion from ZB to SH is then a simple linear transformation of the zonal coefficients z q p of a functionf r by a sparse basis change matrix C into corresponding SH coefficients y m l . Each element of this matrix is defined by\nC m,q l,p = Z Z q p\u0176 m l d\u03c9.(10)\nNote that we could use the dual functions\u0176 m l for measurements and directly project the BRDF into a spherical harmonic basis. However, having a single orthonormal basis is more convenient for projection into arbitrary function spaces, including analytical BRDF models, as described next.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "Fitting Analytical Reflection Models", "text": "For relatively low frequency BRDFs, the spherical harmonic representation produces very good results. For specular materials, it is well known that basis functions such as spherical harmonics or our zonal basis suffer from oscillations in the proximity of discontinuities or strong gradients. These oscillations are visible in the reconstruction as undesirable ringing artifacts also known as the Gibbs phenomenon (Figure 3, center). Hence, for specular materials, we cannot directly use the acquired coefficients or transform them into SH for final use.\nInstead, we propose to fit the higher order zonal representation of specular BRDFs to an analytical model, thereby computing a least-squares fit over the spurious oscillations. Since the Gibbs phenomenon is an oscillation around the true function value, such a least-squares fit produces a very good reconstruction (Figure 3, right). In our experiments, we worked with the distribution based BRDF model by Ashikhmin [1] due to the simplicity of the fitting procedure. The D-BRDF model is also a generalization of the Ashikhmin-Shirley-Phong model [3], which was recently found to be particularly well-suited for fitting to measured data [24]. However, the measured zonal data can be fitted to any other suitable analytic model using a numerical procedure such as Levenberg-Marquardt [29].   The primary components of our image-based acquisition setup are a convex parabolic mirror suspended inside a mirrored dome. This optical setup can cover a zone of incident as well as exitant directions of measurement. In addition to the mirrored components, the acquisition system consists of a FireWire machine vision camera (Prosilica EC 1350C), an LED RGB PocketProjector (Mitsubishi PK1), and a beam splitter. The camera has a resolution of 1360 \u00d7 1024 and an acquisition rate of 15 frames per second at 12-bits per color channel. The projector has a resolution of 800 \u00d7 600 with peak illumination intensity specified at 200 Lux. An external 350 mm lens was used to focus the projector at the required focal distance. All reflectance measurements are performed with multiple exposures [9] for high dynamic range (HDR) acquisition.", "publication_ref": ["b0", "b2", "b23", "b28", "b8"], "figure_ref": ["fig_2", "fig_2"], "table_ref": []}, {"heading": "Measurement Setup and Calibration", "text": "Our optical setup consists of two mirrored components, a convex parabola and a concave reflective dome as shown in Figures 1 and 5. The dome has a rotationally symmetric shape with a freeform profile, as detailed in the following. Dome Shape: For a fixed configuration of parabola, sample, camera, and projector, the freeform profile of the dome is determined as follows. First, the location of the dome's rim D 1 is found by intersecting a camera ray reflecting off the bottom edge P 1 of the paraboloid with the tangent plane of the sample (Figure 5, left). The surface normal at the rim defines a tangent plane in D 1 . For the next camera ray reflecting of P 2 , we compute the intersection D 2 of the reflected ray with the tangent plane of D 1 (Figure 5, center). The normal in D 2 defines a new tangent plane that we can use in the same way to obtain the next point on the dome. Proceeding iteratively with this approach, we can determine the full shape of the dome (Figure 5, right) in what amounts to an Euler integration procedure. Note that these simulations are run at orders of magnitude higher resolution than actual camera or projector pixel resolution. Design Simulations: The design parameters, i.e. the spatial location of parabola, sample, camera, and projector, were optimized using detailed simulations with a ray-tracer. We modeled the camera and projector as thin lens devices.\nOur simulations took into account various parameters such as focal distances, finite apertures and pixel resolutions of cameras and projectors, and stability under minor misalignments of the various optical components to the optical axis. Final Design: After extensive simulations, we decided on a design that lets us project over 100 pixels between the vertex and the tangent of the parabolic mirror in order to provide at least 1 measurement per degree along the latitudinal directions. For this setup, the distance between the center of projection of the camera and the vertex of the parabolic mirror is 27 cm, and the distance between the parabola vertex and the sample at the bottom is 13.5 cm. The dimensions of the full dome are 11\" \u00d7 11\" \u00d7 10\" for this setup. Our design provides us > 1 pixel/degree measurements over the full measurement zone. The full dome as simulated in Figure 5 would cover the zone from 9 \u2022 to 90 \u2022 off the normal to the sample. This range corresponds to over 98% of the full hemisphere. Physical Implementation: For the manufacturing of the dome and parabola, we chose electroforming process, in which a mandrel of the dome is first machined and polished, and then the actual dome is deposited on this mandrel in an electrolyte bath. This process allows the production of optical quality free-form surfaces at moderate cost. However, a downside of this approach is that it only allows for convex holes, since the mandrel has to be removed after the electroforming process. For this reason, we were only able to build a dome covering the zone from 9 \u2022 to 57 \u2022 off normal, corresponding to about 51% of the hemisphere (Figure 4).", "publication_ref": [], "figure_ref": ["fig_0", "fig_4", "fig_4", "fig_4", "fig_4", "fig_3"], "table_ref": []}, {"heading": "Calibration", "text": "Geometric calibration is necessary in order to align the camera and the projector to the optical axis of the acquisition setup. We also need to perform photometric calibration in order to recover the absolute scaling factors for our measurements with respect to some known reflectance standard. Optical Axis Calibration: The optical axis of the camera and projector need to be aligned with that of the parabolic mirror and dome. We mount the dome on an optical table, and mark its optical axis with crosses that are attached to the dome with precision mounts. The camera is moved with a manual translation stage until all crosses line up. Likewise, the projector is moved manually until the shadows of all crosses line up. Sample Mounting: Due to the large aperture of our optical system, the depth-of-field is very shallow, about 2 mm. As a result, the material samples have to be mounted with fairly high precision, which is easily achieved with a mechanical stop. Projector Flat-Fielding: We account for any spatial variation of the projector illumination by acquiring an HDR photograph of a full screen image set to medium gray, projected on to a diffuse white screen at the required focal distance of Figure 6. The Audi-TT model rendered with acquired BRDFs of 2 different paint samples. The BRDFs were acquired using 25 4 th order basis functions as defined in this paper, and then rendered with a basis transformation into spherical harmonics. Left: Metallic teal automotive paint. Right: Krylon TM true blue paint. In each case, the time taken for the entire BRDF measurement process including data capture and re-projection into the spherical harmonic basis was about one minute.\n28cm. All the basis images are then modulated by this image. Reflectance Calibration: An important aspect of the calibration is to recover the relative scaling factors for our measurements with respect to some known reflectance standard. For this, we take advantage of an 18 % diffuse gray card commonly used in photography. We measure the diffuse reflectance of the gray card with our setup using low order zonal basis functions [30]. The relative scaling factors for each color channel are obtained by white-balancing the results of the gray card measurements.", "publication_ref": ["b29"], "figure_ref": [], "table_ref": []}, {"heading": "Results", "text": "Using our prototype setup, we have acquired the BRDFs of various types of materials, including velvet, anisotropic synthetic, silk and satin fabrics, leather, various kinds of glossy and shiny papers, paint and plastic samples, printer toners, wax, highly specular metal foil wrapping papers, and anisotropic samples such as a guitar pick and a copper coin. Figure 7 presents a selection of BRDFs as rendered on a sphere under a directional light source. Most of the materials were acquired using lower order (l \u2264 6) zonal basis functions. The silk and satin fabrics, and the guitar pick were acquired with order l = 8 zonal basis function, while the shiny wrapping papers and anisotropic copper coin required acquisition with order l = 10 zonal basis function. The total number of images acquired for an order l acquisition is (l + 1) 2 \u00d7 2 \u00d7 3, with 2 separate positive and negative parts, and 3 exposures for HDR imaging. The entire acquisition process takes just a few minutes to complete even for higher order zonal basis functions.\nFigure 6 presents the BRDFs of 2 different paint samples that we acquired using 4 th order zonal basis functions, rendered on the Audi-TT car model, and illuminated by an HDR environment map using the Physically Based Ray Tracing system [28].  A representative set of the BRDFs acquired using lower order (l \u2264 6) zonal basis functions is shown in Figure 10. For this class of materials, the entire process of acquisition followed by a basis transformation into the SH basis took under three minutes.\nFigure 8 demonstrates the specular materials, in this case shiny metal foil chocolate wrapping papers, which we then fit to the D-BRDF analytical model. The D-BRDF fitting procedure consists of constructing the distribution of the half-vector \u03c9 h between the incident light direction \u03c9 i and exitant viewing direction \u03c9 o as a function of the backscattering direction measurements, i.e, the directions where \u03c9 i = \u03c9 o . In our case, we extract the zonal half-vector distribution from the measured data, and then extrapolate that to cover the full hemisphere of half-vector directions. The entire acquisition and fitting procedure took only a few minutes to complete in all examples. Similarly, we also fit D-BRDFs to the anisotropic guitar pick, the copper coin and Figure 7. Various BRDFs acquired with our prototype setup using zonal basis functions. Top row: from left to right -bright orange paper, red velvet, maroon synthetic fabric, brown leather, coated brown envelope, red printer toner, blue rubber band, glossy red paper, glossy blue-gray paper, Lindt TM chocolate box paper. Center row: from left to right -magenta plastic with grain finish, retro-reflective plastic, dark brown plastic coffee lid, Krylon TM banner red paint, Krylon TM true blue paint, metallic teal automotive paint, chrome gold dust automotive paint, purple anisotropic silk fabric, blue anisotropic silk fabric. Bottom row: from left to right -glossy succulent plant leaf, red wax, shiny blue paper, shiny golden paper, red KitKat TM wrapping paper, copper colored Lindt TM chocolate wrapping paper, anisotropic plastic guitar pick, anisotropic copper coin, anisotropic red satin. the satin samples (Figure 7, bottom row).\nFinally, as a way of validating our measurement and fitting approach, we photographed two satin samples wrapped around a cylinder in a dark room and lit by a collimated point light source. Figure 9 presents the comparisons of these photographs with the corresponding renderings of the D-BRDF fits to these samples. The highlights in the rendered images are a close match to the real photographs validating our approach.\nAs an additional step towards quantitative validation, we used an 18% gray card as a diffuse reflectance standard, and compared the recovered coefficients to the ones expected for a diffuse target. For low order basis functions, the error is within a few percent of the expected value. ", "publication_ref": ["b27"], "figure_ref": ["fig_0", "fig_5", "fig_6"], "table_ref": []}, {"heading": "Conclusions", "text": "In this paper, we have presented a novel basis function approach to BRDF measurement. Our contributions include a novel theory for basis function BRDF acquisition, the de-velopment of an orthonormal basis for spherical zones, and the design of an optical setup that allows for basis function illumination of BRDF samples.\nThe dome we use in our prototype setup covers a sufficient percentage of the hemisphere to obtain high quality BRDF measurements with our basis function approach. To further increase quality by reducing the amount of extrapolation, a dome with a larger coverage could be used. We are currently looking into manufacturing techniques that are able to produce such domes.\nDue to the basis function approach and the dispensing of all moving parts, BRDF measurement with our setup is very fast, reducing the acquisition time to a few minutes even for high-frequency materials. Moreover, the physical dimensions of the setup are quite compact, so that the whole apparatus could be enclosed in a small box for mobile onsite acquisitions.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "A. Orthonormal Zonal Basis", "text": "Our Zonal Basis (ZB), like the Spherical Harmonic basis, is derived from the Associated Legendre Polynomials (ALP) P m l (x), m \u2208 {0, . . . , l}, which are orthogonal over\nFor defining spherical harmonics Y m l , the P m l are scaled so that they are orthogonal over [0, \u03c0], with\nwhere K m l is the SH normalization constant:\nFor our zonal basis, we follow the same principle, and rescale the ALP to the range [\u03b8 min . . . \u03b8 max ].\nwith\nThe ZB functions Z m l (\u03c6 , \u03b8 ) \u2208 [0, 2\u03c0] \u00d7 [\u03b8 min , \u03b8 max ] are then given by Equations 5 and 6 in Section 4.", "publication_ref": [], "figure_ref": [], "table_ref": []}], "references": [{"ref_id": "b0", "title": "Distribution-based BRDFs", "journal": "", "year": "2006", "authors": "M Ashikhmin"}, {"ref_id": "b1", "title": "A microfacet-based BRDF generator", "journal": "", "year": "2000", "authors": "M Ashikhmin; S Premo\u015be; P Shirley"}, {"ref_id": "b2", "title": "An anisotropic phong BRDF model", "journal": "J. Graph. Tools", "year": "2000", "authors": "M Ashikhmin; P Shirley"}, {"ref_id": "b3", "title": "Lambertian reflectance and linear subspaces", "journal": "IEEE PAMI", "year": "2002", "authors": "R Basri; D W Jacobs"}, {"ref_id": "b4", "title": "A reflectance model for computer graphics", "journal": "ACM Transactions on Graphics", "year": "1982", "authors": "R L Cook; K E Torrance"}, {"ref_id": "b5", "title": "CORNELL light measurement laboratory", "journal": "", "year": "2005", "authors": "Cornell "}, {"ref_id": "b6", "title": "CUReT: Columbia-Utrech Reflectance and Texture", "journal": "", "year": "1999", "authors": " Curet"}, {"ref_id": "b7", "title": "BRDF/BTF measurement device", "journal": "", "year": "2001", "authors": "K Dana"}, {"ref_id": "b8", "title": "Recovering high dynamic range radiance maps from photographs", "journal": "", "year": "1997", "authors": "P Debevec; J Malik"}, {"ref_id": "b9", "title": "Linear light source reflectometry", "journal": "ACM Transactions on Graphics (Proc. SIG-GRAPH)", "year": "2003", "authors": "A Gardner; C Tchou; T Hawkins; P Debevec"}, {"ref_id": "b10", "title": "Accurate light source acquisition and rendering", "journal": "ACM Transactions on Graphics (Proc. SIGGRAPH)", "year": "2003-07", "authors": "M Goesele; X Granier; W Heidrich; H.-P Seidel"}, {"ref_id": "b11", "title": "Measuring bidirectional texture reflectance with a kaleidoscope", "journal": "ACM Transactions on Graphics (Proc. SIG-GRAPH)", "year": "2003", "authors": "J Y Han; K Perlin"}, {"ref_id": "b12", "title": "A fast and accurate light reflection model", "journal": "", "year": "1992", "authors": "X D He; P O Heynen; R L Phillips; K E Torrance; D H Salesin; D P Greenberg"}, {"ref_id": "b13", "title": "A comprehensive physical model for light reflection", "journal": "", "year": "1991", "authors": "X D He; K E Torrance; F X Sillion; . P Greenberg"}, {"ref_id": "b14", "title": "Bidirectional reflection distribution function expressed in terms of surface scattering modes", "journal": "", "year": "1996", "authors": "J Koenderink; A Van Doorn; M Stavridi"}, {"ref_id": "b15", "title": "Multiview Radial Catadioptric Imaging for Scene Capture", "journal": "ACM Trans. on Graphics (also Proc. of ACM SIGGRAPH)", "year": "2002", "authors": "S Kuthirummal; S K Nayar"}, {"ref_id": "b16", "title": "Non-linear approximation of reflectance functions", "journal": "", "year": "1997-08", "authors": "E Lafortune; S.-C Foo; K Torrance; D Greenberg"}, {"ref_id": "b17", "title": "A wavelet representation of reflectance functions", "journal": "IEEE Transactions on Visualization and Computer Graphics", "year": "1997", "authors": "P Lalonde; A Fournier"}, {"ref_id": "b18", "title": "Image-based reconstruction of spatially varying materials", "journal": "", "year": "2001", "authors": "H Lensch; J Kautz; M Goesele; W Heidrich; H.-P Seidel"}, {"ref_id": "b19", "title": "Polynomial texture maps", "journal": "", "year": "2001", "authors": "T Malzbender; D Gelb; H Wolters"}, {"ref_id": "b20", "title": "Image-based measurement of the bidirectional reflection distribution function", "journal": "Applied Optics", "year": "2000", "authors": "S Marschner; S Westin; E Lafortune; K Torrance"}, {"ref_id": "b21", "title": "A data-driven reflectance model", "journal": "ACM Transactions on Graphics (Proc. SIG-GRAPH)", "year": "2003", "authors": "W Matusik; H Pfister; M Brand; L Mcmillan"}, {"ref_id": "b22", "title": "All-frequency shadows using non-linear wavelet lighting approximation", "journal": "ACM Transactions on Graphics (Proc. SIGGRAPH)", "year": "2003-07", "authors": "R Ng; R Ramamoorthi; P Hanrahan"}, {"ref_id": "b23", "title": "Experimental analysis of BRDF models", "journal": "", "year": "2004", "authors": "A Ngan; F Durand; W Matusik"}, {"ref_id": "b24", "title": "Geometric considerations and nomenclature for reflectance", "journal": "NBS Monograph", "year": "1977", "authors": "F E Nicodemus; J C Richmond; J J Hsia; I W Ginsberg; T Limperis"}, {"ref_id": "b25", "title": "NIST. NIST reference reflectometer: STARR facility", "journal": "", "year": "2003", "authors": ""}, {"ref_id": "b26", "title": "Inferring reflectance functions from wavelet noise", "journal": "", "year": "2005", "authors": "P Peers; P Dutr\u00e9"}, {"ref_id": "b27", "title": "Physically Based Redering", "journal": "Morgan Kaufmann", "year": "2004", "authors": "M Pharr; G Humphreys"}, {"ref_id": "b28", "title": "Numerical Recipes: The Art of Scientific Computing", "journal": "Cambridge University Press", "year": "1992", "authors": "W Press; B Flannery; S Teukolsky; W Vetterling"}, {"ref_id": "b29", "title": "An efficient representation for irradiance environment maps", "journal": "", "year": "2001", "authors": "R Ramamoorthi; P Hanrahan"}, {"ref_id": "b30", "title": "Frequency space environment map rendering", "journal": "", "year": "2002", "authors": "R Ramamoorthi; P Hanrahan"}, {"ref_id": "b31", "title": "Appearance sampling for obtaining a set of basis images for variable illumination", "journal": "", "year": "2003", "authors": "I Sato; T Okabe; Y Sato; K Ikeuchi"}, {"ref_id": "b32", "title": "Measuring and modeling anisotropic reflection", "journal": "", "year": "1992", "authors": "G J Ward"}, {"ref_id": "b33", "title": "Performance relighting and reflectance transformation with time-multiplexed illumination", "journal": "ACM Transactions on Graphics (Proc. SIGGRAPH)", "year": "2002", "authors": "A Wenger; A Gardner; C Tchou; J Unger; T Hawkins; P Debevec"}, {"ref_id": "b34", "title": "Predicting reflectance functions from complex surfaces", "journal": "", "year": "1992", "authors": "S Westin; J Arvo; K Torrance"}], "figures": [{"figure_label": "1", "figure_type": "figure", "figure_id": "fig_0", "figure_caption": "Figure 1 .1Figure 1. Left: Physical setup of our reflectance acquisition device.A camera focused on the mirrored components views a zone of reflected directions. A projector illuminates the corresponding zone of incident directions using a beam splitter. Right: A prototype demonstrating the concept in 2-D. Here, we focus illumination on the mirrored components using a laser pointer and observe that the beam bounces back to its origin.", "figure_data": ""}, {"figure_label": "2", "figure_type": "figure", "figure_id": "fig_1", "figure_caption": "Figure 2 .2Figure 2. The measurement zone Z.", "figure_data": ""}, {"figure_label": "3", "figure_type": "figure", "figure_id": "fig_2", "figure_caption": "Figure 3 .3Figure 3. An illustration of the suppression of ringing through fitting analytical BRDF models. Left: original acrylic blue paint BRDF acquired by Matusik et al. [22]. Center: 10 th order zonal reconstruction, rendered after transformation into SH, exhibiting severe ringing artifacts. Right: Corresponding D-BRDF fit to the zonal reconstruction.", "figure_data": ""}, {"figure_label": "4", "figure_type": "figure", "figure_id": "fig_3", "figure_caption": "Figure 4 .4Figure 4. Photograph of the proposed BRDF acquisition setup including a camera, a projector, a beam-splitter, and two curved reflectors mounted on a 40 cm \u00d7 40 cm optical bench.", "figure_data": ""}, {"figure_label": "5", "figure_type": "figure", "figure_id": "fig_4", "figure_caption": "Figure 5 .5Figure 5. Iterative process for designing the profile of the reflective dome for a fixed convex parabolic reflector.", "figure_data": ""}, {"figure_label": "8", "figure_type": "figure", "figure_id": "fig_5", "figure_caption": "Figure 8 .8Figure 8. Specular chocolate wrapping papers acquired using higher order zonal basis functions, and then fit to an analytical model for rendering. Left: Red KitKat TM wrapping paper. Right: Copper colored Lindt TM chocolate wrapping paper.", "figure_data": ""}, {"figure_label": "9", "figure_type": "figure", "figure_id": "fig_6", "figure_caption": "Figure 9 .9Figure 9. Visual comparison of two kinds of acquired satin samples wrapped around a cylinder as lit by a point source against real photographs. Left column: Photographs of the red and blue satin samples. Right column: Rendering of the D-BRDF fits.", "figure_data": ""}, {"figure_label": "10", "figure_type": "figure", "figure_id": "fig_7", "figure_caption": "Figure 10 .10Figure 10. Representative set of BRDFs acquired with lower order zonal basis functions rendered under directional lighting. From left to right: red velvet, red printer toner, magenta plastic sheet, chrome gold dust automotive paint.", "figure_data": ""}], "formulas": [{"formula_id": "formula_0", "formula_text": "f r (\u03c9 i , \u03c9 o ) = f r (\u03c9 i , \u03c9 o ) cos \u03b8 i \u2248 \u2211 k Z k (\u03c9 i )z k (\u03c9 o ), (1)", "formula_coordinates": [3.0, 66.51, 697.69, 219.85, 18.64]}, {"formula_id": "formula_1", "formula_text": "L o (\u03c9 o ) = Z f r (\u03c9 i , \u03c9 o )L i (\u03c9 i ) cos \u03b8 i d\u03c9 i (2) \u2248 \u2211 k z k (\u03c9 o ) Z Z k (\u03c9 i )L i (\u03c9 i ) d\u03c9 i .(3)", "formula_coordinates": [3.0, 346.05, 220.14, 199.06, 42.91]}, {"formula_id": "formula_2", "formula_text": "z k (\u03c9 o ) = Z Z k (\u03c9 i ) f r (\u03c9 i , \u03c9 o ) cos \u03b8 i d\u03c9 i .(4)", "formula_coordinates": [3.0, 346.92, 346.08, 198.2, 16.18]}, {"formula_id": "formula_3", "formula_text": "Z m l (\u03b8 , \u03c6 ) = \uf8f1 \uf8f4 \uf8f4 \uf8f4 \uf8f4 \uf8f2 \uf8f4 \uf8f4 \uf8f4 \uf8f4 \uf8f3 \u221a 2K m l cos(m\u03c6 )P m l (cos \u03b8 ) if m > 0 \u221a 2K m l sin(\u2212m\u03c6 )P \u2212m l (cos \u03b8 ) if m < 0 K 0 lP 0 l (cos \u03b8 ) if m = 0 ,(5)", "formula_coordinates": [3.0, 312.43, 498.38, 360.06, 77.57]}, {"formula_id": "formula_4", "formula_text": "K m l = (2l + 1)(l \u2212 |m|)! 2\u03c0 \u2022 (cos \u03b8 min \u2212 cos \u03b8 max ) \u2022 (l + |m|)! .(6)", "formula_coordinates": [3.0, 334.79, 597.2, 210.32, 23.3]}, {"formula_id": "formula_5", "formula_text": "y m l (\u03c9 o ) = Z\u0176 m l (\u03c9 i )f r (\u03c9 i , \u03c9 o ) d\u03c9 i ,(7)", "formula_coordinates": [4.0, 97.2, 276.62, 189.16, 18.42]}, {"formula_id": "formula_6", "formula_text": "Z Y m l (\u03c9)\u0176 q p (\u03c9)d\u03c9 = \uf8f1 \uf8f2 \uf8f3 1 if l = p and m = q 0 otherwise .(8)", "formula_coordinates": [4.0, 66.7, 344.41, 219.66, 34.83]}, {"formula_id": "formula_7", "formula_text": "Y q p = \u2211 l,m c m,q l,p Y m l .(9)", "formula_coordinates": [4.0, 134.07, 427.2, 152.29, 21.73]}, {"formula_id": "formula_8", "formula_text": "C m,q l,p = Z Z q p\u0176 m l d\u03c9.(10)", "formula_coordinates": [4.0, 126.54, 552.02, 159.82, 19.28]}], "doi": ""}