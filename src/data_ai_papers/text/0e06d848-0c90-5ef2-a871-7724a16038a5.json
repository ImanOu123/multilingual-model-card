{"title": "A Theory of Fermat Paths for Non-Line-of-Sight Shape Reconstruction", "authors": "Shumian Xin; Sotiris Nousias; Kiriakos N Kutulakos; Aswin C Sankaranarayanan; Srinivasa G Narasimhan; Ioannis Gkioulekas", "pub_date": "", "abstract": "We present a novel theory of Fermat paths of light between a known visible scene and an unknown object not in the line of sight of a transient camera. These light paths either obey specular reflection or are reflected by the object's boundary, and hence encode the shape of the hidden object. We prove that Fermat paths correspond to discontinuities in the transient measurements. We then derive a novel constraint that relates the spatial derivatives of the path lengths at these discontinuities to the surface normal. Based on this theory, we present an algorithm, called Fermat Flow, to estimate the shape of the non-line-of-sight object. Our method allows, for the first time, accurate shape recovery of complex objects, ranging from diffuse to specular, that are hidden around the corner as well as hidden behind a diffuser. Finally, our approach is agnostic to the particular technology used for transient imaging. As such, we demonstrate mm-scale shape recovery from pico-second scale transients using a SPAD and ultrafast laser, as well as micron-scale reconstruction from femto-second scale transients using interferometry. We believe our work is a significant advance over the state-of-the-art in non-line-of-sight imaging.", "sections": [{"heading": "Introduction", "text": "Most computer vision research assumes that the scene of interest is directly visible to the camera. In other words, the photons from a source that reach a camera are assumed to have interacted with only the visible scene. However, some of the source photons are reflected by the visible scene toward parts-say, the back of an object facing a camera, an object around a corner, or an object viewed through a diffuser -that are hidden from the direct line of sight of the camera. In turn, the hidden scene scatters the photons back toward the visible scene, which then redirects photons toward the camera. Imaging and understanding the scene hidden from the camera's view is of significant importance to many security and safety applications.\nCapturing non-line-of-sight (NLOS) photons is chal-lenging as they are vastly outnumbered by line-of-sight (LOS) photons. Passive approaches analyze the subtle umbra and penumbra of the shadow cast by the hidden scene to estimate rough motion and structure [6,2,38], or use coherence properties of light to localize hidden objects [5,3]. These approaches do not have sufficient information to compute precise 3D shape of an unknown arbitrary hidden scene. Extracting additional information about the hidden scene is possible by using active illumination, including coherent lighting [42,21,4,22] and steady-state intensity sources [25,44,51,45]. The majority of approaches for reconstructing hidden shape information employ fast modulated light sources together with time-resolved sensors (e.g., continuous-wave ToF [15,20], ultrafast photodiodes [24], streak cameras [49,48,13], and single-photon avalanche photodetectors (SPADs) [11,32]). These sensors record not only the number of incident photons (intensity) but also their arrival times, at a range of temporal resolutions (millito femto-seconds) [49,12,31,32,11,18]. Such measurements are called transients and the approach is called transient NLOS imaging.\nBy measuring transients at various locations of a known visible scene, most active techniques perform a volumetric 3D reconstruction by attempting to invert the timeresolved radiometric image formation process. Examples include elliptic backprojection [48,7,1,26,36], regularized linear system approaches [13,15,14,20], the lightcone transform [33], and analysis-by-synthesis using rendering [35,47]. These methods have two fundamental disadvantages: (1) they rely on radiometric information and existing SPADs produce poor intensity estimates due to effects such as pile-up and after-pulsing [16], as well as due to extreme sensitivity to photon noise and ambient lighting; and (2) to simplify the inverse problem, all existing reconstruction techniques rely on an assumption of Lambertian reflectance for the NLOS object.\nIn this paper, we overcome the above limitations by developing techniques that use only geometric, rather than intensity, constraints derived from transient measurements of an NLOS scene. For this, we present a new theory of NLOS photons that follow specific geometric paths, called Fermat We consider the problem of reconstructing surfaces that are: (a) outside the field of view of sensor, or (b) occluded from it by a diffuser. We develop an algorithm that can use transient imaging measurements to accurately reconstruct the shape of the non-line-of-sight surface. The figure shows example reconstructions of a US quarter from measurements captured by a femtosecond-scale transient imaging system. In (c), we compare our reconstructions against groundtruth, obtained using a direct depth scan of the object with the same transient imaging system.\npaths between the LOS and NLOS scene. Based on Fermat's principle [43], we observe that these paths follow either the law of specular reflection or reflect at specific points at the object's boundary. We then prove that Fermat paths correspond to discontinuities in the transient measurements.\nThe temporal locations of the discontinuities are a function of only the shape of the NLOS object and not its reflectance (BRDF). We additionally show that the shape of the transient around the discontinuity is related to the curvature of the hidden surface. This theory generalizes previous work on the paths of first-returning photons [46], which are a special case of Fermat paths.\nWe use the above theory to derive an algorithm, called Fermat flow, for accurate NLOS shape reconstruction. We show that the spatial derivative of the Fermat pathlength provides a simple constraint that uniquely determines both the depth and normal of a hidden scene point. This derivative is estimated numerically by fitting a smooth pathlength function to a sparser set of measurements. We then apply a final refinement step that computes a smooth mesh by combining both the depth and normal information [23,9]. While most previous approaches reconstruct an albedo volume of the NLOS object, our approach is one of the few that reconstruct its surface. Compared to alternative surface reconstruction algorithms based on analysis-by-synthesis from intensity measurements [47], our approach uses only geometric constraints, which makes it BRDF-invariant and robust to imperfections in intensity measurements.\nOur theory is agnostic to the specific transient imaging technology used. We validate our theory and demonstrate results at both pico-second and femto-second temporal scales, using a pulsed laser and SPAD for the former and interferometry for the latter. Hence, for the first time, we are able to compute millimeter-scale and micrometer-scale NLOS shapes of curved objects with BRDFs ranging from purely diffuse to purely specular. In addition, our theory ap-plies to both reflective NLOS (looking around the corner) and transmissive NLOS (seeing through a diffuser) scenarios. Figure 1 shows the estimated micrometer-scale relief of a coin seen around the corner as well as through thick paper (diffuser). The obtained height profiles compare well with the reconstruction of the coin when imaged in the line of sight. This result demonstrates the significant theoretical and practical contribution of this work to active NLOS imaging, pushing the boundary of what is possible.", "publication_ref": ["b5", "b1", "b37", "b4", "b2", "b41", "b20", "b3", "b21", "b24", "b43", "b50", "b44", "b14", "b19", "b23", "b48", "b47", "b12", "b10", "b31", "b48", "b11", "b30", "b31", "b10", "b17", "b47", "b6", "b0", "b25", "b35", "b12", "b14", "b13", "b19", "b32", "b34", "b46", "b15", "b1", "b42", "b45", "b22", "b8", "b46"], "figure_ref": ["fig_0"], "table_ref": []}, {"heading": "Fermat Paths in NLOS Transients", "text": "Problem setup. We consider a transient imaging system [19], comprising a light source and detector, located at points s, d \u2208 R 3 , respectively. Our theory is agnostic to the specific transient imaging technology used, and in Section 4 we describe implementations, one based on a pulsed laser and a picosecond detector, and another based on interferometry. The visible scene V \u2282 R 3 is the union of surfaces contained within the common line of sight of the source and detector. In addition to V, we assume that there exist surfaces outside their line of sight; this could be because either these surfaces are outside the field of view, or they are inside it but occluded by another surface. We are only interested in such surfaces that can indirectly receive light from the light source by means of a single reflection or transmission through the visible scene, and can indirectly send light to the detector in a likewise manner. We call the union of such surfaces the non-line-of-sight (NLOS) scene X . Some situations where these conditions apply, and which will be relevant to our experiments, are shown in Figure 1.\nWe assume that the light source and detector are illuminating and imaging the same visible point v \u2208 V, which can be any point in the visible scene. This corresponds to the confocal scanning scheme, proposed by O'Toole et al. [33]. We emphasize that this assumption is only to simplify exposition: All of our theory generalizes to the non-confocal case, as we briefly discuss in various places throughout the paper, and detail in the supplement. In particular, in Section 4, we show results from non-confocal experiments.\nThe detector records a transient I (t; v), which equals the irradiance from photons with time of flight t. We assume that all recorded photons follow paths of the form s \u2192 v \u2192 x \u2192 v \u2192 d, where x \u2208 X . This threebounce assumption is commonplace in NLOS imaging applications, for two reasons: First, NLOS transient imaging systems typically have time-gating mechanisms that can be used to remove direct photons that only interact with the visible scene. Second, photons with more than one interactions with the NLOS scene X have greatly reduced signalto-noise ratio, and in practice are difficult to detect [7,35].\nFinally, we assume that we have calibrated the distance\n\u03c4 V (v) s \u2212 v + d \u2212 v\nfrom the source to the visible point, and from there to the detector. Then, we can use the pathlength traveled in X , \u03c4 ct \u2212 \u03c4 V (v) where c is the speed of light, to uniquely reparameterize transients as I (\u03c4 ; v). Under these assumptions, we can write [10,37]:\nI (\u03c4 ; v) = X f (x; v) \u03b4 (\u03c4 \u2212 \u03c4 (x; v)) dA (p, q) (1) where \u03c4 (x; v) 2 \u2022 x \u2212 v , (p, q) \u2208 [0, 1]\n2 is a parameterization of the NLOS surface X , A (p, q) is the corresponding area measure, and the throughput f absorbs inverse-square fall-off, shading, reflectance, and visibility.", "publication_ref": ["b18", "b32", "b6", "b34", "b9", "b36"], "figure_ref": ["fig_0"], "table_ref": []}, {"heading": "Fermat paths", "text": "We assume that the NLOS scene X is formed as the union of smooth surfaces, and \u2202X \u2282 X is the set of points on the NLOS surface where a surface normal is not defined. We will be referring to \u2202X as the boundary of X for simplicity, but note that, in addition to boundary points, it includes points at discontinuous intersections of the smooth surfaces that make up X . Then, we will be focusing on specific distinguished points x \u2208 X as follows.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "Definition 1. For any visible point v:", "text": "\u2022 The specular set S (v) \u2282 X consists of all points x \u2208 X \\ \u2202X such that the vector v \u2212 x is orthogonal to the tangent plane T x X of X at x.\n\u2022 The boundary set B (v) \u2282 \u2202X consists of all points\nx \u2208 \u2207X such that the vector v \u2212 x is orthogonal to the tangent vectort (x) of \u2202X at x.\n\u2022 The Fermat set F (v) \u2282 X is the union of these two sets,\nF (v) S (v) \u222a B (v).\nDefinition 1 implies that, at points x \u2208 S (v), the vector v \u2212 x is also parallel to the surface normaln (x). Equivalently, the path p (x; v) v \u2192 x \u2192 v corresponds to a specular reflection at x, explaining the name specular set. The name Fermat set is due to the following classical proposition of geometric optics [17,8,29,43].\nProposition 2. Let (p, q) \u2208 [0, 1]\n2 be a parameterization of the NLOS surface X . Then, for any visible point v,\nS (v) = x \u2208 X : \u2207 (p,q) \u03c4 (x (p, q) ; v) = 0 . (2)\nLet r \u2208 [0, 1] be a parameterization of the NLOS surface boundary \u2202X . Then, for any visible point v,\nB (v) = {x \u2208 \u2202X : \u2202\u03c4 (x (r) ; v) /\u2202r = 0} .(3)\nFor completeness, we provide a proof in the supplement. Proposition 2 is known as Fermat's principle, and characterizes paths of stationary length with respect to their local variations. We note that, even though Fermat's principle is often described as the \"shortest path principle\", it allows for longest or saddle-point light paths, as we demonstrate later in this section. Depending on X , F (v) will have at least one, and potentially multiple, points, as shown in Figure 2.\nWe will associate each point x \u2208 F (v) with the sphere Sph (\u03c4 (x; v) /2; v) of center v and radius \u03c4 (x; v) /2. We call this the tangent sphere, because Proposition 2 implies that, for x \u2208 S (v) or x \u2208 B (v), the Sph (\u03c4 (x; v) /2; v) is tangent to X or \u2202X , respectively, at x [29,43]. Relationship to first-returning photons. Fermat paths are a superset of the paths of the first-returning photons described by Tsai et al. [46]. In particular, the pathlength of the first-returning photon is the global minimum of \u03c4 (x; v). Then, Proposition 2 implies that x \u2208 F (v). Observations 2 and 3 of Tsai et al. [46], which make an assumption of local smoothness, correspond to the case where additionally x \u2208 S (v): Observation 3 describes the specular path p (x; v), and Observation 2 describes the tangent sphere.", "publication_ref": ["b16", "b7", "b28", "b42", "b28", "b42", "b45", "b45"], "figure_ref": ["fig_1"], "table_ref": []}, {"heading": "Fermat pathlengths as transient discontinuities", "text": "Except when the BRDF of the X surface is perfectly specular, transients I (\u03c4 ; v) will include contributions from photons that follow both Fermat and non-Fermat paths p (x; v). Without prior knowledge of the scene, it would seem impossible to identify parts of the transient due to Fermat paths. However, we make the following observation. Proposition 3. Assume that the BRDF of the X surface is non-zero in the specular direction. Then, for all x \u2208 F (v), the transient I (\u03c4 ; v) will have a discontinuity at pathlength \u03c4 (x; v). If x \u2208 S (v), then I (\u03c4 ; v) will additionally have a vertical asymptote at \u03c4 (x; v).\nProof sketch. We sketch a proof for the specular case, and provide the full proof in the supplement. Let Sph (\u03c1; v) be the sphere of center v and radius \u03c1. Let the curve C (\u03c1; v) be the intersection of Sph (\u03c1; v) with X , parameterized by ) Among all points x \u2208 X , some points on the surface (x F ,2 ,x F ,3 ) and boundary (x F ,1 ) will create paths that satisfy Fermat's principle, corresponding to local minima (x F ,1 ,x F ,2 ) or maxima (x F ,3 ) of the pathlength function \u03c4 (x; v) (bottom right). The paths for the non-boundary points (x F ,2 ,x F ,3 ) will additionally be specular. We can identify the lengths of these Fermat paths from the fact that the transient I (\u03c4 ; v) (bottom left) will be discontinuous at the corresponding pathlengths (\u03c4 F ,1 ,\u03c4 F ,2 ,\u03c4 F ,3 ).\nx F ,1 x F ,2 x F ,3 NLOS surface X v visible surface V x Sph (\u03c4 F ,2 ; v) Sph (\u03c4 F ,3 ; v) pathlength \u03c4 NLOS surface point x transient I (\u03c4 ; v) pathlength \u03c4 (x; v) \u03c4 F ,1 \u03c4 F ,2 \u03c4 F ,3 \u03c4 F ,1 \u03c4 F ,2 \u03c4 F ,3\nr \u2208 [0, 1]. Then, we can use (r, \u03c1) \u2208 [0, 1] \u00d7 [0, \u221e) to reparameterize X , and rewrite the integral of Equation ( 1):\nI (\u03c4 ; v) = X f (x; v) \u03b4 (\u03c4 \u2212 \u03c4 (x; v)) J (r,\u03c1) (p,q) (x) \u22121 dA (r, \u03c1) , (4) where J (r,\u03c1) (p,q) (x) is the Jacobian of the transformation (p, q) \u2192 (r, \u03c1). We now consider a point x S \u2208 S (v). Rec- ognizing that \u03c1 (x S ) = \u03c4 (x S ; v) /2, we have from Equa- tion (2) that \u2207 (p,q) \u03c1 (x S ) = 0. Consequently, J (r,\u03c1) (p,q) (x S ) = \u2202\u03c1 (x S ) \u2202p \u2202r (x S ) \u2202q \u2212 \u2202\u03c1 (x S ) \u2202q \u2202r (x S ) \u2202p = 0.\n(5) Then, from Equation (4), at \u03c4 = \u03c4 (x S ; v), the transient converges to infinity, resulting in a discontinuity. Figure 2 visualizes this proposition for a twodimensional Lambertian scene X , and a visible point v such that S (v) = {x F ,2 , x F ,3 }, B (v) = {x F ,1 }. We note that, in two dimensions, the boundary \u2202X is not a curve but just isolated points, and therefore the tangency property of Definition 1 and the tangent sphere are not meaningful. BRDF invariance. Proposition 3 implies that the pathlengths where the transient I (\u03c4 ; v) is discontinuous are determined completely by the function \u03c4 (x; v). In turn, \u03c4 (x; v) depends only on the geometry of v and X . Therefore, the discontinuity pathlengths are independent of the BRDF of the NLOS surface X . The BRDF is included in the throughput term f in Equation ( 4), and thus only affects the intensity of the transient at the discontinuity pathlength. Figure 3 demonstrates this reflectance invariance property. Identifying type of stationarity. Proposition 3 allows us to identify the lengths of all Fermat paths that contribute to a transient I (\u03c4 ; v), as the pathlengths where I (\u03c4 ; v) is discontinuous. From Proposition 2, each of these pathlengths is a stationary point of the function \u03c4 (x; v). When the BRDF of X is not perfectly specular, we can additionally identify the type of stationarity from the shape of the transient at a neighborhood of the discontinuity. We use Figure 2 for intuition, and refer to the supplement for details.\nSpecifically, let \u03c4 F be a pathlength where the transient is discontinuous. If \u03c4 F is a local maximum, the discontinuity in the transient I (\u03c4 ; v) occurs at the limit from the left, \u03c4 \u2192 \u03c4 \u2212 F , and the transient decreases to the right of \u03c4 F (Figure 2, \u03c4 F ,3 ). Conversely, when \u03c4 F is a local minimum, the discontinuity occurs at the limit from the right, \u03c4 \u2192 \u03c4 + F (Figure 2, \u03c4 F ,1 ,\u03c4 F ,2 ). Finally, when \u03c4 F is a saddle point, the discontinuity and intensity rise are two-sided. An example of this is shown in Figure 3 (paraboloid case).\nIdentifying the stationarity type of specular discontinuities provides us with curvature information about X . Proposition 4. Let a transient I (\u03c4 ; v) have a specular discontinuity at \u03c4 S , corresponding to a point x S \u2208 S (v). If \u03ba min , \u03ba max are the principal curvatures of X at x S , then:\n\u2022 If \u03c4 S is a local minimum of \u03c4 (x; v), 2/\u03c4 S < \u03ba min . \u2022 If \u03c4 S is a local maximum of \u03c4 (x; v), \u03ba max < 2/\u03c4 S . \u2022 If \u03c4 S is a saddle point of \u03c4 (x; v), \u03ba min \u2264 2/\u03c4 S \u2264 \u03ba max .\nWe provide the proof in the supplement, but we can use Figure 2 to provide intuition: The pathlength \u03c4 F ,2 of point x F ,2 is a local minimum. All X points in the neighborhood of x F ,2 are at a distance from v greater than \u03c4 F ,2 , and therefore outside the tangent sphere Sph (\u03c4 F ,2 /2; v). This implies that the (minimal, in 3D) principal radius of curvature is greater than \u03c4 F ,2 /2. And conversely for the pathlength \u03c4 F ,3 of point x F ,3 , which is a local maximum. We note that a sufficient condition for X to produce only locally-minimum specular pathlengths is that X is convex. However, this is not a necessary condition: As explained in Proposition 4, it is possible for X to contain concavities and still produce only locally-minimum specular pathlengths. Figure 3: Experimental demonstration. We measure transients for three objects in a looking-around-the-corner configuration: A plane, a paraboloid, and a concave sphere. We measure each object twice, once with the object covered with diffuse paint, and a second time with the object covered with aluminum foil. As predicted by our theory, the measured transients have discontinuities corresponding to specular paths of type local minimum, saddle point, and local maximum, respectively. Additionally, the location of the discontinuities is not affected by the change in BRDF.\nNon-confocal case. The results of this section have straightforward generalizations to the case where the source and detector are pointing at different points v s and v d on the visible surface V. Propositions 2 and 3 apply exactly, except that \u03c4 (x; v) is replaced with \u03c4 (\nx; v s , v d ) x \u2212 v s + x \u2212 v d .\nThe analogue of the tangent sphere is the osculating ellipsoid E (\u03c4 ; v s , v d ), of pathlength \u03c4 and foci v s , v d . Finally, Proposition 4 can be generalized to analogous relations between the principal curvatures of X and E (\u03c4 ; v s , v d ). We provide details in the supplement.", "publication_ref": [], "figure_ref": ["fig_1", "fig_1", "fig_1", "fig_1", "fig_1"], "table_ref": []}, {"heading": "Experimental demonstration", "text": "To demonstrate our theoretical findings in practice, we use a picosecond-resolution transient imaging setup (see Section 4) to capture measurements of a few real-world objects, in a looking-around-the-corner configuration (Figure 1(a)). Figure 3 shows the objects: A concave hemisphere, an extruded paraboloid, and a plane. All objects have size 20 cm \u00d7 20 cm and are painted with diffuse paint.\nWe place each object at a distance 40 cm from the visible wall, then measure a transient from a visible point such that there is a specular path corresponding roughly to the center of the object. We observe from the measured transients (Figure 3, orange) that, in agreement with Proposition 4, the hemisphere produces a local maximum discontinuity, the\nx F X v V Sph (\u03c4 F (v) ; v) v s v d \u2207v\u03c4 F (v) 2 E (\u03c4 F (v s , v d ) ; v s , v d ) \u2207 vs \u03c4 F (v s , v d )\nFigure 4: The Fermat flow equation. We visualize both the confocal (black lines) and non-confocal (green lines) cases. In the confocal case, we consider the Fermat path connecting the visible point v with an NLOS point x F . The spatial gradient \u2207 v \u03c4 F (v) /2 of the length of this path is a unit vector parallel to the vector x F \u2212 v. If the Fermat path is also specular, then \u2207 v \u03c4 F (v) /2 will additionally be the opposite of the NLOS surface normal at x F . In the nonconfocal case, we can compute the gradient with respect to either of the two visible points, v s and v d , and it will be parallel to the vector\nx F \u2212 v s or x F \u2212 v d , respectively.\nparaboloid a saddle point, and the plane a local minimum. We then cover each object with aluminum foil, to create a rough specular BRDF, and repeat our measurements. We notice that the measured transients (Figure 3, purple) are discontinuous at the same locations as the diffuse transients, in agreement with our discussion of BRDF invariance.\nThese measurements additionally help evaluate the robustness of our theoretical predictions in the presence of the Poisson noise and temporal jitter inherent in SPAD measuremens [16]: Even though the discontinuity shapes deviate from the ideal shapes in the simulated transient of Figure 2, the theoretically predicted features are still visible.", "publication_ref": ["b15"], "figure_ref": ["fig_0", "fig_1"], "table_ref": []}, {"heading": "Surface Reconstruction Using Fermat Paths", "text": "Using the results of Section 2, given a transient measurement I (\u03c4 ; v), we can identify its discontinuities as the lengths \u03c4 F of Fermat paths contributing to the transient. Each length \u03c4 F constrains the corresponding point x F \u2208 F (v) to lie on the tangent sphere Sph (\u03c4 F /2; v) and, if x F \u2208 S (v), also constrains its normal and curvature. We now develop a procedure for completely determining the point x F and its normal. Then, given a collection of Fermat pathlengths, our procedure will produce an oriented point cloud (locations and normals) for the NLOS surface X . Figure 5 visualizes our reconstruction procedure. The Fermat flow equation. We begin by introducing a key technical result at the heart of our reconstruction procedure.  7), we reconstruct from each branch a set of points, either on the boundary (branch \u03c4 F ,1 (v), blue) or at the interior (branch \u03c4 F ,2 (v), red) of the NLOS shape.\nv I (\u03c4 ; v) \u03c4 v x v y v v x v y \u03c4 F ,1 (v) \u03c4 F ,2 (v) v x v y V X (a)\nWe first define the Fermat pathlength function \u03c4 F (v):\n\u03c4 F (v) = {\u03c4 : I (\u03c4 ; v) is discontinuous} .(6)\nAs each transient I (\u03c4 ; v) can be discontinuous at more than one pathlengths, \u03c4 F (v) is a multi-valued function. We now prove the following property for this function.\nProposition 5. Consider a branch of the Fermat pathlength function \u03c4 F (v) evaluated at v \u2208 V. Assume that there is a unique point x F \u2208 F (v) with \u03c4 (x F ; v) = \u03c4 F (v). Then,\n\u2207 v \u03c4 F (v) = \u22122 x F \u2212 v x F \u2212 v . (7\n)\nWe provide the proof in the supplement. It is instructive to consider the case of the branch of \u03c4 F (v) corresponding to the global minimum of \u03c4 (x; v). This branch is the pathlength of the first-returning photons of Tsai et al. [46], and is also equal to twice the distance function D (v, X ), where\nD (v, X ) min x\u2208X x \u2212 v .(8)\nThen, Equation ( 7) is equivalent to the well-known eikonal equation for distance functions [30,40,39]. In this context, the uniqueness requirement of Proposition 5 is equivalent to a requirement that the minimizer of Equation ( 8) be unique, which is also a requirement for the eikonal equation. Proposition 5 generalizes the eikonal equation to apply to all branches of \u03c4 F (v), corresponding to all stationary points of \u03c4 (x; v) and not only those for first-returning photons. Using \u03c4 F (v) = 2 x F \u2212 v , we rewrite Equation ( 7) as\nx F = v \u2212 (\u03c4 F (v) /4)\u2207 v \u03c4 F (v) .(9)\nIn this form, the Fermat flow equation states that an NLOS point x F \u2208 F (v) generating a Fermat path can be uniquely reconstructed from the corresponding visible point v, the length \u03c4 F (v), and the gradient \u2207 v \u03c4 F (v). This reconstruction can be done with a simple geometric operation, by intersecting the sphere Sph (\u03c4\nF (v) /2; v) with the line v \u2212 \u03bb\u2207 v \u03c4 F (v) /2.\nIf the Fermat path is also specular, x F \u2208 S (v), then we can also reconstruct the normal at\nx F asn (x F ) = \u2212\u2207 v \u03c4 F (v) /2\n. This is shown in Figure 4.\nNon-confocal case. We describe here a similar proposition for the non-confocal case, which we prove in the supplement. In this case, the Fermat pathlength function has two arguments, \u03c4 F (v s , v d ). Then, as shown in Figure 4,\n\u2207 vi \u03c4 F (v s , v d ) = \u2212 x F \u2212 v i x F \u2212 v i ,(10)\nwhere v i can be either of the two visible points v s and v d . Gradient estimation. Using Equation ( 9) requires knowing the gradient \u2207 v \u03c4 F (v), computed in the local coordinate frame of the visible surface V at v. We cannot measure this gradient directly, but we can estimate it through interpolation. For simplicity, we discuss here only the case when the visible surface V is planar, deferring the general case for the supplement. When the visible surface V is planar, the local coordinate system at v can be assumed to be the x \u2212 y plane of the global coordinate system. Given a Fermat pathlength \u03c4 F (v) at a point v, we can estimate its partial derivatives \u2202\u03c4 F /\u2202x and \u2202\u03c4 F /\u2202y by locally interpolating Fermat pathlengths from transients measured at nearby points on the plane. We can then infer the derivative with respect to z by noting that Equation (7) \nimplies that \u2207 v \u03c4 F (v) = 2, \u2207 v \u03c4 F (v) = \uf8eb \uf8ed \u2202\u03c4 F \u2202x , \u2202\u03c4 F \u2202y , 4 \u2212 \u2202\u03c4 F \u2202x 2 \u2212 \u2202\u03c4 F \u2202y 2 \uf8f6 \uf8f8 v .(11)\nWe note that Equation (11) fails when the uniqueness condition of Proposition 5 is not satisfied. In practice, this can only happen at isolated points v on the visible surface, corresponding to non-generic symmetries of the NLOS surface X . Additionally, we note that the above interpolation procedure needs to be performed separately for each branch of the Fermat pathlength function \u03c4 F (v).  We perform one-dimensional scans of 3D-printed objects, in a lookingaround-the-corner configuration. For each object, we show a photograph under ambient light (left), and reconstruction results (red points) superimposed against the groundtruth mesh used to fabricate the object (middle and right).\nSurface fitting. The above procedure produces an oriented point cloud, of density comparable to the density of measurements on V. We can then use algorithms that take advantage of normal information to fit a surface representation (e.g., triangular mesh) to the point cloud with increased accuracy [23]. Given such an initial surface reconstruction, in the supplement we describe an optimization procedure, based on the theory of specular path perturbations [9,17], that refines the fitted surface to account for possible errors due to inaccurate estimation of the gradients \u2207 v \u03c4 F (v).", "publication_ref": ["b45", "b29", "b39", "b38", "b6", "b22", "b8", "b16"], "figure_ref": ["fig_2"], "table_ref": []}, {"heading": "Experiments", "text": "We discuss results from NLOS reconstruction experiments we have performed to validate and evaluate the Fermat flow algorithm. All experiments are based on measurements captured with two transient imaging setups, one operating at picosecond and the other at femtosecond temporal scales. We show additional experiments in the supplement.", "publication_ref": [], "figure_ref": [], "table_ref": []}, {"heading": "Picosecond-scale experiments", "text": "Imaging system. We use a SPAD-based transient imaging system [11,33,31], consisting of a picosecond laser (NKT SuperK EXW-12), a SPAD detector (MPD module), and a time-correlated single photon counter (TCSPC, Pico-Quant PicoHarp). The temporal binning resolution of the TCSPC unit is 4 ps, for an absolute upper bound in depth resolution of 1.2 mm. In practice, the resolution is lower, because of laser and TCSPC jitter. We use galvo mirrors to independently control viewpoint and illumination direction, and perform both confocal and non-confocal scanning in the looking-around-the-corner setting of Figure 1(a). Figure 7: Comparison of point cloud and surface reconstructions. We scan a rough specular kettle, shown in the left under ambient light. We reconstruct an oriented point cloud, shown in the middle from two views, where points are colored according to their normal. Finally, we fit a surface to the point cloud, shown to the right under two views.\nComparison with groundtruth. We fabricated small objects from CAD meshes, providing us with ground-truth shape for comparison. The objects were painted with matte white paint to create Lambertian reflectance. The objects are approximately 15 cm in each dimension, and are placed at a distance 25 cm from a planar visible surface. All objects are ruled surfaces, to allow reconstruction of their profile from only one-dimensional scans. We capture measurements under a non-confocal setting, by fixing the point imaged by the SPAD and scanning the point illuminated by the source along multiple horizontal lines on the visible wall. Along each line, we scan 200 points, at a distance of approximately 1 mm from each other. Figure 6 shows point clouds reconstructed from these measurements using the Fermat flow procedure, superimposed against the meshes used for fabrication. The reconstructions closely reproduce the shape of the objects, including their concave and convex surfaces, and match the groundtruth within 2 mm. Table-top objects. We scanned a variety of every day objects (Figures 7-8), with convex and concave geometry of different BRDFs, including translucent (plastic jug), glossy (bowl, vase), rough specular (kettle) and smooth specular (sphere). Most of the objects have a major dimension of approximately 20 \u2212 30 cm, and are placed at a distance of 80 cm from the visible wall. We use confocal scanning with a grid of 64 \u00d7 64 points distributed in an area of 80 cm \u00d7 80 cm on the visible wall.\nFigure 7 visualizes point cloud, normal, and final surface reconstruction for one of the objects, an electrical kettle with rough-specular reflectance. We observe that our reconstruction procedure produces a point cloud that closely matches the shape of the object, including accurate normals on its front surface. We note that we do not reconstruct normals at the handle of the object: This is expected, because these parts of the object produce Fermat paths of boundary, rather than specular, type, and such paths do not provide normal information. The final fitted surface further improves the reconstruction quality. Figure 8 shows recon-  We scan objects that span a variety of shapes (convex, concave) and reflectances (translucent, glossy, specular). For each object, we show a photograph under ambient light, and two views of its surface reconstruction.\nstructions for the remaining table-top objects. In all cases, the reconstruction closely matches the object shape, demonstrating the ability of our algorithm to handle a variety of complex geometry and reflectance combinations.", "publication_ref": ["b10", "b32", "b30"], "figure_ref": ["fig_0", "fig_4", "fig_6", "fig_6"], "table_ref": []}, {"heading": "Femtosecond-scale experiments", "text": "Imaging system. We use a time-domain, full-frame optical coherent tomography system [12]. We use this system to perform confocal scans under both the looking-around-thecorner and looking-through-diffuser settings (Figure 1). We use spatially and temporally incoherent LED illumination, which allows us to combine transient imaging with diagonal probing [34]. In the context of confocal scanning, this means that we can simultaneously collect transients I (\u03c4, v) at all points on the visible surface without scanning, as transient measurements taken at one point will not be contaminated with light emanating from a different point. Our implementation has depth resolution of 10 \u00b5m.", "publication_ref": ["b11", "b33"], "figure_ref": ["fig_0"], "table_ref": []}, {"heading": "Coin reconstructions.", "text": "We perform experiments in both the looking-around-the-corner and looking-throughdiffuser settings (Figure 1), where for the diffuser we use a thin sheet of paper. In both cases, the NLOS object is a US quarter, with the obverse side facing the visible surface. We place the coin at a distance of 10 mm from the visible surface, and collect transient measurements on an area of about 40 mm \u00d7 40 mm, at an 1 MPixel grid of points. For validation, we additionally use the same setup to directly scan the coin without occlusion. Figure 1 shows our results. In both cases, we can reconstruct fine detail on the coin, sufficient to infer its denomination. The reconstructed detail is also in close agreement with the groundtruth shape measured with the coin directly in the line-of-sight.", "publication_ref": [], "figure_ref": ["fig_0", "fig_0"], "table_ref": []}, {"heading": "Discussion", "text": "We discuss some limitations of our approach. Our reconstruction procedure does not require radiometric calibration, as it does not use intensity information, instead relying on estimation of the pathlengths where measured transients are discontinuous. Consequently, our reconstructions can be sensitive to inaccurate discontinuity detection.\nReconstruction quality can additionally suffer if we do not have sufficiently dense measurements for estimating Fermat pathlength gradients through interpolation. Finally, using only pathlength information provides BRDF invariance, but it also means that we do not take advantage of information available in measured intensities about the NLOS scene.\nThe theory we developed offers new insights into the NLOS imaging problem, linking it to classical areas such as specular and differential geometry, and providing ample opportunity for transfer of ideas from these areas to the NLOS imaging setting. By allowing us to treat NLOS reconstruction from a purely geometric perspective, our theory introduces a new methodology for tackling this problem, distinct from but complementary to approaches such as (elliptic) backprojection [48,33] and analysis-by-synthesis [47], which focus on the radiometric aspects of the problem. Interestingly, concurrect work [28] has unconvered an intriguing link between our and backprojection approaches, by showing that the latter cannot reconstruct NLOS points not on Fermat paths, even if those points otherwise contribute to measured transients. Therefore, both approaches reproduce the same part of the NLOS scene. Further exploration of connections between the geometric and backprojection approaches can help shed light into their fundamental limits and strengths, potentially by allowing us to derive results applicable to both classes of approaches using whichever mathematical framework (geometric, radiometric) is more convenient for analysis.\nMore broadly, an exciting future direction of research is combining the two classes of approaches, not only for NLOS imaging, but also for other related applications, including acoustic and ultrasound imaging [27], lensless imaging [50], and seismic imaging [41].", "publication_ref": ["b47", "b32", "b46", "b27", "b26", "b49", "b40"], "figure_ref": [], "table_ref": []}], "references": [{"ref_id": "b0", "title": "Fast back-projection for non-line of sight reconstruction", "journal": "Optics Express", "year": "2017", "authors": "Victor Arellano; Diego Gutierrez; Adrian Jarabo"}, {"ref_id": "b1", "title": "Inferring light fields from shadows", "journal": "", "year": "2018", "authors": "Manel Baradad; Vickie Ye; B Adam; Fr\u00e9do Yedidia;  Durand; T William; Gregory W Freeman; Antonio Wornell;  Torralba"}, {"ref_id": "b2", "title": "Passive sensing around the corner using spatial coherence", "journal": "Nature communications", "year": "2018", "authors": "Mufeed Batarseh; V Sergey; Zhiqin Sukhov; Heath Shen; Reza Gemar; Aristide Rezvani;  Dogariu"}, {"ref_id": "b3", "title": "Non-invasive imaging through opaque scattering layers", "journal": "Nature", "year": "2012", "authors": "Jacopo Bertolotti; Elbert G Van Putten; Christian Blum; Ad Lagendijk; Willem L Vos; Allard P Mosk"}, {"ref_id": "b4", "title": "Non lineof-sight localization by passive optical time-of-flight", "journal": "", "year": "2001", "authors": "Jeremy Boger; - Lombard; Ori Katz"}, {"ref_id": "b5", "title": "Turning corners into cameras: Principles and methods", "journal": "", "year": "2017", "authors": "Katherine L Bouman; Vickie Ye; Adam B Yedidia; Fr\u00e9do Durand; W Gregory; Antonio Wornell; William T Torralba;  Freeman"}, {"ref_id": "b6", "title": "Non-line-of-sight imaging using a time-gated single photon avalanche diode", "journal": "Optics express", "year": "2015", "authors": "Mauro Buttafava; Jessica Zeman; Alberto Tosi; Kevin Eliceiri; Andreas Velten"}, {"ref_id": "b7", "title": "Perturbation methods for interactive specular reflections", "journal": "IEEE Transactions on Visualization and Computer Graphics", "year": "2000", "authors": "Min Chen; James Arvo"}, {"ref_id": "b8", "title": "Theory and application of specular path perturbation", "journal": "ACM Transactions on Graphics (TOG)", "year": "2000", "authors": "Min Chen; James Arvo"}, {"ref_id": "b9", "title": "Advanced global illumination", "journal": "AK Peters, Ltd", "year": "2006", "authors": "Philip Dutr\u00e9; Kavita Bala; Philippe Bekaert"}, {"ref_id": "b10", "title": "Single-photon sensitive light-in-fight imaging", "journal": "Nature communications", "year": "2015", "authors": "Genevieve Gariepy; Nikola Krstaji\u0107; Robert Henderson; Chunyong Li; Gerald S Robert R Thomson; Barmak Buller; Ramesh Heshmat; Jonathan Raskar; Daniele Leach;  Faccio"}, {"ref_id": "b11", "title": "Micron-scale light transport decomposition using interferometry", "journal": "ACM Transactions on Graphics", "year": "2008", "authors": "Ioannis Gkioulekas; Anat Levin; Fr\u00e9do Durand; Todd Zickler"}, {"ref_id": "b12", "title": "Reconstruction of hidden 3d shapes using diffuse reflections", "journal": "Optics express", "year": "2012", "authors": "Otkrist Gupta; Thomas Willwacher; Andreas Velten; Ashok Veeraraghavan; Ramesh Raskar"}, {"ref_id": "b13", "title": "Robust non-line-of-sight imaging with single photon detectors", "journal": "", "year": "2017", "authors": "Felix Heide; O' Matthew; Kai Toole; David Zhang; Steven Lindell; Gordon Diamond;  Wetzstein"}, {"ref_id": "b14", "title": "Diffuse mirrors: 3d reconstruction from diffuse indirect illumination using inexpensive time-of-flight sensors", "journal": "", "year": "2014", "authors": "Felix Heide; Lei Xiao; Wolfgang Heidrich; Matthias B Hullin"}, {"ref_id": "b15", "title": "A computational model of a single-photon avalanche diode sensor for transient imaging", "journal": "", "year": "2017", "authors": "Quercus Hernandez; Diego Gutierrez; Adrian Jarabo"}, {"ref_id": "b16", "title": "Manifold exploration: A markov chain monte carlo technique for rendering scenes with difficult specular transport", "journal": "ACM Transactions on Graphics", "year": "2012", "authors": "Wenzel Jakob; Steve Marschner"}, {"ref_id": "b17", "title": "A Framework for Transient Rendering", "journal": "ACM Trans. Graph", "year": "2001", "authors": "Adrian Jarabo; Julio Marco; Adolfo Mu\u00f1oz; Raul Buisan; Wojciech Jarosz; Diego Gutierrez"}, {"ref_id": "b18", "title": "Recent advances in transient imaging: A computer graphics and vision perspective", "journal": "Visual Informatics", "year": "2017", "authors": "Adrian Jarabo; Belen Masia; Julio Marco; Diego Gutierrez"}, {"ref_id": "b19", "title": "Occluded imaging with time-of-flight sensors", "journal": "ACM Transactions on Graphics (ToG)", "year": "2016", "authors": "Achuta Kadambi; Hang Zhao; Boxin Shi; Ramesh Raskar"}, {"ref_id": "b20", "title": "Non-invasive single-shot imaging through scattering layers and around corners via speckle correlations", "journal": "Nature photonics", "year": "2014", "authors": "Ori Katz; Pierre Heidmann; Mathias Fink; Sylvain Gigan"}, {"ref_id": "b21", "title": "Looking around corners and through thin turbid layers in real time with scattered incoherent light", "journal": "Nature photonics", "year": "2012", "authors": "Ori Katz; Eran Small; Yaron Silberberg"}, {"ref_id": "b22", "title": "Poisson surface reconstruction", "journal": "", "year": "2006", "authors": "Michael Kazhdan; Matthew Bolitho; Hugues Hoppe"}, {"ref_id": "b23", "title": "Looking around the corner using ultrafast transient imaging", "journal": "International journal of computer vision", "year": "2011", "authors": "Ahmed Kirmani; Tyler Hutchison; James Davis; Ramesh Raskar"}, {"ref_id": "b24", "title": "Martin Laurenzis, and Matthias B Hullin. Tracking objects outside the line of sight using 2d intensity images", "journal": "Scientific reports", "year": "2016", "authors": "Jonathan Klein; Christoph Peters; Jaime Mart\u00edn"}, {"ref_id": "b25", "title": "Error backprojection algorithms for non-line-of-sight imaging", "journal": "", "year": "", "authors": "Fiona Marco La Manna; Eric Kine; Jonathan Breitbach; Andreas Jackson;  Velten"}, {"ref_id": "b26", "title": "Acoustic non-line-of-sight imaging", "journal": "", "year": "2019", "authors": "David Lindell; Gordon Wetzstein; Vladlen Koltun"}, {"ref_id": "b27", "title": "Analysis of feature visibility in non-line-of-sight measurements", "journal": "", "year": "2019", "authors": "Xiaochun Liu; Sebastian Bauer; Andreas Velten"}, {"ref_id": "b28", "title": "Illumination from curved reflectors", "journal": "ACM", "year": "1992", "authors": "Don Mitchell; Pat Hanrahan"}, {"ref_id": "b29", "title": "Level set methods and dynamic implicit surfaces", "journal": "Springer Science & Business Media", "year": "2006", "authors": "Stanley Osher; Ronald Fedkiw"}, {"ref_id": "b30", "title": "Reconstructing transient images from single-photon sensors", "journal": "", "year": "2017", "authors": "O' Matthew; Felix Toole;  Heide; B David; Kai Lindell; Steven Zang; Gordon Diamond;  Wetzstein"}, {"ref_id": "b31", "title": "Reconstructing transient images from single-photon sensors", "journal": "", "year": "2017", "authors": "O' Matthew; Felix Toole; Kai Heide;  Lindell; B David; Steven Zang; Gordon Diamond;  Wetzstein"}, {"ref_id": "b32", "title": "Confocal non-line-of-sight imaging based on the light-cone transform", "journal": "Nature", "year": "2008", "authors": "O' Matthew; David B Toole; Gordon Lindell;  Wetzstein"}, {"ref_id": "b33", "title": "Primaldual coding to probe light transport", "journal": "ACM Transactions on Graphics", "year": "2012", "authors": "M O'toole; R Raskar; K N Kutulakos"}, {"ref_id": "b34", "title": "Reconstructing rooms using photon echoes: A plane based model and reconstruction algorithm for looking around the corner", "journal": "ICCP", "year": "2017", "authors": "Adithya Pediredla; Mauro Buttafava; Alberto Tosi; Oliver Cossairt; Ashok Veeraraghavan"}, {"ref_id": "b35", "title": "Akshat Dave, and Ashok Veeraraghavan. Snlos: Non-line-of-sight scanning through temporal focusing", "journal": "ICCP", "year": "2019", "authors": "Adithya Pediredla"}, {"ref_id": "b36", "title": "Elliptic path sampling for time-gated rendering", "journal": "ACM Transactions on Graphics (TOG)", "year": "2019", "authors": "Adithya Pediredla; Ashok Veeraraghavan; Ioannis Gkioulekas"}, {"ref_id": "b37", "title": "Computational periscopy with an ordinary digital camera", "journal": "Nature", "year": "2019", "authors": "Charles Saunders; John Murray-Bruce; K Vivek;  Goyal"}, {"ref_id": "b38", "title": "Fast marching methods. SIAM review", "journal": "", "year": "1999", "authors": "A James;  Sethian"}, {"ref_id": "b39", "title": "Level set methods and fast marching methods: evolving interfaces in computational geometry, fluid mechanics, computer vision, and materials science", "journal": "Cambridge university press", "year": "1999", "authors": "A James;  Sethian"}, {"ref_id": "b40", "title": "3-d traveltime computation using the fast marching method", "journal": "Geophysics", "year": "1999", "authors": "A James; A Sethian;  Mihai Popovici"}, {"ref_id": "b41", "title": "Tracking multiple objects outside the line of sight using speckle imaging", "journal": "", "year": "2018", "authors": "Brandon M Smith; O' Matthew; Mohit Toole;  Gupta"}, {"ref_id": "b42", "title": "The optics of rays, wavefronts, and caustics", "journal": "Elsevier", "year": "1972", "authors": "Orestes Stavroudis"}, {"ref_id": "b43", "title": "Flash photography for data-driven hidden scene recovery", "journal": "", "year": "2018", "authors": "Matthew Tancik; Guy Satat; Ramesh Raskar"}, {"ref_id": "b44", "title": "Exploiting occlusion in non-line-of-sight active imaging", "journal": "IEEE Transactions on Computational Imaging", "year": "2018", "authors": "Christos Thrampoulidis; Gal Shulkind; Feihu Xu; T William; Jeffrey Freeman; Antonio Shapiro; Franco Torralba; Gregory Wong;  Wornell"}, {"ref_id": "b45", "title": "The geometry of first-returning photons for non-line-of-sight imaging", "journal": "", "year": "2006", "authors": "Chia-Yin Tsai; N Kiriakos;  Kutulakos; G Srinivasa; Aswin C Narasimhan;  Sankaranarayanan"}, {"ref_id": "b46", "title": "Beyond volumetric albedo-a surface optimization framework for non-line-of-sight imaging", "journal": "", "year": "2008", "authors": "Chia-Yin Tsai; Aswin C Sankaranarayanan; Ioannis Gkioulekas"}, {"ref_id": "b47", "title": "Recovering three-dimensional shape around a corner using ultrafast time-of-flight imaging", "journal": "", "year": "2008", "authors": "Andreas Velten; Thomas Willwacher; Otkrist Gupta; Ashok Veeraraghavan; G Moungi; Ramesh Bawendi;  Raskar"}, {"ref_id": "b48", "title": "Femto-photography: Capturing and Visualizing the Propagation of Light", "journal": "ACM Trans. Graph", "year": "2001", "authors": "Andreas Velten; Di Wu; Adrian Jarabo; Belen Masia; Christopher Barsi; Chinmaya Joshi; Everett Lawson; Moungi Bawendi; Diego Gutierrez; Ramesh Raskar"}, {"ref_id": "b49", "title": "Ultrafast lensless computational imaging through 5d frequency analysis of time-resolved light transport. International journal of computer vision", "journal": "", "year": "2014", "authors": "Di Wu; Gordon Wetzstein; Christopher Barsi; Thomas Willwacher; Qionghai Dai; Ramesh Raskar"}, {"ref_id": "b50", "title": "Revealing hidden scenes by photon-efficient occlusion-based opportunistic active imaging", "journal": "Optics express", "year": "2018", "authors": "Feihu Xu; Gal Shulkind; Christos Thrampoulidis; H Jeffrey; Antonio Shapiro;  Torralba; N C Franco; Gregory W Wong;  Wornell"}], "figures": [{"figure_label": "1", "figure_type": "figure", "figure_id": "fig_0", "figure_caption": "Figure 1 :1Figure1: Non-line-of-sight imaging. We consider the problem of reconstructing surfaces that are: (a) outside the field of view of sensor, or (b) occluded from it by a diffuser. We develop an algorithm that can use transient imaging measurements to accurately reconstruct the shape of the non-line-of-sight surface. The figure shows example reconstructions of a US quarter from measurements captured by a femtosecond-scale transient imaging system. In (c), we compare our reconstructions against groundtruth, obtained using a direct depth scan of the object with the same transient imaging system.", "figure_data": ""}, {"figure_label": "2", "figure_type": "figure", "figure_id": "fig_1", "figure_caption": "Figure 2 :2Figure 2: Theory of Fermat paths. We illuminate and image an NLOS surface X from a point v on a visible surface V. (We show the camera and light sources in Figure 1.) Among all points x \u2208 X , some points on the surface (x F ,2 ,x F ,3 ) and boundary (x F ,1 ) will create paths that satisfy Fermat's principle, corresponding to local minima (x F ,1 ,x F ,2 ) or maxima (x F ,3 ) of the pathlength function \u03c4 (x; v) (bottom right). The paths for the non-boundary points (x F ,2 ,x F ,3 ) will additionally be specular. We can identify the lengths of these Fermat paths from the fact that the transient I (\u03c4 ; v) (bottom left) will be discontinuous at the corresponding pathlengths (\u03c4 F ,1 ,\u03c4 F ,2 ,\u03c4 F ,3 ).", "figure_data": ""}, {"figure_label": "5", "figure_type": "figure", "figure_id": "fig_2", "figure_caption": "Figure 5 :5Figure 5: Reconstruction pipeline. (a) We first collect transient measurements I (\u03c4, v) at multiple points v on the visible surface V. (b) For each measured transient, we detect pathlengths where the transient is discontinuous. These correspond to samples of the multi-valued Fermat pathlength function \u03c4 F (v). In the example shown, \u03c4 F (v) has two branches \u03c4 F ,1 (v) and \u03c4 F ,2 (v), shown in blue and red respectively. (c) Within each branch of \u03c4 F (v), we interpolate to compute the gradient \u2207 v \u03c4 F (v). (d) Finally, by applying the Fermat flow equation (7), we reconstruct from each branch a set of points, either on the boundary (branch \u03c4 F ,1 (v), blue) or at the interior (branch \u03c4 F ,2 (v), red) of the NLOS shape.", "figure_data": ""}, {"figure_label": "", "figure_type": "figure", "figure_id": "fig_3", "figure_caption": "(a) photograph and reconstruction of paraboloid object (b) photograph and reconstruction of sigmoid object", "figure_data": ""}, {"figure_label": "6", "figure_type": "figure", "figure_id": "fig_4", "figure_caption": "Figure 6 :6Figure6: Comparison with groundtruth. We perform one-dimensional scans of 3D-printed objects, in a lookingaround-the-corner configuration. For each object, we show a photograph under ambient light (left), and reconstruction results (red points) superimposed against the groundtruth mesh used to fabricate the object (middle and right).", "figure_data": ""}, {"figure_label": "8", "figure_type": "figure", "figure_id": "fig_6", "figure_caption": "Figure 8 :8Figure8: Table-top objects. We scan objects that span a variety of shapes (convex, concave) and reflectances (translucent, glossy, specular). For each object, we show a photograph under ambient light, and two views of its surface reconstruction.", "figure_data": ""}], "formulas": [{"formula_id": "formula_0", "formula_text": "\u03c4 V (v) s \u2212 v + d \u2212 v", "formula_coordinates": [3.0, 50.11, 254.8, 112.7, 9.68]}, {"formula_id": "formula_1", "formula_text": "I (\u03c4 ; v) = X f (x; v) \u03b4 (\u03c4 \u2212 \u03c4 (x; v)) dA (p, q) (1) where \u03c4 (x; v) 2 \u2022 x \u2212 v , (p, q) \u2208 [0, 1]", "formula_coordinates": [3.0, 50.11, 329.97, 236.25, 38.87]}, {"formula_id": "formula_2", "formula_text": "F (v) S (v) \u222a B (v).", "formula_coordinates": [3.0, 89.96, 659.85, 94.89, 8.74]}, {"formula_id": "formula_3", "formula_text": "Proposition 2. Let (p, q) \u2208 [0, 1]", "formula_coordinates": [3.0, 308.86, 119.1, 132.32, 8.96]}, {"formula_id": "formula_4", "formula_text": "S (v) = x \u2208 X : \u2207 (p,q) \u03c4 (x (p, q) ; v) = 0 . (2)", "formula_coordinates": [3.0, 332.6, 153.13, 212.51, 9.99]}, {"formula_id": "formula_5", "formula_text": "B (v) = {x \u2208 \u2202X : \u2202\u03c4 (x (r) ; v) /\u2202r = 0} .(3)", "formula_coordinates": [3.0, 336.74, 209.15, 208.38, 8.99]}, {"formula_id": "formula_6", "formula_text": "x F ,1 x F ,2 x F ,3 NLOS surface X v visible surface V x Sph (\u03c4 F ,2 ; v) Sph (\u03c4 F ,3 ; v) pathlength \u03c4 NLOS surface point x transient I (\u03c4 ; v) pathlength \u03c4 (x; v) \u03c4 F ,1 \u03c4 F ,2 \u03c4 F ,3 \u03c4 F ,1 \u03c4 F ,2 \u03c4 F ,3", "formula_coordinates": [4.0, 50.02, 64.49, 245.22, 227.59]}, {"formula_id": "formula_7", "formula_text": "I (\u03c4 ; v) = X f (x; v) \u03b4 (\u03c4 \u2212 \u03c4 (x; v)) J (r,\u03c1) (p,q) (x) \u22121 dA (r, \u03c1) , (4) where J (r,\u03c1) (p,q) (x) is the Jacobian of the transformation (p, q) \u2192 (r, \u03c1). We now consider a point x S \u2208 S (v). Rec- ognizing that \u03c1 (x S ) = \u03c4 (x S ; v) /2, we have from Equa- tion (2) that \u2207 (p,q) \u03c1 (x S ) = 0. Consequently, J (r,\u03c1) (p,q) (x S ) = \u2202\u03c1 (x S ) \u2202p \u2202r (x S ) \u2202q \u2212 \u2202\u03c1 (x S ) \u2202q \u2202r (x S ) \u2202p = 0.", "formula_coordinates": [4.0, 50.11, 492.39, 236.25, 131.32]}, {"formula_id": "formula_8", "formula_text": "\u2022 If \u03c4 S is a local minimum of \u03c4 (x; v), 2/\u03c4 S < \u03ba min . \u2022 If \u03c4 S is a local maximum of \u03c4 (x; v), \u03ba max < 2/\u03c4 S . \u2022 If \u03c4 S is a saddle point of \u03c4 (x; v), \u03ba min \u2264 2/\u03c4 S \u2264 \u03ba max .", "formula_coordinates": [4.0, 318.83, 499.16, 226.29, 50.82]}, {"formula_id": "formula_9", "formula_text": "x; v s , v d ) x \u2212 v s + x \u2212 v d .", "formula_coordinates": [5.0, 55.09, 457.89, 219.73, 21.64]}, {"formula_id": "formula_10", "formula_text": "x F X v V Sph (\u03c4 F (v) ; v) v s v d \u2207v\u03c4 F (v) 2 E (\u03c4 F (v s , v d ) ; v s , v d ) \u2207 vs \u03c4 F (v s , v d )", "formula_coordinates": [5.0, 313.27, 70.73, 222.98, 146.42]}, {"formula_id": "formula_11", "formula_text": "x F \u2212 v s or x F \u2212 v d , respectively.", "formula_coordinates": [5.0, 393.37, 337.95, 140.08, 9.68]}, {"formula_id": "formula_12", "formula_text": "v I (\u03c4 ; v) \u03c4 v x v y v v x v y \u03c4 F ,1 (v) \u03c4 F ,2 (v) v x v y V X (a)", "formula_coordinates": [6.0, 48.24, 73.16, 368.91, 88.46]}, {"formula_id": "formula_13", "formula_text": "\u03c4 F (v) = {\u03c4 : I (\u03c4 ; v) is discontinuous} .(6)", "formula_coordinates": [6.0, 84.6, 284.6, 201.77, 9.68]}, {"formula_id": "formula_14", "formula_text": "\u2207 v \u03c4 F (v) = \u22122 x F \u2212 v x F \u2212 v . (7", "formula_coordinates": [6.0, 111.7, 392.76, 170.8, 23.25]}, {"formula_id": "formula_15", "formula_text": ")", "formula_coordinates": [6.0, 282.49, 399.85, 3.87, 8.64]}, {"formula_id": "formula_16", "formula_text": "D (v, X ) min x\u2208X x \u2212 v .(8)", "formula_coordinates": [6.0, 105.83, 495.77, 180.53, 9.68]}, {"formula_id": "formula_17", "formula_text": "x F = v \u2212 (\u03c4 F (v) /4)\u2207 v \u03c4 F (v) .(9)", "formula_coordinates": [6.0, 100.38, 634.7, 185.99, 9.68]}, {"formula_id": "formula_18", "formula_text": "F (v) /2; v) with the line v \u2212 \u03bb\u2207 v \u03c4 F (v) /2.", "formula_coordinates": [6.0, 308.86, 262.96, 236.25, 21.64]}, {"formula_id": "formula_19", "formula_text": "x F asn (x F ) = \u2212\u2207 v \u03c4 F (v) /2", "formula_coordinates": [6.0, 308.86, 286.87, 235.05, 21.64]}, {"formula_id": "formula_20", "formula_text": "\u2207 vi \u03c4 F (v s , v d ) = \u2212 x F \u2212 v i x F \u2212 v i ,(10)", "formula_coordinates": [6.0, 360.03, 361.34, 185.09, 23.25]}, {"formula_id": "formula_21", "formula_text": "implies that \u2207 v \u03c4 F (v) = 2, \u2207 v \u03c4 F (v) = \uf8eb \uf8ed \u2202\u03c4 F \u2202x , \u2202\u03c4 F \u2202y , 4 \u2212 \u2202\u03c4 F \u2202x 2 \u2212 \u2202\u03c4 F \u2202y 2 \uf8f6 \uf8f8 v .(11)", "formula_coordinates": [6.0, 319.81, 557.99, 225.3, 69.44]}], "doi": ""}